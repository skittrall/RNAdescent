(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    454592,      10058]
NotebookOptionsPosition[    445565,       9937]
NotebookOutlinePosition[    445959,       9953]
CellTagsIndexPosition[    445916,       9950]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["RNAdescent version 1.1", "Title",
 CellChangeTimes->{{3.898057077327951*^9, 3.898057106225013*^9}, 
   3.899355141088284*^9},ExpressionUUID->"c85fa883-a0f5-4ccd-8d3b-\
62479b6fd1a2"],

Cell[CellGroupData[{

Cell[TextData[{
 "Mathematica implementation of method described in Jordan P. Skittrall, \
Nerea Irigoyen, Ian Brierley and Julia R. Gog, \[OpenCurlyDoubleQuote]A novel \
approach to finding conserved features in low-variability gene alignments \
characterises RNA motifs in SARS-CoV and SARS-CoV-2\[CloseCurlyDoubleQuote]. ",
 StyleBox["Scientific Reports",
  FontSlant->"Italic"],
 " 13 (2023) 12079, https://doi.org/10.1038/s41598-023-39207-1"
}], "Section",
 CellChangeTimes->{{3.8866595836666393`*^9, 3.886659647216692*^9}, {
  3.8866603623726177`*^9, 3.8866603839722967`*^9}, {3.896865128763267*^9, 
  3.896865131903668*^9}, {3.899355102284502*^9, 
  3.8993551354297733`*^9}},ExpressionUUID->"bed394a6-c7eb-4f70-a4ae-\
0e513b9774a0"],

Cell[TextData[{
 "This implementation of the algorithm takes as input a variable called \
rawdata, which should be an array consisting of aligned sequences for a \
single gene.  Sequences need to be aligned in triplets, i.e. the algorithm \
cannot handle gaps unless they occur as a triplet in-frame.  The algorithm is \
not written to handle ambiguity codes.\n\nAside from adding the instruction \
to import an aligned gene, the code can be run from start to finish.\n\nWhere \
large numbers of sequences are used, it may be impracticable to import all \
sequences for codon counting together.  In that case, separate code to do the \
codon counting can be used, to generate the codondistributionsbylocation \
array, which can then be imported.\n\nNote that some of the code used comes \
from, or is derived from, that in Julia R. Gog,  Andrew M.L. Lever, Jordan P. \
Skittrall, \[OpenCurlyDoubleQuote]A new method for detecting signal regions \
in ordered sequences of real numbers, and application to viral genomic data\
\[CloseCurlyDoubleQuote].  ",
 StyleBox["PLoS ONE",
  FontSlant->"Italic"],
 " 13(4):e0195763 (2018). doi:10.1371/journal.pone.0195763.  Please cite both \
the current paper and the earlier paper if using this code.\n\nIf using the \
code that excludes from analysis loci with a high proportion of gaps (enabled \
by default), please also cite Jordan P. Skittrall, Carin K. Ingemarsdotter, \
Julia R. Gog, Andrew M.L. Lever, \[OpenCurlyDoubleQuote]A scale-free analysis \
of the HIV-1 genome demonstrates multiple conserved regions of structural and \
functional importance\[CloseCurlyDoubleQuote]. ",
 StyleBox["PLoS Computational Biology",
  FontSlant->"Italic"],
 " 15(9):e1007345. doi:10.1371/journal.pcbi.1007345.  Note that for many \
alignments of highly conserved organisms\[CloseCurlyQuote] genes, there will \
not be indels so that it is not necessary to use code to handle loci \
containing gaps.\n\nThis notebook is licensed under the GNU General Public \
License v3.0."
}], "Text",
 CellChangeTimes->{{3.8866598796043167`*^9, 3.886660009410789*^9}, {
  3.886660317652042*^9, 3.886660469732828*^9}, {3.8866608239904747`*^9, 
  3.886660833190454*^9}, {3.886660998199526*^9, 3.886661039751585*^9}, {
  3.886661281961177*^9, 3.886661341945524*^9}, {3.886669192497014*^9, 
  3.886669240753418*^9}, {3.88666927460966*^9, 3.886669342577846*^9}, {
  3.886671243195014*^9, 3.8866713201552*^9}, {3.886671884989798*^9, 
  3.886671907278126*^9}, {3.898057612149798*^9, 
  3.898057647733995*^9}},ExpressionUUID->"487d4e87-f5eb-49a4-9680-\
024f53882364"],

Cell[CellGroupData[{

Cell["Necessary imports and user-selected options", "Subsection",
 CellChangeTimes->{{3.886673375623337*^9, 
  3.88667338946103*^9}},ExpressionUUID->"19165505-d8e4-4c77-b665-\
cb6043ff5d0d"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "It", " ", "is", " ", "safe", " ", "to", " ", "leave", " ", "options", " ",
     "as", " ", "their", " ", "default"}], ",", " ", 
   RowBox[{
   "but", " ", "the", " ", "right", " ", "hand", " ", "side", " ", "of", " ", 
    "the", " ", "rawdata", " ", "assignment", " ", "needs", " ", "to", " ", 
    "import", " ", "an", " ", "alignment"}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.886673500854713*^9, 
  3.886673523909738*^9}},ExpressionUUID->"6e531a59-aadf-4787-b4dd-\
726346f323ea"],

Cell[BoxData[
 RowBox[{"rawdata", "=", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Need", " ", "to", " ", "add", " ", "an", " ", "import", " ", "here", " ", 
    "if", " ", "wishing", " ", "to", " ", "analyse", " ", "custom", " ", 
    "data"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.88666013614813*^9, 3.8866601457312593`*^9}, {
  3.8867501759656982`*^9, 
  3.886750179821516*^9}},ExpressionUUID->"1bab9a0d-f1b9-466e-9758-\
0115f76427e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Uncomment", " ", "the", " ", "following", " ", "for", " ", "a", " ", 
      "toy", " ", "example", " ", "\"\<gene\>\"", " ", "that", " ", 
      "illustrates", " ", "weighting", " ", "in", " ", "the", " ", "low"}], 
     "-", 
     RowBox[{"variability", " ", 
      RowBox[{"environment", ".", "  ", "The"}], " ", "\"\<gene\>\"", " ", 
      "consists", " ", "of", " ", "200", " ", "isoleucine", " ", "codons"}]}],
     ",", " ", 
    RowBox[{
    "and", " ", "the", " ", "alignment", " ", "consists", " ", "of", " ", 
     "200", " ", 
     RowBox[{"\"\<isolates\>\"", ".", "  ", "In"}], " ", "every", " ", 
     "\"\<isolate\>\""}], ",", " ", 
    RowBox[{
    "the", " ", "central", " ", "20", " ", "codons", " ", "are", " ", "ATA"}],
     ",", " ", 
    RowBox[{
    "and", " ", "this", " ", "codon", " ", "is", " ", "not", " ", "used", " ",
      "anywhere", " ", 
     RowBox[{"else", ".", "  ", "In"}], " ", "199", " ", "\"\<isolates\>\""}],
     ",", " ", 
    RowBox[{
    "all", " ", "other", " ", "codons", " ", "alternate", " ", "between", " ",
      "ATC", " ", "and", " ", 
     RowBox[{"ATT", ".", "  ", "In"}], " ", "one", " ", "\"\<isolate\>\""}], 
    ",", " ", 
    RowBox[{
    "every", " ", "fifth", " ", "ACT", " ", "is", " ", "replaced", " ", "by", 
     " ", 
     RowBox[{"ATT", ".", "  ", "This"}], " ", "yields", " ", "a", " ", 
     "small", " ", "amount", " ", "of", " ", "\"\<variability\>\"", " ", 
     "everywhere", " ", "except", " ", "for", " ", "a", " ", "small", " ", 
     "central", " ", "stretch", " ", "of", " ", "\"\<rare\>\"", " ", 
     RowBox[{"codons", ".", "  ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"In", " ", "the", " ", "toy", " ", "example"}], ",", " ", 
        RowBox[{
         RowBox[{
         "this", " ", "variability", " ", "is", " ", "generated", " ", "by", 
          " ", "one", " ", "\"\<isolate\>\""}], ";", " ", 
         RowBox[{"in", " ", "reality"}]}], ",", " ", 
        RowBox[{
        "the", " ", "variability", " ", "is", " ", "seen", " ", "in", " ", 
         "different", " ", "isolates", " ", "for", " ", "different", " ", 
         RowBox[{"loci", "."}]}]}], ")"}]}], "  ", "However"}], ",", " ", 
    RowBox[{"without", " ", "weighting"}], ",", " ", 
    RowBox[{
     RowBox[{"the", " ", "signal"}], "-", "to", "-", 
     RowBox[{
     "noise", " ", "ratio", " ", "is", " ", "too", " ", "small", " ", "for", 
      " ", "the", " ", "conserved", " ", "region", " ", "to", " ", "be", " ", 
      
      RowBox[{"noticeable", ".", "  ", "Weighting"}], " ", "for", " ", "the", 
      " ", "rare", " ", "codon", " ", "unmasks", " ", "the", " ", "conserved",
       " ", "region"}]}], ",", " ", 
    RowBox[{
    "but", " ", "because", " ", "there", " ", "is", " ", "no", " ", 
     "variability", " ", "in", " ", "some", " ", "of", " ", "the", " ", 
     "adjacent", " ", "codons"}], ",", " ", 
    RowBox[{
    "these", " ", "get", " ", "called", " ", "as", " ", "part", " ", "of", 
     " ", "the", " ", "conserved", " ", "region", " ", "too", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
       "since", " ", "they", " ", "are", " ", "conserved", " ", "in", " ", 
        "the", " ", "alignment"}], ")"}], "."}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"rawdata", "=", 
     RowBox[{
      RowBox[{"StringRepeat", "[", 
       RowBox[{"\"\<ATTATC\>\"", ",", "45"}], "]"}], "<>", 
      RowBox[{"StringRepeat", "[", 
       RowBox[{"\"\<ATAATA\>\"", ",", "10"}], "]"}], "<>", 
      RowBox[{"StringRepeat", "[", 
       RowBox[{"\"\<ATTATC\>\"", ",", "45"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"rawdata", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ConstantArray", "[", 
         RowBox[{"rawdata", ",", "199"}], "]"}], ",", 
        RowBox[{
         RowBox[{"StringRepeat", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"StringRepeat", "[", 
             RowBox[{"\"\<ATTATC\>\"", ",", "4"}], "]"}], "<>", 
            "\"\<ATTATT\>\""}], ",", "9"}], "]"}], "<>", 
         RowBox[{"StringRepeat", "[", 
          RowBox[{"\"\<ATAATA\>\"", ",", "10"}], "]"}], "<>", 
         RowBox[{"StringRepeat", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"StringRepeat", "[", 
             RowBox[{"\"\<ATTATC\>\"", ",", "4"}], "]"}], "<>", 
            "\"\<ATTATT\>\""}], ",", "9"}], "]"}]}]}], "}"}], "]"}]}], ";"}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.886833786460335*^9, 3.886833829708612*^9}, {
   3.886833950589316*^9, 3.8868339619009323`*^9}, {3.886834006717564*^9, 
   3.8868340405737667`*^9}, {3.886834079869751*^9, 3.886834176414106*^9}, {
   3.886834208206686*^9, 3.886834402975293*^9}, {3.886835151507539*^9, 
   3.8868351872037354`*^9}, 
   3.8868356865385237`*^9},ExpressionUUID->"b1134538-81af-4e65-aac1-\
ef1dd9ee5f1a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Uncomment", " ", "the", " ", "following", " ", "for", " ", "a", " ", 
      "toy", " ", "example", " ", "\"\<gene\>\"", " ", "that", " ", 
      "illustrates", " ", "how", " ", "high"}], "-", 
     RowBox[{
     "variability", " ", "outliers", " ", "can", " ", "produce", " ", 
      "spurious", " ", "results", " ", "in", " ", "the", " ", "low"}], "-", 
     RowBox[{"variability", " ", 
      RowBox[{"environment", ".", "  ", "The"}], " ", "example", " ", 
      "\"\<gene\>\"", " ", "is", " ", "exactly", " ", "as", " ", "above"}]}], 
    ",", " ", 
    RowBox[{
     RowBox[{
     "except", " ", "that", " ", "at", " ", "the", " ", "end", " ", "of", " ",
       "the", " ", "\"\<gene\>\"", " ", "is", " ", "a", " ", "single", " ", 
      "histidine", " ", 
      RowBox[{"codon", ".", "  ", "There"}], " ", "is", " ", "a", " ", "50"}],
      ":", 
     RowBox[{
     "50", " ", "split", " ", "between", " ", "CAT", " ", "and", " ", "CAC", 
      " ", "in", " ", "the", " ", "\"\<isolates\>\"", " ", "with", " ", "the",
       " ", "alternating", " ", 
      RowBox[{"ATC", "/", "ATT"}], " ", 
      RowBox[{"codons", ".", "  ", "There"}], " ", "are", " ", "199", " ", 
      "of", " ", "each", " ", "of", " ", "these", " ", "\"\<isolates\>\""}]}],
     ",", " ", 
    RowBox[{
     RowBox[{
     "and", " ", "one", " ", "\"\<isolate\>\"", " ", "where", " ", "every", 
      " ", "fifth", " ", "ACT", " ", "is", " ", "replaced", " ", "by", " ", 
      "ATT"}], " ", "-", " ", 
     RowBox[{
     "this", " ", "has", " ", "CAT", " ", "appended", " ", "to", " ", 
      RowBox[{"it", ".", "  ", "In"}], " ", "this", " ", "example"}]}], ",", 
    " ", 
    RowBox[{
    "the", " ", "high", " ", "variability", " ", "histidine", " ", "causes", 
     " ", "the", " ", "entire", " ", "rest", " ", "of", " ", "the", " ", 
     "\"\<gene\>\"", " ", "to", " ", "be", " ", "classified", " ", 
     "spuriously", " ", "as", " ", 
     RowBox[{"conserved", ".", "  ", "This"}], " ", "problem", " ", "can", 
     " ", "be", " ", "resolved", " ", "either", " ", "by", " ", "weighting", 
     " ", "or", " ", "by", " ", "ranking", " ", "the", " ", "data"}], ",", 
    " ", 
    RowBox[{"and", " ", "as", " ", "before"}], ",", " ", 
    RowBox[{
    "weighting", " ", "the", " ", "data", " ", "also", " ", "results", " ", 
     "in", " ", "the", " ", "conserved", " ", "central", " ", "region", " ", 
     "being", " ", 
     RowBox[{"identified", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"rawdata", "=", 
     RowBox[{
      RowBox[{"StringRepeat", "[", 
       RowBox[{"\"\<ATTATC\>\"", ",", "45"}], "]"}], "<>", 
      RowBox[{"StringRepeat", "[", 
       RowBox[{"\"\<ATAATA\>\"", ",", "10"}], "]"}], "<>", 
      RowBox[{"StringRepeat", "[", 
       RowBox[{"\"\<ATTATC\>\"", ",", "45"}], "]"}]}]}], ";", 
    RowBox[{"rawdata", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"rawdata", "<>", "\"\<CAT\>\""}], ",", 
       RowBox[{"rawdata", "<>", "\"\<CAC\>\""}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"rawdata", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ConstantArray", "[", 
         RowBox[{"rawdata", ",", "199"}], "]"}], ",", 
        RowBox[{
         RowBox[{"StringRepeat", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"StringRepeat", "[", 
             RowBox[{"\"\<ATTATC\>\"", ",", "4"}], "]"}], "<>", 
            "\"\<ATTATT\>\""}], ",", "9"}], "]"}], "<>", 
         RowBox[{"StringRepeat", "[", 
          RowBox[{"\"\<ATAATA\>\"", ",", "10"}], "]"}], "<>", 
         RowBox[{"StringRepeat", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"StringRepeat", "[", 
             RowBox[{"\"\<ATTATC\>\"", ",", "4"}], "]"}], "<>", 
            "\"\<ATTATT\>\""}], ",", "9"}], "]"}], "<>", "\"\<CAT\>\""}]}], 
       "}"}], "]"}]}], ";"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.88683447043172*^9, 3.8868345173760023`*^9}, {
   3.886834932114496*^9, 3.8868351406752462`*^9}, {3.886835196835724*^9, 
   3.886835205875606*^9}, {3.886835239171907*^9, 3.8868353373482533`*^9}, 
   3.886835690634933*^9},ExpressionUUID->"2a4367ea-03a0-4e94-87ce-\
ab190b23007a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Uncomment", " ", "the", " ", "following", " ", "for", " ", "a", " ", 
     "toy", " ", "example", " ", "\"\<gene\>\"", " ", "that", " ", 
     "illustrates", " ", "a", " ", "scenario", " ", "where", " ", "both", " ",
      "weighting", " ", "and", " ", "ranking", " ", "are", " ", "required", 
     " ", "to", " ", "identify", " ", "correctly", " ", "the", " ", 
     "conserved", " ", 
     RowBox[{"region", ".", "  ", "It"}], " ", "also", " ", "illustrates", 
     " ", "how", " ", "checking", " ", "for", " ", "interfering", " ", 
     "signals", " ", "can", " ", 
     RowBox[{"work", ".", "  ", "This"}], " ", "example", " ", "is", " ", 
     "identical", " ", "to", " ", "the", " ", "previous", " ", "one"}], ",", 
    " ", 
    RowBox[{
     RowBox[{"except", " ", "that", " ", "now", " ", "the", " ", "high"}], 
     "-", 
     RowBox[{
     "variability", " ", "histidine", " ", "codon", " ", "is", " ", "right", 
      " ", "in", " ", "the", " ", "middle", " ", "of", " ", "the", " ", 
      "otherwise"}], "-", 
     RowBox[{"conserved", " ", 
      RowBox[{"region", ".", "  ", "This"}], " ", "bisects", " ", "the", " ", 
      "spuriously", " ", "highly"}], "-", 
     RowBox[{"conserved", " ", "region", " ", "into", " ", "two"}]}], ",", 
    " ", 
    RowBox[{
    "such", " ", "that", " ", "the", " ", "individual", " ", "pieces", " ", 
     "are", " ", "only", " ", "called", " ", "as", " ", "conserved", " ", 
     "if", " ", "the", " ", "other", " ", "is", " ", 
     RowBox[{"discounted", ".", "  ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"So", " ", "in", " ", "this", " ", "case"}], ",", " ", 
        RowBox[{
        "the", " ", "checking", " ", "for", " ", "an", " ", "interfering", 
         " ", "signal", " ", "correctly", " ", "finds", " ", "a", " ", 
         "signal", " ", "that", " ", "is", " ", "present"}], ",", " ", 
        RowBox[{"but", " ", "it", " ", "is", " ", "a", " ", "spurious", " ", 
         RowBox[{"one", "."}]}]}], ")"}]}], "  ", "This", " ", "time"}], ",", 
    " ", 
    RowBox[{
    "either", " ", "weighting", " ", "or", " ", "ranking", " ", "the", " ", 
     "data", " ", "will", " ", "remove", " ", "the", " ", "spurious", " ", 
     "conserved", " ", "region", " ", "call"}], ",", " ", 
    RowBox[{
    "but", " ", "it", " ", "requires", " ", "both", " ", "weighting", " ", 
     "and", " ", "ranking", " ", "to", " ", "find", " ", "the", " ", "actual",
      " ", "conserved", " ", 
     RowBox[{"region", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"rawdata", "=", 
     RowBox[{
      RowBox[{"StringRepeat", "[", 
       RowBox[{"\"\<ATTATC\>\"", ",", "45"}], "]"}], "<>", 
      RowBox[{"StringRepeat", "[", 
       RowBox[{"\"\<ATAATA\>\"", ",", "5"}], "]"}], "<>", "\"\<CAC\>\"", "<>", 
      RowBox[{"StringRepeat", "[", 
       RowBox[{"\"\<ATAATA\>\"", ",", "5"}], "]"}], "<>", 
      RowBox[{"StringRepeat", "[", 
       RowBox[{"\"\<ATTATC\>\"", ",", "45"}], "]"}]}]}], ";", 
    RowBox[{"rawdata", "=", 
     RowBox[{"{", 
      RowBox[{"rawdata", ",", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"rawdata", ",", 
         RowBox[{"\"\<CAC\>\"", "->", "\"\<CAT\>\""}]}], "]"}]}], "}"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"rawdata", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ConstantArray", "[", 
         RowBox[{"rawdata", ",", "199"}], "]"}], ",", 
        RowBox[{
         RowBox[{"StringRepeat", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"StringRepeat", "[", 
             RowBox[{"\"\<ATTATC\>\"", ",", "4"}], "]"}], "<>", 
            "\"\<ATTATT\>\""}], ",", "9"}], "]"}], "<>", 
         RowBox[{"StringRepeat", "[", 
          RowBox[{"\"\<ATAATA\>\"", ",", "5"}], "]"}], "<>", "\"\<CAT\>\"", "<>", 
         RowBox[{"StringRepeat", "[", 
          RowBox[{"\"\<ATAATA\>\"", ",", "5"}], "]"}], "<>", 
         RowBox[{"StringRepeat", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"StringRepeat", "[", 
             RowBox[{"\"\<ATTATC\>\"", ",", "4"}], "]"}], "<>", 
            "\"\<ATTATT\>\""}], ",", "9"}], "]"}]}]}], "}"}], "]"}]}], ";"}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.886834732290214*^9, 3.886834786641712*^9}, {
   3.886834820801969*^9, 3.886834842866262*^9}, {3.886835065091098*^9, 
   3.886835072466963*^9}, {3.8868353632046957`*^9, 3.886835456773012*^9}, {
   3.8868354934292727`*^9, 3.8868356188379927`*^9}, 
   3.886835694282686*^9},ExpressionUUID->"ed056d7e-cf24-4d76-86c2-\
fe2ab811810a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"whichCalculations", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"True", ",", "True"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "True"}], "}"}]}], "}"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"Whether", " ", "to", " ", "do", " ", 
    RowBox[{"(", "1", ")"}], " ", "unweighted", " ", "calculation", " ", "on",
     " ", "raw", " ", "nPDs", " ", 
    RowBox[{"(", "2", ")"}], " ", "unweighted", " ", "calculation", " ", "on",
     " ", "ranked", " ", "nPDs", " ", 
    RowBox[{"(", "3", ")"}], " ", "weighted", " ", "calculation", " ", "on", 
    " ", "raw", " ", "nPDs", " ", 
    RowBox[{"(", "4", ")"}], " ", "weighted", " ", "calculation", " ", "on", 
    " ", "ranked", " ", "nPDs"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"doFullRuns", "=", "True"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Whether", " ", "to", " ", "do", " ", "full", " ", "runs", " ", "of", " ",
      "bootstrap", " ", "rearrangements", " ", "for", " ", "significance", 
     " ", "testing"}], ",", " ", 
    RowBox[{
     RowBox[{"to", " ", "quantify", " ", "non"}], "-", 
     RowBox[{"significant", " ", "results"}]}], ",", " ", 
    RowBox[{
     RowBox[{"or", " ", "to", " ", "stop", " ", "once", " ", "non"}], "-", 
     RowBox[{
      RowBox[{"significant", ".", "  ", "If"}], " ", "set", " ", "to", " ", 
      "\"\<true\>\""}]}], ",", " ", 
    RowBox[{
    "the", " ", "full", " ", "bootstrap", " ", "\"\<p-value\>\"", " ", "is", 
     " ", 
     RowBox[{"reported", ".", "  ", "If"}], " ", "set", " ", "to", " ", 
     "\"\<false\>\""}], ",", " ", 
    RowBox[{
     RowBox[{"then", " ", "any", " ", "p"}], "-", 
     RowBox[{
     "values", " ", "above", " ", "the", " ", "significance", " ", "level", 
      " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"set", " ", "to", " ", "0.05", " ", "in", " ", "code"}], ",", 
        " ", 
        RowBox[{"but", " ", "can", " ", "be", " ", "modified"}]}], ")"}], " ",
       "are", " ", "reported", " ", "as", " ", "1."}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"maxdropReplicates", "=", "10000"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Number", " ", "of", " ", "bootstrap", " ", "replicates", " ", "for", " ", 
    "significance", " ", "testing"}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
  "unmaskedSignificantRegionsOrExtraCalcs", "=", "\"\<unmaskedregions\>\""}], 
  ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "should", " ", "take", " ", "values", " ", "\"\<unmaskedregions\>\"", 
      " ", "or", " ", "\"\<extracalcs\>\""}], ";", " ", 
     RowBox[{
     "specifies", " ", "whether", " ", "to", " ", "use", " ", "the", " ", 
      "toggles", " ", "for", " ", "looking", " ", "for", " ", "extra", " ", 
      "regions", " ", "by", " ", "removing", " ", "following", " ", 
      "descents"}]}], ",", " ", 
    RowBox[{
    "or", " ", "just", " ", "do", " ", "a", " ", "number", " ", "of", " ", 
     "extra", " ", "calculations", " ", "for", " ", "information"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"numberExtraMaxdropCalcs", "=", "3"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Number", " ", "of", " ", "extra", " ", "descents", " ", "to", " ", 
      "check", " ", "after", " ", "the", " ", "first", " ", "non"}], "-", 
     RowBox[{
     "significant", " ", "one", " ", "when", " ", "running", " ", 
      "maxdrop"}]}], ",", "  ", 
    RowBox[{
     RowBox[{"-", " ", "present"}], " ", "to", " ", "allow", " ", "checking", 
     " ", "for", " ", "interfering", " ", "descents", " ", "masking", " ", 
     "each", " ", 
     RowBox[{"other", "'"}], "s", " ", "significance", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"note", " ", "lowest", " ", "value", " ", "is", " ", "0"}], 
        ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"and", " ", "should", " ", "be", " ", "integer"}], "-", 
          "valued"}], ";", " ", 
         RowBox[{
         "may", " ", "behave", " ", "unpredictably", " ", "otherwise"}]}]}], 
       ")"}], ".", "  ", "If"}], " ", "the", " ", "number", " ", "is", " ", 
     "set", " ", "to", " ", "1", " ", "or", " ", "greater"}], ",", " ", 
    RowBox[{
     RowBox[{
     "the", " ", "algorithm", " ", "will", " ", "do", " ", "an", " ", "extra",
       " ", "check", " ", "to", " ", "see", " ", "whether", " ", "the", " ", 
      "first", " ", "non"}], "-", 
     RowBox[{
     "significant", " ", "region", " ", "becomes", " ", "significant", " ", 
      "if", " ", "the", " ", "second", " ", "non"}], "-", 
     RowBox[{"significant", " ", "region", " ", "is", " ", "excised"}]}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"recordUnmaskedSignificantRegions", "=", "True"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "If", " ", "the", " ", "algorithm", " ", "is", " ", "set", " ", "to", " ",
      "do", " ", "an", " ", "extra", " ", "check", " ", "in", " ", "the", " ",
      "step", " ", "above"}], ",", " ", 
    RowBox[{
    "then", " ", "if", " ", "this", " ", "is", " ", "set", " ", "to", " ", 
     "True"}], ",", " ", 
    RowBox[{
     RowBox[{
     "in", " ", "cases", " ", "where", " ", "the", " ", "first", " ", "non"}],
      "-", 
     RowBox[{
     "significant", " ", "region", " ", "becomes", " ", "significant", " ", 
      "on", " ", "excision", " ", "of", " ", "the", " ", "next", " ", 
      "region"}]}], ",", " ", 
    RowBox[{
     RowBox[{"the", " ", "non"}], "-", 
     RowBox[{"signficant", " ", "region", " ", "will", " ", "be", " ", 
      RowBox[{"recorded", ".", "  ", "A"}], " ", "separate", " ", "record", 
      " ", "of", " ", "these", " ", "will", " ", "be", " ", "kept", " ", "so",
       " ", "that", " ", "they", " ", "can", " ", "get", " ", "a", " ", 
      "different", " ", 
      RowBox[{"highlight", "."}]}]}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.55167837166241*^9, 3.551678371670298*^9}, 
   3.553196750590575*^9, 3.554617939604347*^9, {3.554618124627896*^9, 
   3.554618127651335*^9}, {3.678969502902391*^9, 3.678969515886273*^9}, {
   3.705748592619006*^9, 3.7057485986780663`*^9}, {3.7057493350946693`*^9, 
   3.705749336210494*^9}, {3.706357091698742*^9, 3.706357115625781*^9}, {
   3.7104995530394983`*^9, 3.7104995740049458`*^9}, {3.720085299722252*^9, 
   3.720085339243642*^9}, {3.7200853947216053`*^9, 3.720085644740041*^9}, {
   3.720090200049275*^9, 3.720090218265525*^9}, {3.720090300118143*^9, 
   3.720090305046666*^9}, {3.7200903518608217`*^9, 3.720090416676753*^9}, {
   3.720090455634905*^9, 3.720090485866617*^9}, {3.72009054490528*^9, 
   3.7200905647370653`*^9}, {3.720090981855797*^9, 3.720090986721052*^9}, {
   3.720091597905575*^9, 3.720091597979879*^9}, {3.720854951129401*^9, 
   3.7208550510187387`*^9}, {3.720856125145784*^9, 3.7208562127445*^9}, {
   3.7208564317350883`*^9, 3.720856432167491*^9}, {3.720856799098833*^9, 
   3.720856799274955*^9}, {3.720857752619814*^9, 3.720857752709564*^9}, {
   3.721997599757183*^9, 3.721997600077674*^9}, {3.723894036282339*^9, 
   3.723894123314829*^9}, {3.72389424852639*^9, 3.723894249214447*^9}, {
   3.723895703374365*^9, 3.723895736740382*^9}, {3.723895770779881*^9, 
   3.723895803447373*^9}, {3.7238959216993513`*^9, 3.723895924994769*^9}, {
   3.723896093411914*^9, 3.723896105531191*^9}, 3.746640405734589*^9, {
   3.746640442232539*^9, 3.746640471418869*^9}, {3.74670224099242*^9, 
   3.746702280897369*^9}, {3.746811042580739*^9, 3.746811064774272*^9}, {
   3.746811422356653*^9, 3.7468114225399017`*^9}, {3.7473033842964993`*^9, 
   3.747303399473546*^9}, {3.747306689272643*^9, 3.74730668951934*^9}, {
   3.747307807673915*^9, 3.747307848976446*^9}, {3.747380498682143*^9, 
   3.747380520822144*^9}, {3.747380561121689*^9, 3.747380578782775*^9}, {
   3.775901793772773*^9, 3.775901815423499*^9}, {3.775911373145603*^9, 
   3.775911394724744*^9}, {3.775912743653481*^9, 3.775912793762817*^9}, {
   3.775984927830287*^9, 3.775984929652108*^9}, {3.775984974180169*^9, 
   3.7759849813639183`*^9}, 3.7759851881547318`*^9, {3.775999187658471*^9, 
   3.7759991915112677`*^9}, {3.776155263999593*^9, 3.776155267389683*^9}, {
   3.776770944919231*^9, 3.776770998886121*^9}, {3.777025953001091*^9, 
   3.777025986230728*^9}, {3.777030496952767*^9, 3.777030500517643*^9}, {
   3.7773733286678677`*^9, 3.777373338043902*^9}, {3.777714364729414*^9, 
   3.777714526120328*^9}, 3.777724906731286*^9, {3.7777938077971497`*^9, 
   3.777793883139143*^9}, 3.777807425767617*^9, 3.77780863052279*^9, {
   3.777808745163721*^9, 3.777808748364056*^9}, 3.777809938995085*^9, {
   3.777810832365419*^9, 3.7778108387612867`*^9}, {3.777812169489607*^9, 
   3.777812178277535*^9}, {3.77781316629669*^9, 3.777813170840461*^9}, 
   3.7778140145308523`*^9, 3.777814869285262*^9, {3.777815829039907*^9, 
   3.7778158306053333`*^9}, {3.777878793206312*^9, 3.7778788071801243`*^9}, 
   3.777883636333296*^9, 3.777900282016877*^9, 3.777967789184239*^9, {
   3.7779785549205103`*^9, 3.777978555028496*^9}, {3.777981534209025*^9, 
   3.7779815350821*^9}, {3.777983593174131*^9, 3.777983596933167*^9}, 
   3.7783317484068937`*^9, {3.778913179241445*^9, 3.778913182215055*^9}, {
   3.778915225029093*^9, 3.77891528753697*^9}, {3.778915339189431*^9, 
   3.778915378592988*^9}, {3.778916685838183*^9, 3.7789167017404337`*^9}, {
   3.7789177804540043`*^9, 3.778917780609139*^9}, {3.7789184349683123`*^9, 
   3.778918475477685*^9}, {3.778918510423848*^9, 3.778918518416251*^9}, 
   3.778919875591823*^9, {3.778922044559814*^9, 3.778922047215228*^9}, 
   3.77892297776753*^9, {3.778929576199298*^9, 3.778929576325893*^9}, {
   3.778935412654717*^9, 3.7789354127800417`*^9}, {3.779177721212471*^9, 
   3.7791777845084352`*^9}, {3.779177815739438*^9, 3.7791778434512987`*^9}, {
   3.779178782225444*^9, 3.7791788437136717`*^9}, 3.7791877437961693`*^9, {
   3.779188294040427*^9, 3.779188371015293*^9}, {3.7791905068684883`*^9, 
   3.779190507106613*^9}, {3.7791910208880177`*^9, 3.779191021191452*^9}, {
   3.779520755780987*^9, 3.779520756145854*^9}, {3.7796045152597446`*^9, 
   3.779604516969314*^9}, {3.779607626955803*^9, 3.779607659898089*^9}, {
   3.779607692890222*^9, 3.779607780232675*^9}, 3.779608109949383*^9, 
   3.779621866028303*^9, {3.779622187157535*^9, 3.7796221872138243`*^9}, {
   3.78003977383923*^9, 3.780039866086794*^9}, {3.78003992819908*^9, 
   3.78004012215228*^9}, {3.7800416195214577`*^9, 3.780041681650156*^9}, {
   3.78004174638632*^9, 3.7800418332327003`*^9}, {3.780042410853365*^9, 
   3.780042436259055*^9}, {3.780042974094194*^9, 3.780042974552554*^9}, {
   3.780046077424254*^9, 3.780046088156907*^9}, {3.780046127181123*^9, 
   3.780046378607379*^9}, {3.78004877065339*^9, 3.780048774877137*^9}, {
   3.7800541398816843`*^9, 3.780054140091074*^9}, {3.780127664859383*^9, 
   3.780127684902199*^9}, 3.780128061262755*^9, {3.780130100473875*^9, 
   3.780130110329948*^9}, {3.780130140562091*^9, 3.7801302823849297`*^9}, {
   3.780142273017675*^9, 3.780142314407713*^9}, 3.78075262880138*^9, {
   3.780818061932212*^9, 3.7808180777534*^9}, 3.7808182656282377`*^9, {
   3.786629795074288*^9, 3.7866298097527657`*^9}, {3.786793841607204*^9, 
   3.7867938447228727`*^9}, {3.7867938888579693`*^9, 
   3.7867939426394997`*^9}, {3.786793976026618*^9, 3.786794103994618*^9}, {
   3.786794147737915*^9, 3.786794221204793*^9}, {3.786796016643256*^9, 
   3.786796017156773*^9}, {3.786796084228038*^9, 3.786796088227488*^9}, {
   3.786799791019945*^9, 3.786799808239688*^9}, {3.786799881069161*^9, 
   3.786799960016715*^9}, {3.7868004533847647`*^9, 3.786800555366894*^9}, {
   3.786800656277204*^9, 3.786800673472788*^9}, {3.7868015591856937`*^9, 
   3.786801626744371*^9}, 3.7868018254798717`*^9, 3.786859943256057*^9, 
   3.7868938488323603`*^9, {3.786906954779541*^9, 3.786907013850327*^9}, {
   3.7869671888657227`*^9, 3.786967211006374*^9}, {3.786975916938463*^9, 
   3.786975923033111*^9}, {3.7870425702298727`*^9, 3.787042676410833*^9}, {
   3.787042870573449*^9, 3.787042917618751*^9}, {3.7870429565867023`*^9, 
   3.78704296713903*^9}, {3.787043296769841*^9, 3.7870433910007467`*^9}, {
   3.787049235627829*^9, 3.787049236066243*^9}, 3.787062365550519*^9, {
   3.787062492766739*^9, 3.78706250130965*^9}, {3.787062540278956*^9, 
   3.787062541492258*^9}, {3.787064153798147*^9, 3.7870641758854218`*^9}, {
   3.787199716067778*^9, 3.78719971885254*^9}, {3.78731896114251*^9, 
   3.78731896242385*^9}, {3.78732276333712*^9, 3.7873228791434593`*^9}, {
   3.787323453603525*^9, 3.787323456886463*^9}, {3.78732360182754*^9, 
   3.787323613573605*^9}, {3.787388978739141*^9, 3.787389150221238*^9}, {
   3.7873903609390907`*^9, 3.787390367719248*^9}, {3.787390474344329*^9, 
   3.787390495048276*^9}, {3.787402058902278*^9, 3.787402083140561*^9}, {
   3.787402117185141*^9, 3.787402117424917*^9}, {3.787402729303714*^9, 
   3.787402774213786*^9}, {3.787409956067903*^9, 3.787409969026396*^9}, {
   3.787410020850479*^9, 3.7874100209422293`*^9}, 3.787482276698374*^9, {
   3.7874935361614943`*^9, 3.787493566757328*^9}, {3.787493608965857*^9, 
   3.7874936348664103`*^9}, {3.787578611173876*^9, 3.787578617923646*^9}, {
   3.787648715326488*^9, 3.787648746125456*^9}, {3.787650078607069*^9, 
   3.787650078871212*^9}, {3.7876545713462973`*^9, 3.787654613645825*^9}, {
   3.787655133450067*^9, 3.787655133601365*^9}, {3.788086732348444*^9, 
   3.788086773785389*^9}, {3.788086984316934*^9, 3.788086987422398*^9}, {
   3.788087152767399*^9, 3.788087157135417*^9}, 3.788171473715667*^9, 
   3.7881716338800573`*^9, {3.788172366468216*^9, 3.788172370564962*^9}, {
   3.7886106806095963`*^9, 3.7886106961836777`*^9}, {3.7886107782724133`*^9, 
   3.788610779742959*^9}, {3.788610812028625*^9, 3.7886109935069323`*^9}, {
   3.7886124892006807`*^9, 3.7886124954659443`*^9}, {3.788615743912839*^9, 
   3.78861579398654*^9}, {3.788615879425623*^9, 3.788616016253433*^9}, {
   3.788616301644628*^9, 3.788616327786193*^9}, {3.788616468280341*^9, 
   3.788616468808221*^9}, {3.7886837428327312`*^9, 3.7886837554080772`*^9}, {
   3.788684407646338*^9, 3.788684427938266*^9}, {3.788686642198997*^9, 
   3.788686642549656*^9}, 3.78869903845716*^9, {3.789114374466619*^9, 
   3.789114374693282*^9}, {3.789124637194045*^9, 3.789124637673788*^9}, {
   3.789125149204885*^9, 3.789125150257053*^9}, {3.7891361194505873`*^9, 
   3.789136119998088*^9}, {3.789209794304665*^9, 3.7892097944455767`*^9}, 
   3.78921336025319*^9, 3.789213418372993*^9, 3.7892134724392357`*^9, 
   3.789213560592598*^9, 3.789213599417742*^9, 3.7892137013589163`*^9, 
   3.789213746318068*^9, 3.789213796525455*^9, {3.789214244446347*^9, 
   3.789214244653769*^9}, {3.7892142913305902`*^9, 3.7892142918917437`*^9}, {
   3.789392456671962*^9, 3.789392456828102*^9}, {3.78980890810786*^9, 
   3.789808908460537*^9}, {3.7898089441008167`*^9, 3.789808985410438*^9}, {
   3.789809675871603*^9, 3.7898096764251842`*^9}, {3.7898098354731083`*^9, 
   3.789809845927576*^9}, {3.78987986516929*^9, 3.78987986523953*^9}, 
   3.789900621521649*^9, {3.78997803995616*^9, 3.789978062527863*^9}, {
   3.789994504694158*^9, 3.789994518475663*^9}, {3.790327134944977*^9, 
   3.7903271422229433`*^9}, {3.7904229664004593`*^9, 3.790422966497364*^9}, {
   3.790423380212213*^9, 3.790423399731628*^9}, {3.790425371612816*^9, 
   3.790425382284026*^9}, {3.7904258807690477`*^9, 3.790425907519349*^9}, {
   3.790426057107253*^9, 3.790426130500951*^9}, {3.790684627869732*^9, 
   3.7906846330947933`*^9}, 3.790684677374181*^9, {3.794334339482183*^9, 
   3.794334343167798*^9}, {3.794334574047166*^9, 3.7943345746003513`*^9}, {
   3.794334611952469*^9, 3.794334612736047*^9}, {3.794335262767878*^9, 
   3.794335299062689*^9}, 3.794335415347746*^9, {3.7943357139308043`*^9, 
   3.794335715252686*^9}, {3.7943357814527407`*^9, 3.7943358023869658`*^9}, {
   3.7943359495799*^9, 3.794335950729556*^9}, {3.794335994984664*^9, 
   3.794335995562701*^9}, {3.7943362542449903`*^9, 3.7943362546653223`*^9}, {
   3.794420658795817*^9, 3.794420663136767*^9}, 3.794420784263479*^9, 
   3.794567862841708*^9, 3.79459099636819*^9, {3.79463382313129*^9, 
   3.794633833316139*^9}, {3.794885709173401*^9, 3.794885720046534*^9}, {
   3.7950843481844473`*^9, 3.795084404322874*^9}, {3.795084570309395*^9, 
   3.795084571241991*^9}, {3.7950920654927177`*^9, 3.795092066320444*^9}, 
   3.795518328897325*^9, {3.7956071267105837`*^9, 3.79560719111005*^9}, 
   3.795608250028508*^9, {3.795623065917666*^9, 3.7956231519653273`*^9}, 
   3.79562825483953*^9, 3.795749900534589*^9, {3.796182033802081*^9, 
   3.7961820583538303`*^9}, {3.797353813357607*^9, 3.7973538145762033`*^9}, {
   3.807250909318036*^9, 3.8072509180531893`*^9}, {3.807250950540471*^9, 
   3.807250969436689*^9}, {3.807421969720092*^9, 3.807422024643331*^9}, {
   3.808032322373374*^9, 3.808032334250494*^9}, {3.808032364722562*^9, 
   3.8080324673064117`*^9}, {3.808748153870687*^9, 3.808748214959971*^9}, {
   3.808829763820692*^9, 3.808829836768003*^9}, {3.817990026654831*^9, 
   3.81799008340742*^9}, {3.817991556312009*^9, 3.817991586994467*^9}, {
   3.817991892471395*^9, 3.8179919152636967`*^9}, 3.818080922305543*^9, {
   3.818491127479165*^9, 3.818491137211149*^9}, {3.8232854670977297`*^9, 
   3.823285467388996*^9}, {3.823329745552384*^9, 3.823329783579892*^9}, {
   3.823502576670889*^9, 3.823502605285563*^9}, {3.824579872776647*^9, 
   3.824579875366*^9}, {3.826012877607497*^9, 3.826013007127153*^9}, {
   3.826013265401608*^9, 3.826013286427162*^9}, {3.826013564666328*^9, 
   3.826013574810066*^9}, {3.826013684558922*^9, 3.826013703442109*^9}, {
   3.8260164547587347`*^9, 3.826016455147725*^9}, {3.826023741248967*^9, 
   3.826023745677534*^9}, {3.826630820111579*^9, 3.8266308206281652`*^9}, {
   3.827644218154769*^9, 3.827644218948681*^9}, {3.8276906094935417`*^9, 
   3.827690614161059*^9}, {3.827803647577889*^9, 3.827803653948923*^9}, {
   3.82789056004116*^9, 3.827890560101851*^9}, {3.8433703120890923`*^9, 
   3.843370313592115*^9}, {3.843375779442182*^9, 3.843375779567552*^9}, {
   3.859635958031273*^9, 3.859635959803577*^9}, 3.869154624302888*^9, {
   3.886673350388926*^9, 3.886673355220847*^9}, {3.88667339819718*^9, 
   3.886673482277597*^9}, {3.886675348110721*^9, 3.8866753487956867`*^9}, {
   3.886680338468364*^9, 
   3.886680339462842*^9}},ExpressionUUID->"f58b8be3-1372-4f7a-baa2-\
e55ae5a61acd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
First section: using an alignment of sequences from one gene, calculate amino \
acid frequency data, and work out normalised pairwise distances and Shannon \
information for each locus.\
\>", "Subsection",
 CellChangeTimes->{{3.8866722028964567`*^9, 3.886672286943982*^9}, 
   3.886672714865828*^9, {3.886673370100893*^9, 
   3.886673370388995*^9}},ExpressionUUID->"aaf35404-8243-4639-90ce-\
1436a64b51f4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"InitializationValue", "[", 
    RowBox[{"$HistoryLength", ",", " ", "\"\<Local\>\"", ",", " ", 
     RowBox[{"EvaluationEnvironment", "\[Rule]", "\"\<Subkernel\>\""}]}], 
    "]"}], "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LaunchKernels", "[", 
    RowBox[{"$ProcessorCount", "-", "1"}], "]"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "explicit", " ", "kernel", " ", "launching", " ", "ensures", 
    " ", "there", " ", "is", " ", "one", " ", "processor", " ", "available", 
    " ", "for", " ", "console", " ", "user"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kernels", " ", "=", " ", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"$KernelID", " ", "\[Rule]", " ", "ia"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"ia", ",", " ", "$KernelCount"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "variable", " ", "is", " ", "used", " ", "later", " ", "for", 
    " ", "indexing", " ", "to", " ", "report", " ", "evaluation", " ", 
    "progress"}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.55167837166241*^9, 3.551678371670298*^9}, 
   3.553196750590575*^9, 3.554617939604347*^9, {3.554618124627896*^9, 
   3.554618127651335*^9}, {3.678969502902391*^9, 3.678969515886273*^9}, {
   3.705748592619006*^9, 3.7057485986780663`*^9}, {3.7057493350946693`*^9, 
   3.705749336210494*^9}, {3.706357091698742*^9, 3.706357115625781*^9}, {
   3.7104995530394983`*^9, 3.7104995740049458`*^9}, {3.720085299722252*^9, 
   3.720085339243642*^9}, {3.7200853947216053`*^9, 3.720085644740041*^9}, {
   3.720090200049275*^9, 3.720090218265525*^9}, {3.720090300118143*^9, 
   3.720090305046666*^9}, {3.7200903518608217`*^9, 3.720090416676753*^9}, {
   3.720090455634905*^9, 3.720090485866617*^9}, {3.72009054490528*^9, 
   3.7200905647370653`*^9}, {3.720090981855797*^9, 3.720090986721052*^9}, {
   3.720091597905575*^9, 3.720091597979879*^9}, {3.720854951129401*^9, 
   3.7208550510187387`*^9}, {3.720856125145784*^9, 3.7208562127445*^9}, {
   3.7208564317350883`*^9, 3.720856432167491*^9}, {3.720856799098833*^9, 
   3.720856799274955*^9}, {3.720857752619814*^9, 3.720857752709564*^9}, {
   3.721997599757183*^9, 3.721997600077674*^9}, {3.723894036282339*^9, 
   3.723894123314829*^9}, {3.72389424852639*^9, 3.723894249214447*^9}, {
   3.723895703374365*^9, 3.723895736740382*^9}, {3.723895770779881*^9, 
   3.723895803447373*^9}, {3.7238959216993513`*^9, 3.723895924994769*^9}, {
   3.723896093411914*^9, 3.723896105531191*^9}, 3.746640405734589*^9, {
   3.746640442232539*^9, 3.746640471418869*^9}, {3.74670224099242*^9, 
   3.746702280897369*^9}, {3.746811042580739*^9, 3.746811064774272*^9}, {
   3.746811422356653*^9, 3.7468114225399017`*^9}, {3.7473033842964993`*^9, 
   3.747303399473546*^9}, {3.747306689272643*^9, 3.74730668951934*^9}, {
   3.747307807673915*^9, 3.747307848976446*^9}, {3.747380498682143*^9, 
   3.747380520822144*^9}, {3.747380561121689*^9, 3.747380578782775*^9}, {
   3.775901793772773*^9, 3.775901815423499*^9}, {3.775911373145603*^9, 
   3.775911394724744*^9}, {3.775912743653481*^9, 3.775912793762817*^9}, {
   3.775984927830287*^9, 3.775984929652108*^9}, {3.775984974180169*^9, 
   3.7759849813639183`*^9}, 3.7759851881547318`*^9, {3.775999187658471*^9, 
   3.7759991915112677`*^9}, {3.776155263999593*^9, 3.776155267389683*^9}, {
   3.776770944919231*^9, 3.776770998886121*^9}, {3.777025953001091*^9, 
   3.777025986230728*^9}, {3.777030496952767*^9, 3.777030500517643*^9}, {
   3.7773733286678677`*^9, 3.777373338043902*^9}, {3.777714364729414*^9, 
   3.777714526120328*^9}, 3.777724906731286*^9, {3.7777938077971497`*^9, 
   3.777793883139143*^9}, 3.777807425767617*^9, 3.77780863052279*^9, {
   3.777808745163721*^9, 3.777808748364056*^9}, 3.777809938995085*^9, {
   3.777810832365419*^9, 3.7778108387612867`*^9}, {3.777812169489607*^9, 
   3.777812178277535*^9}, {3.77781316629669*^9, 3.777813170840461*^9}, 
   3.7778140145308523`*^9, 3.777814869285262*^9, {3.777815829039907*^9, 
   3.7778158306053333`*^9}, {3.777878793206312*^9, 3.7778788071801243`*^9}, 
   3.777883636333296*^9, 3.777900282016877*^9, 3.777967789184239*^9, {
   3.7779785549205103`*^9, 3.777978555028496*^9}, {3.777981534209025*^9, 
   3.7779815350821*^9}, {3.777983593174131*^9, 3.777983596933167*^9}, 
   3.7783317484068937`*^9, {3.778913179241445*^9, 3.778913182215055*^9}, {
   3.778915225029093*^9, 3.77891528753697*^9}, {3.778915339189431*^9, 
   3.778915378592988*^9}, {3.778916685838183*^9, 3.7789167017404337`*^9}, {
   3.7789177804540043`*^9, 3.778917780609139*^9}, {3.7789184349683123`*^9, 
   3.778918475477685*^9}, {3.778918510423848*^9, 3.778918518416251*^9}, 
   3.778919875591823*^9, {3.778922044559814*^9, 3.778922047215228*^9}, 
   3.77892297776753*^9, {3.778929576199298*^9, 3.778929576325893*^9}, {
   3.778935412654717*^9, 3.7789354127800417`*^9}, {3.779177721212471*^9, 
   3.7791777845084352`*^9}, {3.779177815739438*^9, 3.7791778434512987`*^9}, {
   3.779178782225444*^9, 3.7791788437136717`*^9}, 3.7791877437961693`*^9, {
   3.779188294040427*^9, 3.779188371015293*^9}, {3.7791905068684883`*^9, 
   3.779190507106613*^9}, {3.7791910208880177`*^9, 3.779191021191452*^9}, {
   3.779520755780987*^9, 3.779520756145854*^9}, {3.7796045152597446`*^9, 
   3.779604516969314*^9}, {3.779607626955803*^9, 3.779607659898089*^9}, {
   3.779607692890222*^9, 3.779607780232675*^9}, 3.779608109949383*^9, 
   3.779621866028303*^9, {3.779622187157535*^9, 3.7796221872138243`*^9}, {
   3.78003977383923*^9, 3.780039866086794*^9}, {3.78003992819908*^9, 
   3.78004012215228*^9}, {3.7800416195214577`*^9, 3.780041681650156*^9}, {
   3.78004174638632*^9, 3.7800418332327003`*^9}, {3.780042410853365*^9, 
   3.780042436259055*^9}, {3.780042974094194*^9, 3.780042974552554*^9}, {
   3.780046077424254*^9, 3.780046088156907*^9}, {3.780046127181123*^9, 
   3.780046378607379*^9}, {3.78004877065339*^9, 3.780048774877137*^9}, {
   3.7800541398816843`*^9, 3.780054140091074*^9}, {3.780127664859383*^9, 
   3.780127684902199*^9}, 3.780128061262755*^9, {3.780130100473875*^9, 
   3.780130110329948*^9}, {3.780130140562091*^9, 3.7801302823849297`*^9}, {
   3.780142273017675*^9, 3.780142314407713*^9}, 3.78075262880138*^9, {
   3.780818061932212*^9, 3.7808180777534*^9}, 3.7808182656282377`*^9, {
   3.786629795074288*^9, 3.7866298097527657`*^9}, {3.786793841607204*^9, 
   3.7867938447228727`*^9}, {3.7867938888579693`*^9, 
   3.7867939426394997`*^9}, {3.786793976026618*^9, 3.786794103994618*^9}, {
   3.786794147737915*^9, 3.786794221204793*^9}, {3.786796016643256*^9, 
   3.786796017156773*^9}, {3.786796084228038*^9, 3.786796088227488*^9}, {
   3.786799791019945*^9, 3.786799808239688*^9}, {3.786799881069161*^9, 
   3.786799960016715*^9}, {3.7868004533847647`*^9, 3.786800555366894*^9}, {
   3.786800656277204*^9, 3.786800673472788*^9}, {3.7868015591856937`*^9, 
   3.786801626744371*^9}, 3.7868018254798717`*^9, 3.786859943256057*^9, 
   3.7868938488323603`*^9, {3.786906954779541*^9, 3.786907013850327*^9}, {
   3.7869671888657227`*^9, 3.786967211006374*^9}, {3.786975916938463*^9, 
   3.786975923033111*^9}, {3.7870425702298727`*^9, 3.787042676410833*^9}, {
   3.787042870573449*^9, 3.787042917618751*^9}, {3.7870429565867023`*^9, 
   3.78704296713903*^9}, {3.787043296769841*^9, 3.7870433910007467`*^9}, {
   3.787049235627829*^9, 3.787049236066243*^9}, 3.787062365550519*^9, {
   3.787062492766739*^9, 3.78706250130965*^9}, {3.787062540278956*^9, 
   3.787062541492258*^9}, {3.787064153798147*^9, 3.7870641758854218`*^9}, {
   3.787199716067778*^9, 3.78719971885254*^9}, {3.78731896114251*^9, 
   3.78731896242385*^9}, {3.78732276333712*^9, 3.7873228791434593`*^9}, {
   3.787323453603525*^9, 3.787323456886463*^9}, {3.78732360182754*^9, 
   3.787323613573605*^9}, {3.787388978739141*^9, 3.787389150221238*^9}, {
   3.7873903609390907`*^9, 3.787390367719248*^9}, {3.787390474344329*^9, 
   3.787390495048276*^9}, {3.787402058902278*^9, 3.787402083140561*^9}, {
   3.787402117185141*^9, 3.787402117424917*^9}, {3.787402729303714*^9, 
   3.787402774213786*^9}, {3.787409956067903*^9, 3.787409969026396*^9}, {
   3.787410020850479*^9, 3.7874100209422293`*^9}, 3.787482276698374*^9, {
   3.7874935361614943`*^9, 3.787493566757328*^9}, {3.787493608965857*^9, 
   3.7874936348664103`*^9}, {3.787578611173876*^9, 3.787578617923646*^9}, {
   3.787648715326488*^9, 3.787648746125456*^9}, {3.787650078607069*^9, 
   3.787650078871212*^9}, {3.7876545713462973`*^9, 3.787654613645825*^9}, {
   3.787655133450067*^9, 3.787655133601365*^9}, {3.788086732348444*^9, 
   3.788086773785389*^9}, {3.788086984316934*^9, 3.788086987422398*^9}, {
   3.788087152767399*^9, 3.788087157135417*^9}, 3.788171473715667*^9, 
   3.7881716338800573`*^9, {3.788172366468216*^9, 3.788172370564962*^9}, {
   3.7886106806095963`*^9, 3.7886106961836777`*^9}, {3.7886107782724133`*^9, 
   3.788610779742959*^9}, {3.788610812028625*^9, 3.7886109935069323`*^9}, {
   3.7886124892006807`*^9, 3.7886124954659443`*^9}, {3.788615743912839*^9, 
   3.78861579398654*^9}, {3.788615879425623*^9, 3.788616016253433*^9}, {
   3.788616301644628*^9, 3.788616327786193*^9}, {3.788616468280341*^9, 
   3.788616468808221*^9}, {3.7886837428327312`*^9, 3.7886837554080772`*^9}, {
   3.788684407646338*^9, 3.788684427938266*^9}, {3.788686642198997*^9, 
   3.788686642549656*^9}, 3.78869903845716*^9, {3.789114374466619*^9, 
   3.789114374693282*^9}, {3.789124637194045*^9, 3.789124637673788*^9}, {
   3.789125149204885*^9, 3.789125150257053*^9}, {3.7891361194505873`*^9, 
   3.789136119998088*^9}, {3.789209794304665*^9, 3.7892097944455767`*^9}, 
   3.78921336025319*^9, 3.789213418372993*^9, 3.7892134724392357`*^9, 
   3.789213560592598*^9, 3.789213599417742*^9, 3.7892137013589163`*^9, 
   3.789213746318068*^9, 3.789213796525455*^9, {3.789214244446347*^9, 
   3.789214244653769*^9}, {3.7892142913305902`*^9, 3.7892142918917437`*^9}, {
   3.789392456671962*^9, 3.789392456828102*^9}, {3.78980890810786*^9, 
   3.789808908460537*^9}, {3.7898089441008167`*^9, 3.789808985410438*^9}, {
   3.789809675871603*^9, 3.7898096764251842`*^9}, {3.7898098354731083`*^9, 
   3.789809845927576*^9}, {3.78987986516929*^9, 3.78987986523953*^9}, 
   3.789900621521649*^9, {3.78997803995616*^9, 3.789978062527863*^9}, {
   3.789994504694158*^9, 3.789994518475663*^9}, {3.790327134944977*^9, 
   3.7903271422229433`*^9}, {3.7904229664004593`*^9, 3.790422966497364*^9}, {
   3.790423380212213*^9, 3.790423399731628*^9}, {3.790425371612816*^9, 
   3.790425382284026*^9}, {3.7904258807690477`*^9, 3.790425907519349*^9}, {
   3.790426057107253*^9, 3.790426130500951*^9}, {3.790684627869732*^9, 
   3.7906846330947933`*^9}, 3.790684677374181*^9, {3.794334339482183*^9, 
   3.794334343167798*^9}, {3.794334574047166*^9, 3.7943345746003513`*^9}, {
   3.794334611952469*^9, 3.794334612736047*^9}, {3.794335262767878*^9, 
   3.794335299062689*^9}, 3.794335415347746*^9, {3.7943357139308043`*^9, 
   3.794335715252686*^9}, {3.7943357814527407`*^9, 3.7943358023869658`*^9}, {
   3.7943359495799*^9, 3.794335950729556*^9}, {3.794335994984664*^9, 
   3.794335995562701*^9}, {3.7943362542449903`*^9, 3.7943362546653223`*^9}, {
   3.794420658795817*^9, 3.794420663136767*^9}, 3.794420784263479*^9, 
   3.794567862841708*^9, 3.79459099636819*^9, {3.79463382313129*^9, 
   3.794633833316139*^9}, {3.794885709173401*^9, 3.794885720046534*^9}, {
   3.7950843481844473`*^9, 3.795084404322874*^9}, {3.795084570309395*^9, 
   3.795084571241991*^9}, {3.7950920654927177`*^9, 3.795092066320444*^9}, 
   3.795518328897325*^9, {3.7956071267105837`*^9, 3.79560719111005*^9}, 
   3.795608250028508*^9, {3.795623065917666*^9, 3.7956231519653273`*^9}, 
   3.79562825483953*^9, 3.795749900534589*^9, {3.796182033802081*^9, 
   3.7961820583538303`*^9}, {3.797353813357607*^9, 3.7973538145762033`*^9}, {
   3.807250909318036*^9, 3.8072509180531893`*^9}, {3.807250950540471*^9, 
   3.807250969436689*^9}, {3.807421969720092*^9, 3.807422024643331*^9}, {
   3.808032322373374*^9, 3.808032334250494*^9}, {3.808032364722562*^9, 
   3.8080324673064117`*^9}, {3.808748153870687*^9, 3.808748214959971*^9}, {
   3.808829763820692*^9, 3.808829836768003*^9}, {3.817990026654831*^9, 
   3.81799008340742*^9}, {3.817991556312009*^9, 3.817991586994467*^9}, {
   3.817991892471395*^9, 3.8179919152636967`*^9}, 3.818080922305543*^9, {
   3.818491127479165*^9, 3.818491137211149*^9}, {3.8232854670977297`*^9, 
   3.823285467388996*^9}, {3.823329745552384*^9, 3.823329783579892*^9}, {
   3.823502576670889*^9, 3.823502605285563*^9}, {3.824579872776647*^9, 
   3.824579875366*^9}, {3.886672301791883*^9, 3.886672315311819*^9}, {
   3.8866725704333344`*^9, 
   3.8866725874575663`*^9}},ExpressionUUID->"22eeebe8-d258-4b7d-bc03-\
8e316555003e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"LinearToTripletRev", "[", "n_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "+", 
      RowBox[{"IntegerPart", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", "1"}], ")"}], "/", "16"}], "]"}]}], ",", 
     RowBox[{"1", "+", 
      RowBox[{"IntegerPart", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", "1"}], ")"}], "/", "4"}], "]"}], "-", 
      RowBox[{"4", "*", 
       RowBox[{"IntegerPart", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "-", "1"}], ")"}], "/", "16"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{"n", "-", "1"}], ",", "4"}], "]"}], "+", "1"}]}], "}"}]}], 
  ";", 
  RowBox[{"numbertocodon", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "\[Rule]", "\"\<t\>\""}], ",", 
     RowBox[{"2", "\[Rule]", "\"\<c\>\""}], ",", 
     RowBox[{"3", "\[Rule]", "\"\<a\>\""}], ",", 
     RowBox[{"4", "\[Rule]", "\"\<g\>\""}]}], "}"}]}], ";", 
  RowBox[{"codonorder", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"LinearToTripletRev", "[", "i", "]"}], 
             "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "/.", 
            "numbertocodon"}], ")"}], "<>", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"LinearToTripletRev", "[", "i", "]"}], 
             "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "/.", 
            "numbertocodon"}], ")"}], "<>", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"LinearToTripletRev", "[", "i", "]"}], 
             "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], "/.", 
            "numbertocodon"}], ")"}]}], "\[Rule]", "i"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "64"}], "}"}]}], "]"}], ",", 
      RowBox[{"\"\<---\>\"", "\[Rule]", "65"}]}], "}"}], "]"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Translation", " ", "table", " ", "to", " ", "allow", " ", "recording", 
    " ", "codons", " ", "in", " ", "an", " ", "array"}], " ", 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.554486361848671*^9, 3.554486367624281*^9}, {
   3.554486453722509*^9, 3.554486483121034*^9}, {3.554486539928654*^9, 
   3.554486852260912*^9}, {3.55448689480138*^9, 3.55448735029816*^9}, {
   3.554487407297649*^9, 3.554487595991148*^9}, {3.554487635102188*^9, 
   3.554487648058933*^9}, 3.554487747809701*^9, {3.554488234950427*^9, 
   3.55448825250744*^9}, {3.55472803554217*^9, 3.554728045911122*^9}, {
   3.679182830108569*^9, 3.6791828902092743`*^9}, 
   3.886660260147979*^9},ExpressionUUID->"12fe2109-9b2b-476f-9b2f-\
dd04dfeaf102"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"nt", "=", 
    RowBox[{"{", 
     RowBox[{
     "\"\<t\>\"", ",", "\"\<c\>\"", ",", "\"\<a\>\"", ",", "\"\<g\>\""}], 
     "}"}]}], ";", 
   RowBox[{"codons", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"nt", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "<>", 
        RowBox[{"nt", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "<>", 
        RowBox[{"nt", "[", 
         RowBox[{"[", "k", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "4"}], "}"}]}], "]"}], "]"}]}], ";", 
   RowBox[{"AAcodes", "=", 
    RowBox[{"{", 
     RowBox[{
     "\"\<F\>\"", ",", "\"\<F\>\"", ",", "\"\<L\>\"", ",", "\"\<L\>\"", ",", 
      "\"\<S\>\"", ",", "\"\<S\>\"", ",", "\"\<S\>\"", ",", "\"\<S\>\"", ",", 
      "\"\<Y\>\"", ",", "\"\<Y\>\"", ",", "\"\<.\>\"", ",", "\"\<.\>\"", ",", 
      "\"\<C\>\"", ",", "\"\<C\>\"", ",", "\"\<.\>\"", ",", "\"\<W\>\"", ",", 
      "\"\<L\>\"", ",", "\"\<L\>\"", ",", "\"\<L\>\"", ",", "\"\<L\>\"", ",", 
      "\"\<P\>\"", ",", "\"\<P\>\"", ",", "\"\<P\>\"", ",", "\"\<P\>\"", ",", 
      "\"\<H\>\"", ",", "\"\<H\>\"", ",", "\"\<Q\>\"", ",", "\"\<Q\>\"", ",", 
      "\"\<R\>\"", ",", "\"\<R\>\"", ",", "\"\<R\>\"", ",", "\"\<R\>\"", ",", 
      "\"\<I\>\"", ",", "\"\<I\>\"", ",", "\"\<I\>\"", ",", "\"\<M\>\"", ",", 
      "\"\<T\>\"", ",", "\"\<T\>\"", ",", "\"\<T\>\"", ",", "\"\<T\>\"", ",", 
      "\"\<N\>\"", ",", "\"\<N\>\"", ",", "\"\<K\>\"", ",", "\"\<K\>\"", ",", 
      "\"\<S\>\"", ",", "\"\<S\>\"", ",", "\"\<R\>\"", ",", "\"\<R\>\"", ",", 
      "\"\<V\>\"", ",", "\"\<V\>\"", ",", "\"\<V\>\"", ",", "\"\<V\>\"", ",", 
      "\"\<A\>\"", ",", "\"\<A\>\"", ",", "\"\<A\>\"", ",", "\"\<A\>\"", ",", 
      "\"\<D\>\"", ",", "\"\<D\>\"", ",", "\"\<E\>\"", ",", "\"\<E\>\"", ",", 
      "\"\<G\>\"", ",", "\"\<G\>\"", ",", "\"\<G\>\"", ",", "\"\<G\>\""}], 
     "}"}]}], ";", 
   RowBox[{"translations", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"codons", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
       RowBox[{"AAcodes", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "64"}], "}"}]}], "]"}]}], ";", 
   RowBox[{"translationsmissingnt", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"translations", ",", 
       RowBox[{"\"\<---\>\"", "\[Rule]", "\"\<-\>\""}]}], "}"}], "]"}]}], ";", 
   RowBox[{"AAorder", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<G\>\"", "\[Rule]", "1"}], ",", 
      RowBox[{"\"\<A\>\"", "\[Rule]", "2"}], ",", 
      RowBox[{"\"\<L\>\"", "\[Rule]", "3"}], ",", 
      RowBox[{"\"\<M\>\"", "\[Rule]", "4"}], ",", 
      RowBox[{"\"\<F\>\"", "\[Rule]", "5"}], ",", 
      RowBox[{"\"\<W\>\"", "\[Rule]", "6"}], ",", 
      RowBox[{"\"\<K\>\"", "\[Rule]", "7"}], ",", 
      RowBox[{"\"\<Q\>\"", "\[Rule]", "8"}], ",", 
      RowBox[{"\"\<E\>\"", "\[Rule]", "9"}], ",", 
      RowBox[{"\"\<S\>\"", "\[Rule]", "10"}], ",", 
      RowBox[{"\"\<P\>\"", "\[Rule]", "11"}], ",", 
      RowBox[{"\"\<V\>\"", "\[Rule]", "12"}], ",", 
      RowBox[{"\"\<I\>\"", "\[Rule]", "13"}], ",", 
      RowBox[{"\"\<C\>\"", "\[Rule]", "14"}], ",", 
      RowBox[{"\"\<Y\>\"", "\[Rule]", "15"}], ",", 
      RowBox[{"\"\<H\>\"", "\[Rule]", "16"}], ",", 
      RowBox[{"\"\<R\>\"", "\[Rule]", "17"}], ",", 
      RowBox[{"\"\<N\>\"", "\[Rule]", "18"}], ",", 
      RowBox[{"\"\<D\>\"", "\[Rule]", "19"}], ",", 
      RowBox[{"\"\<T\>\"", "\[Rule]", "20"}], ",", 
      RowBox[{"\"\<.\>\"", "\[Rule]", "21"}], ",", 
      RowBox[{"\"\<-\>\"", "\[Rule]", "22"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Translation", " ", "tables", " ", "to", " ", "allow", " ", "recording", 
    " ", "amino", " ", "acids", " ", "in", " ", "an", " ", "array"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"codonnumbertoaanumbersub", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Reverse", "/@", "codonorder"}], "/.", "translationsmissingnt"}],
     "/.", "AAorder"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"codonnumbertoaanumber", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"j", "/.", "codonnumbertoaanumbersub"}], ")"}], "\[Equal]", 
         "i"}], ",", "1", ",", "0"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "22"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "65"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Conversion", " ", "table", " ", "from", " ", "a", " ", "numerical", " ", 
    "codon", " ", "representation", " ", "to", " ", "a", " ", "numerical", 
    " ", "amino", " ", "acid", " ", "representation"}], " ", 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8866646700434713`*^9, 3.886664692587978*^9}, {
   3.886664745643257*^9, 3.886664758667468*^9}, {3.886665401209955*^9, 
   3.8866654535199823`*^9}, 
   3.886751190046397*^9},ExpressionUUID->"e2beae8c-d6f1-4aa0-a8ac-\
6fc56ee665fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Triples", "[", "x_", "]"}], ":=", 
   RowBox[{"StringJoin", "/@", 
    RowBox[{"Partition", "[", 
     RowBox[{
      RowBox[{"Characters", "[", "x", "]"}], ",", "3"}], "]"}]}]}], ";", " ", 
  
  RowBox[{"(*", " ", 
   RowBox[{
   "Just", " ", "turns", " ", "a", " ", "string", " ", "of", " ", 
    "characters", " ", "in", " ", "to", " ", "a", " ", "list", " ", "of", " ",
     "strings", " ", "of", " ", "three", " ", "characters"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.7940378680415773`*^9, 3.7940379311154823`*^9}, {
   3.794038258432968*^9, 3.7940382698152523`*^9}, {3.794042880200914*^9, 
   3.794042910140314*^9}, {3.795922638101028*^9, 3.795922771961837*^9}, {
   3.8062553501955833`*^9, 3.806255399993783*^9}, {3.806255456130657*^9, 
   3.806255470549798*^9}, {3.8062555260105343`*^9, 3.806255529795011*^9}, {
   3.806255833533449*^9, 3.806255836505514*^9}, 3.82566884478323*^9, {
   3.825668987425705*^9, 3.825668999206936*^9}, {3.886660274419991*^9, 
   3.8866602870439377`*^9}},ExpressionUUID->"179135ba-7807-4395-bb1e-\
4017ba3f6212"],

Cell[BoxData[
 RowBox[{
  RowBox[{"aaalignedntstriples", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ToLowerCase", "[", 
      RowBox[{"Triples", "[", 
       RowBox[{
       "rawdata", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
       "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "rawdata", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.679183275308279*^9, 3.679183353621324*^9}, {
  3.8595522227431498`*^9, 3.859552269374649*^9}, {3.859552678246937*^9, 
  3.859552680415042*^9}, {3.8595571661141453`*^9, 3.859557170216206*^9}, {
  3.8866601095072823`*^9, 
  3.886660131795219*^9}},ExpressionUUID->"e30f8f2c-4e65-4e34-a7ce-\
1ec6a4e2736e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"aaalignedntsnumbers", "=", 
   RowBox[{"aaalignedntstriples", "/.", "codonorder"}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Record", " ", "of", " ", "sequences", " ", "using", " ", "a", " ", 
    "numerical", " ", "substitution", " ", "suitable", " ", "for", " ", 
    "counting", " ", "for", " ", 
    RowBox[{"MPDs", "."}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.679183275308279*^9, 3.679183353621324*^9}, {
  3.8595522227431498`*^9, 3.859552269374649*^9}, {3.859552678246937*^9, 
  3.859552680415042*^9}, {3.8595571661141453`*^9, 3.859557170216206*^9}, {
  3.88666061971085*^9, 
  3.886660621285581*^9}},ExpressionUUID->"8fd38050-7d8c-417f-b031-\
063f8c24d0bf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"codondistributionsbylocation", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Count", "[", 
      RowBox[{
       RowBox[{"aaalignedntsnumbers", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "i"}], "\[RightDoubleBracket]"}], ",", "j"}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{
        "aaalignedntsnumbers", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "65"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"For", " ", "each", " ", "gene"}], ",", " ", 
    RowBox[{"for", " ", "each", " ", "locus"}], ",", " ", 
    RowBox[{
     RowBox[{"has", " ", "a", " ", "65"}], "-", 
     RowBox[{
     "tuple", " ", "counting", " ", "the", " ", "number", " ", "of", " ", 
      "samples", " ", "giving", " ", "each", " ", "codon", " ", 
      RowBox[{"(", 
       RowBox[{"plus", " ", "blank"}], ")"}]}]}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.679183843691957*^9, 3.679183911389626*^9}, {
  3.6791840370295153`*^9, 3.679184080725717*^9}, {3.679184135997654*^9, 
  3.679184159085557*^9}, {3.679184213469767*^9, 3.679184214437778*^9}, {
  3.679184312478527*^9, 3.679184336701622*^9}, {3.859552465622775*^9, 
  3.8595524676955338`*^9}, {3.8595525075750637`*^9, 3.859552507783059*^9}, {
  3.859552658031309*^9, 3.859552673191395*^9}, {3.859558047102664*^9, 
  3.8595580472693644`*^9}, {3.886660647189967*^9, 
  3.8866606844543533`*^9}},ExpressionUUID->"3142baa4-9f87-4835-9dd5-\
ee6a57c9f044"],

Cell[BoxData[
 RowBox[{
  RowBox[{"codondistributions", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "1"}], 
        RowBox[{"Length", "[", "codondistributionsbylocation", "]"}]], 
       RowBox[{"codondistributionsbylocation", "\[LeftDoubleBracket]", 
        RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}], ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "65"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Expected", " ", "codon", " ", "distributions", " ", "to", " ", "allow", 
    " ", "weighting", " ", "by", " ", "codon", " ", "distribution"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.8866616498210773`*^9, 
  3.886661739947893*^9}},ExpressionUUID->"4825d75e-689e-4f9a-8c0a-\
b66048c2da5e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"totalcodonsperaa", "=", 
   RowBox[{"codonnumbertoaanumber", ".", "codondistributions"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "allows", " ", "normalising", " ", "by", " ", "the", " ", 
    "total", " ", "number", " ", "of", " ", "codons", " ", "in", " ", "a", 
    " ", "minute"}], " ", "*)"}]}]}], "Input",ExpressionUUID->"22fb25a0-5b44-\
4021-a7b7-a39d124bc42d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"aanumbertoexpectedcodonnumber", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"i", "/.", "codonnumbertoaanumbersub"}], ")"}], "\[Equal]",
           "j"}], "&&", 
         RowBox[{
          RowBox[{
          "totalcodonsperaa", "\[LeftDoubleBracket]", "j", 
           "\[RightDoubleBracket]"}], "\[NotEqual]", "0"}]}], ",", 
        RowBox[{
         RowBox[{
         "codondistributions", "\[LeftDoubleBracket]", "i", 
          "\[RightDoubleBracket]"}], "/", 
         RowBox[{
         "totalcodonsperaa", "\[LeftDoubleBracket]", "j", 
          "\[RightDoubleBracket]"}]}], ",", "0"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "65"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "22"}], "}"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Second", " ", "term", " ", "in", " ", "condition", " ", "takes", " ", 
     "into", " ", "account", " ", "possibility", " ", "that", " ", "there", 
     " ", "is", " ", "no", " ", "example", " ", "of", " ", "a", " ", 
     "particular", " ", "amino", " ", "acid", " ", "in", " ", "the", " ", 
     "set"}], " ", "-", " ", 
    RowBox[{
    "most", " ", "probable", " ", "with", " ", "STOPs", " ", "or", " ", 
     "gaps"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.7087770124463873`*^9, 3.708777023143071*^9}, {
   3.7087770543861027`*^9, 3.70877708634053*^9}, {3.708777128368251*^9, 
   3.708777162086899*^9}, 3.708777213452323*^9, {3.708841246580228*^9, 
   3.708841291057732*^9}, {3.7088413326614847`*^9, 3.70884137763196*^9}, {
   3.8260123762109547`*^9, 
   3.826012384681987*^9}},ExpressionUUID->"94bb8a6a-a04e-4105-a5f9-\
14b740d229f8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"blankblankdistance", "=", "0"}], ";", 
   RowBox[{"RawDistanceConversionMatrix", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "/", "2"}], ")"}], "*", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"i", "\[Equal]", "65"}], "||", 
          RowBox[{"j", "\[Equal]", "65"}]}], ",", "blankblankdistance", ",", 
         RowBox[{"HammingDistance", "[", 
          RowBox[{
           RowBox[{"LinearToTripletRev", "[", "i", "]"}], ",", 
           RowBox[{"LinearToTripletRev", "[", "j", "]"}]}], "]"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "65"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "65"}], "}"}]}], "]"}]}]}], ";", 
   RowBox[{"BlankCorrectionVector", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "64"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"blankblankdistance", "/", "2"}], "}"}]}], "}"}], "]"}]}], 
   ";", 
   RowBox[{
    RowBox[{"ObservedDistance", "[", "v1_", "]"}], ":=", 
    RowBox[{
     RowBox[{"v1", ".", "RawDistanceConversionMatrix", ".", "v1"}], "-", 
     RowBox[{"BlankCorrectionVector", ".", "v1"}]}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Pre", "-", 
     RowBox[{
     "calculated", " ", "matrix", " ", "of", " ", "Hamming", " ", "distances",
       " ", "between", " ", "codons", " ", "to", " ", "allow", " ", "matrix", 
      " ", "multiplication", " ", "for", " ", "distance", " ", 
      RowBox[{"calculation", ".", "  ", "Allows"}], " ", "the", " ", 
      "distance", " ", "between", " ", "a", " ", "blank", " ", "and", " ", 
      "any", " ", "other", " ", "codon", " ", 
      RowBox[{"(", 
       RowBox[{"including", " ", "a", " ", "blank"}], ")"}], " ", "to", " ", 
      "be", " ", "a", " ", "special", " ", "case"}]}], ",", " ", 
    RowBox[{"set", " ", "by", " ", 
     RowBox[{"blankblankdistance", ".", "  ", "Values"}], " ", "one", " ", 
     "is", " ", "likely", " ", "to", " ", "want", " ", "are", " ", "3", " ", 
     "for", " ", "maximal", " ", "distance"}], ",", " ", 
    RowBox[{"and", " ", "0", " ", "to", " ", "ignore", " ", "blanks", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
       "but", " ", "note", " ", "the", " ", "codon", " ", "is", " ", "still", 
        " ", "treated", " ", "as", " ", "existing", " ", "unless", " ", 
        "removed", " ", "below", " ", "by", " ", "setting", " ", 
        "ignoreblanks", " ", "to", " ", "True"}], ")"}], ".", " ", "Note"}], 
     " ", "there", " ", "is", " ", "a", " ", "factor", " ", "of", " ", 
     RowBox[{"1", "/", "2"}], " ", "to", " ", "take", " ", "into", " ", 
     "account", " ", "that", " ", "when", " ", "a", " ", "vector", " ", "of", 
     " ", "frequencies", " ", "has", " ", "an", " ", "inner", " ", "product", 
     " ", "applied", " ", "by", " ", "this", " ", "matrix"}], ",", " ", 
    RowBox[{
     RowBox[{
     "then", " ", "each", " ", "codon", " ", "in", " ", "each", " ", "sample",
       " ", "is", " ", "counted", " ", 
      RowBox[{"twice", ".", " ", "If"}], " ", "the", " ", "blank", " ", 
      "distance", " ", "is", " ", "non"}], "-", "zero"}], ",", " ", 
    RowBox[{
    "then", " ", "a", " ", "correction", " ", "needs", " ", "to", " ", "be", 
     " ", "applied", " ", "to", " ", "ensure", " ", "the", " ", "distance", 
     " ", "between", " ", "a", " ", "blank", " ", "and", " ", "itself", " ", 
     "is", " ", 
     RowBox[{"zero", "."}]}]}], "  ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.55448173030081*^9, 3.554481781010901*^9}, {
   3.554481927050778*^9, 3.554481956881623*^9}, {3.554482023506136*^9, 
   3.554482082992849*^9}, {3.55448214617068*^9, 3.554482148954445*^9}, {
   3.554482202350874*^9, 3.554482214862553*^9}, {3.554482418203251*^9, 
   3.554482420249675*^9}, {3.55448246196121*^9, 3.554482477778162*^9}, {
   3.55448273830272*^9, 3.554482843052562*^9}, {3.554483159696259*^9, 
   3.554483177657148*^9}, {3.554494451122223*^9, 3.554494452754404*^9}, 
   3.554494695308369*^9, 3.554878647297841*^9, {3.554879127481898*^9, 
   3.554879131473679*^9}, {3.555012076674414*^9, 3.555012082925368*^9}, {
   3.555012135490297*^9, 3.555012161523285*^9}, {3.555012305524688*^9, 
   3.555012408696934*^9}, {3.555012454441543*^9, 3.555012684742163*^9}, {
   3.555089472679948*^9, 3.555089550830911*^9}, 3.555089813216864*^9, {
   3.555090569356776*^9, 3.555090582533747*^9}, {3.555092816371734*^9, 
   3.555092817887939*^9}, {3.55515584072411*^9, 3.555155850236516*^9}, {
   3.555156014938532*^9, 3.555156021021357*^9}, {3.555157927353486*^9, 
   3.555157927674218*^9}, {3.555860400677518*^9, 3.555860421812564*^9}, {
   3.555941629607563*^9, 3.555941632193319*^9}, {3.556172975904763*^9, 
   3.556172976686921*^9}, {3.556372802385252*^9, 3.556372803964513*^9}, {
   3.556380861854304*^9, 3.556380862383395*^9}, {3.560972218475801*^9, 
   3.560972238714363*^9}, 3.679184812457694*^9, {3.67918508302265*^9, 
   3.679185084157364*^9}, {3.67918514903055*^9, 3.679185167958556*^9}, {
   3.6791852968465853`*^9, 3.679185384454794*^9}, {3.6791856595514507`*^9, 
   3.6791857494875793`*^9}, 
   3.679185865047728*^9},ExpressionUUID->"682f1fc1-2546-41b0-bc5b-\
7cbf3b98583b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PreMultipliedForExpectedDistancesMatrix", "=", 
   RowBox[{
    RowBox[{"Transpose", "[", "codonnumbertoaanumber", "]"}], ".", 
    RowBox[{"Transpose", "[", "aanumbertoexpectedcodonnumber", "]"}], ".", 
    "RawDistanceConversionMatrix", ".", "aanumbertoexpectedcodonnumber", ".", 
    "codonnumbertoaanumber"}]}], ";", 
  RowBox[{
   RowBox[{"ExpectedDistance", "[", "v1_", "]"}], ":=", 
   RowBox[{
    RowBox[{"v1", ".", "PreMultipliedForExpectedDistancesMatrix", ".", "v1"}],
     "-", 
    RowBox[{"BlankCorrectionVector", ".", "v1"}]}]}], ";", 
  RowBox[{
   RowBox[{"numberpairs", "[", "sequences_", "]"}], ":=", 
   RowBox[{"sequences", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"sequences", "-", "1"}], ")"}], "/", "2"}]}]}]}]], "Input",
 CellChangeTimes->{{3.554492373359594*^9, 3.554492375204275*^9}, {
   3.5544925227165728`*^9, 3.554492533665123*^9}, {3.554492594275171*^9, 
   3.554492611536557*^9}, {3.554492660483639*^9, 3.55449269588813*^9}, 
   3.554492728673126*^9, {3.554492795832373*^9, 3.554492803853026*^9}, {
   3.554492905232925*^9, 3.554492909768436*^9}, {3.554492966191342*^9, 
   3.554493004339983*^9}, {3.554493164619358*^9, 3.554493168256411*^9}, {
   3.554493201920428*^9, 3.554493222302197*^9}, {3.554658721586971*^9, 
   3.554658722040918*^9}},ExpressionUUID->"40b20e54-c2cb-44b0-aa5c-\
fb660e771c15"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PDs", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"ObservedDistance", ",", "codondistributionsbylocation", ",", 
     RowBox[{"{", "1", "}"}]}], "]"}]}], ";", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Per", " ", "locus", " ", "pairwise", " ", "distances"}], " ", 
    "-", " ", 
    RowBox[{"no", " ", "normalisation"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.826006948946982*^9, 3.826006961338237*^9}, {
   3.826007171623597*^9, 3.826007182135991*^9}, {3.8260073756137943`*^9, 
   3.8260073843172073`*^9}, 3.859558168814945*^9, 
   3.886665570943058*^9},ExpressionUUID->"0a630565-e708-475e-ad62-\
60944f2e027e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"codonUsageMatrix", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"ParallelTable", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
          "codonnumbertoaanumber", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ".", "codondistributions"}], "\[Equal]",
          "0"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "65"}], "}"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
           "codonnumbertoaanumber", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], "*", "codondistributions"}], ")"}], 
         "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
           "codonnumbertoaanumber", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ".", "codondistributions"}], ")"}]}]}],
        "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "22"}], "}"}]}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.775902639496743*^9, 3.7759026658105907`*^9}, {
   3.7759027575133057`*^9, 3.775902762601265*^9}, {3.775902828728945*^9, 
   3.775902830676147*^9}, {3.775904020998246*^9, 3.7759040371997433`*^9}, {
   3.7759040772157307`*^9, 3.775904087722403*^9}, {3.775904252212805*^9, 
   3.775904255183877*^9}, 3.775905898758115*^9, {3.7767711038473797`*^9, 
   3.776771104710845*^9}},ExpressionUUID->"271348d2-dca3-42c5-968d-\
97aeabd283e7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"numSeqs", "=", 
   RowBox[{"Total", "[", 
    RowBox[{
    "codondistributionsbylocation", "\[LeftDoubleBracket]", "1", 
     "\[RightDoubleBracket]"}], "]"}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Number", " ", "of", " ", "sequences"}], " ", "-", " ", 
    RowBox[{
    "can", " ", "use", " ", "the", " ", "first", " ", "locus", " ", "because",
      " ", "the", " ", "number", " ", "of", " ", "sequences", " ", "per", " ",
      "locus", " ", "is", " ", "the", " ", "same"}]}], " ", "*)"}]}]], "Input",\

 CellChangeTimes->{{3.8260080521589622`*^9, 3.826008053269187*^9}, {
   3.826008132691517*^9, 3.8260081660652723`*^9}, 3.85955261345542*^9, 
   3.859558170327977*^9, {3.8866658691365843`*^9, 3.886665878266852*^9}, 
   3.886751456515004*^9, {3.8867515018592854`*^9, 
   3.88675150350705*^9}},ExpressionUUID->"af35b42f-3206-4de9-9e47-\
ad1c4163a96f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"codonExpectedUsageByLocation", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Total", ",", 
     RowBox[{"Map", "[", 
      RowBox[{"Transpose", ",", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{"#", ",", "codonUsageMatrix"}], "]"}], "&"}], ",", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Dot", "[", 
             RowBox[{"#", ",", "codonnumbertoaanumber"}], "]"}], "&"}], ",", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Dot", "[", 
               RowBox[{"codonnumbertoaanumber", ",", "#"}], "]"}], "&"}], ",", 
             RowBox[{"(", 
              RowBox[{"codondistributionsbylocation", "/", "numSeqs"}], ")"}],
              ",", 
             RowBox[{"{", "1", "}"}]}], "]"}], ",", 
           RowBox[{"{", "1", "}"}]}], "]"}], ",", 
         RowBox[{"{", "1", "}"}]}], "]"}], ",", 
       RowBox[{"{", "1", "}"}]}], "]"}], ",", 
     RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "A", " ", "table", " ", "multiplying", " ", "the", " ", "amino", " ", 
     "acid", " ", "probability", " ", "at", " ", "a", " ", "locus", " ", "by",
      " ", "the", " ", "codon", " ", "usage", " ", "probability", " ", "per", 
     " ", "amino", " ", "acid", " ", "used", " ", "for", " ", "the", " ", 
     "genome"}], ",", " ", 
    RowBox[{
    "to", " ", "give", " ", "an", " ", "expected", " ", "usage", " ", 
     "proportion", " ", "of", " ", "each", " ", "codon", " ", "at", " ", "a", 
     " ", "particular", " ", "locus", " ", "assuming", " ", "background", " ",
      "codon", " ", "usage", " ", "and", " ", "fixed", " ", "amino", " ", 
     "acid", " ", 
     RowBox[{"distribution", ".", "  ", "Used"}], " ", "to", " ", "give", " ",
      "a", " ", "probability", " ", "mass", " ", "function", " ", "per", " ", 
     
     RowBox[{"locus", "."}]}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7759061030906878`*^9, 3.775906172974821*^9}, {
   3.7759062088509817`*^9, 3.775906306424261*^9}, {3.775906352788609*^9, 
   3.775906359017303*^9}, {3.775907009531169*^9, 3.775907013631794*^9}, {
   3.776771108199336*^9, 3.776771109046871*^9}, {3.787056784202429*^9, 
   3.787056936107341*^9}, {3.789736557829051*^9, 3.78973656489303*^9}, {
   3.789736641293007*^9, 3.789736649342658*^9}, {3.7897367459192667`*^9, 
   3.789736748510181*^9}, {3.79432546753646*^9, 3.794325508878125*^9}, {
   3.795627949413567*^9, 3.7956279498517933`*^9}, {3.826007764564423*^9, 
   3.826007769963395*^9}, {3.82600780106008*^9, 3.826007803187784*^9}, 
   3.8260080441582117`*^9, 3.826009356371484*^9, 3.826011098752204*^9, 
   3.826011514088732*^9, {3.826011619366322*^9, 3.826011649310512*^9}, 
   3.859558337949379*^9, {3.8866661757943687`*^9, 
   3.886666198754368*^9}},ExpressionUUID->"cb7fc0ab-17e2-4565-aa85-\
01bb3ad279de"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"expectedPD", "[", "pos_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"blankblankdistance", "\[NotEqual]", " ", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<WARNING: expected PD code does not take into account a non-zero \
distance between blank codons.\>\"", "]"}]}], "]"}], ";", 
     RowBox[{"numSeqs", "*", 
      RowBox[{"(", 
       RowBox[{"numSeqs", "-", "1"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
        "codonExpectedUsageByLocation", "\[LeftDoubleBracket]", "pos", 
         "\[RightDoubleBracket]"}], ".", "RawDistanceConversionMatrix", ".", 
        RowBox[{
        "codonExpectedUsageByLocation", "\[LeftDoubleBracket]", "pos", 
         "\[RightDoubleBracket]"}]}], ")"}]}]}], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.780053315157804*^9, 3.780053358851191*^9}, 
   3.780053430324415*^9, {3.780137777050967*^9, 3.7801377856876497`*^9}, {
   3.780137956282433*^9, 3.780137961592801*^9}, {3.780139155691502*^9, 
   3.780139193201344*^9}, {3.7801417565003757`*^9, 3.780141760225745*^9}, {
   3.7897367747804117`*^9, 3.789736802777577*^9}, {3.794325640747204*^9, 
   3.7943256418564043`*^9}, {3.795627955989758*^9, 3.795627959836187*^9}, {
   3.826011963311256*^9, 3.826011966630638*^9}, {3.886666253330543*^9, 
   3.886666270834502*^9}},ExpressionUUID->"26455924-c004-42a5-8989-\
964db297bb9e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nPDs", "=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"expectedPD", "[", "i", "]"}], "\[Equal]", "0"}], ",", "1", 
       ",", 
       RowBox[{"N", "[", 
        RowBox[{
         RowBox[{
         "PDs", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "/", 
         RowBox[{"expectedPD", "[", "i", "]"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "codondistributionsbylocation", "]"}]}], 
      "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7800529033817253`*^9, 3.780052934737433*^9}, {
   3.780052967153803*^9, 3.780052987250299*^9}, {3.780053059718371*^9, 
   3.780053067570135*^9}, {3.780053399412401*^9, 3.780053460596754*^9}, {
   3.780054288780549*^9, 3.780054295720603*^9}, {3.780137800987509*^9, 
   3.780137849800441*^9}, {3.780137968441242*^9, 3.7801379758010817`*^9}, {
   3.789736830295114*^9, 3.78973686487131*^9}, {3.789737057572402*^9, 
   3.789737058486931*^9}, {3.794325674977448*^9, 3.794325693307746*^9}, 
   3.826012321092264*^9, {3.826012415394393*^9, 3.826012417754319*^9}, 
   3.859558349069306*^9, {3.8866663511067867`*^9, 
   3.8866663593628807`*^9}},ExpressionUUID->"492f8e16-46d0-45d2-8824-\
c89f730253f8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"nonZeroCodonProbabilityRefsByAA", "=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"Position", "[", 
         RowBox[{"#", ",", 
          RowBox[{"x_", "/;", 
           RowBox[{"x", ">", "0"}]}]}], "]"}], "]"}], "&"}], ",", 
      RowBox[{"Transpose", "[", "aanumbertoexpectedcodonnumber", "]"}]}], 
     "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Get", " ", "a", " ", "list", " ", "of", " ", "references", " ", "to", " ",
     "positions", " ", "in", " ", "the", " ", "amino", " ", "acid", " ", 
    "list", " ", "for", " ", "which", " ", "there", " ", "are", " ", 
    "possible", " ", 
    RowBox[{"codons", ".", "  ", "Do"}], " ", "it", " ", "this", " ", "way", 
    " ", "rather", " ", "than", " ", "by", " ", "reverse", " ", 
    "substitution", " ", "to", " ", "take", " ", "into", " ", "account", " ", 
    "the", " ", "possibility", " ", "that", " ", "there", " ", "is", " ", "a",
     " ", "valid", " ", "codon", " ", "that", " ", "never", " ", "occurs", 
    " ", "and", " ", "hence", " ", "has", " ", "probability", " ", 
    RowBox[{"zero", "."}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.82609786186692*^9, 3.8260978764020643`*^9}, {
  3.826098250631534*^9, 3.8260983033965397`*^9}, {3.826098340269443*^9, 
  3.826098341045433*^9}},ExpressionUUID->"c7f20e85-5dc3-425e-8b11-\
8008c5b2d4b5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"conditionalCodonProbs", "=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"#", "\[Equal]", "0"}], ",", "1", ",", "#"}], "]"}], "&"}], 
      ",", 
      RowBox[{"Total", "[", 
       RowBox[{"Transpose", "[", "aanumbertoexpectedcodonnumber", "]"}], 
       "]"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Codon", " ", "probabilities", " ", "conditioned", " ", "upon", " ", 
     "amino", " ", "acid", " ", "use"}], ",", " ", 
    RowBox[{
     RowBox[{
     "for", " ", "use", " ", "in", " ", "Shannon", " ", "entropy", " ", 
      "calculation"}], ";", " ", 
     RowBox[{
     "if", " ", "the", " ", "probability", " ", "is", " ", "zero", " ", "it", 
      " ", 
      RowBox[{"doesn", "'"}], "t", " ", "matter", " ", "what", " ", 
      "probability", " ", "we", " ", "put", " ", "as", " ", "it", " ", "is", 
      " ", "never", " ", "used"}]}], ",", " ", 
    RowBox[{
    "but", " ", "we", " ", "have", " ", "the", " ", "amendment", " ", "of", 
     " ", "the", " ", "probability", " ", "to", " ", "1", " ", "to", " ", 
     "avoid", " ", 
     RowBox[{"0", "^", "0"}], " ", 
     RowBox[{"errors", ".", " ", "Such"}], " ", "entries", " ", "should", " ",
      "get", " ", "deleted", " ", 
     RowBox[{"below", "."}]}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.8261003799392033`*^9, 3.8261004974121513`*^9}, {
  3.8261005380062733`*^9, 3.826100592787072*^9}, {3.826101986139802*^9, 
  3.826101991419767*^9}},ExpressionUUID->"94e515bb-199e-4342-91bf-\
04e44742d2f8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"informativeNonZeroCodonProbabilityRefsByAA", "=", 
    RowBox[{"DeleteCases", "[", 
     RowBox[{"nonZeroCodonProbabilityRefsByAA", ",", 
      RowBox[{"x_", "/;", 
       RowBox[{
        RowBox[{"Length", "[", "x", "]"}], "\[LessEqual]", "1"}]}]}], "]"}]}],
    ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Only", " ", "amino", " ", "acids", " ", "that", " ", "are", " ", "coded",
      " ", "for", " ", "by", " ", "two", " ", "or", " ", "more", " ", 
     "codons", " ", "give", " ", "information"}], ",", " ", 
    RowBox[{"so", " ", 
     RowBox[{"don", "'"}], "t", " ", "use", " ", "the", " ", "rest", " ", 
     "at", " ", "all"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.826101851153421*^9, 
  3.826101918825943*^9}},ExpressionUUID->"f31a552b-30c9-4663-9630-\
855a2b6c10cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"informativeConditionalCodonProbsByAA", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"conditionalCodonProbs", "\[LeftDoubleBracket]", 
      RowBox[{
      "informativeNonZeroCodonProbabilityRefsByAA", "\[LeftDoubleBracket]", 
       "i", "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{
       "Length", "[", "informativeNonZeroCodonProbabilityRefsByAA", "]"}]}], 
      "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.826101277098473*^9, 3.826101349358591*^9}, {
  3.826101956323091*^9, 
  3.8261019742993317`*^9}},ExpressionUUID->"4fbf015c-ff53-4f19-ae2f-\
c286d4e93fc2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"combinedCountsByNonZeroCodonProbabilities", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"#", ",", 
          RowBox[{
          "informativeNonZeroCodonProbabilityRefsByAA", 
           "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{
          "Length", "[", "informativeNonZeroCodonProbabilityRefsByAA", 
           "]"}]}], "}"}]}], "]"}], "&"}], ",", 
     "codondistributionsbylocation", ",", 
     RowBox[{"{", "1", "}"}]}], "]"}]}], ";", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Partitions", " ", "codon", " ", "counts", " ", "for", " ", "each", " ", 
     "locus", " ", "by", " ", "amino", " ", "acid"}], ",", " ", 
    RowBox[{"for", " ", "the", " ", "informative", " ", "codons", " ", 
     RowBox[{"only", ".", "  ", "We"}], " ", "can", " ", "then", " ", "use", 
     " ", "this", " ", "in", " ", 
     RowBox[{"calculations", "."}]}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.8261017477252197`*^9, 3.826101771985383*^9}, {
   3.826102007964621*^9, 3.826102013636607*^9}, {3.82610204645354*^9, 
   3.826102103526539*^9}, 3.859558361739422*^9, 
   3.886667020854404*^9},ExpressionUUID->"585448da-6661-4810-9f4e-\
73d64bd474fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"multinomialCoefficientsByAA", "=", 
   RowBox[{"Apply", "[", 
    RowBox[{
    "Multinomial", ",", "combinedCountsByNonZeroCodonProbabilities", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Get", " ", "multinomial", " ", "coefficients", " ", "for", " ", 
    "calculation"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{
  3.886668528029883*^9},ExpressionUUID->"8a3f09cb-a6e4-4830-b397-\
1bfe88e3b989"],

Cell[BoxData[
 RowBox[{
  RowBox[{"logMultinomialCoefficientsByAA", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Log", ",", "multinomialCoefficientsByAA", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8261090254283524`*^9, 3.8261090335925093`*^9}, {
   3.8261091247771683`*^9, 3.8261091316029367`*^9}, 
   3.886668536765726*^9},ExpressionUUID->"9c439bce-70cf-4533-8e55-\
0680cea0771d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"logInformativeConditionalCodonProbsByAA", "=", 
   RowBox[{"Log", "[", "informativeConditionalCodonProbsByAA", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.826108991435173*^9, 
  3.82610900890375*^9}},ExpressionUUID->"3cdc9d8b-588e-4a95-8d51-\
1d1456a43ae1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"totalInformativeCodonsByAAbyLocus", "=", 
    RowBox[{"Total", "[", 
     RowBox[{"combinedCountsByNonZeroCodonProbabilities", ",", 
      RowBox[{"{", 
       RowBox[{"-", "1"}], "}"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Total", " ", "number", " ", "of", " ", "codons", " ", "coding", " ", 
     "for", " ", "each", " ", "informative", " ", "amino", " ", "acid", " ", 
     "at", " ", "each", " ", "locus"}], ",", " ", 
    RowBox[{
    "for", " ", "use", " ", "in", " ", "multinomial", " ", "calculation"}]}], 
   " ", "*)"}]}]], "Input",ExpressionUUID->"081cf032-1954-43b7-9820-\
d6f5bd118e6c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetSharedVariable", "[", "currentPos", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"currentPos", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", " ", 
     RowBox[{"Length", "@", "kernels"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "PrintTemporary", "[", 
   "\"\<Calculating Shannon information values. Current positions in \
calculation:\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{
   RowBox[{"PrintTemporary", "@", 
    RowBox[{"Dynamic", "[", "currentPos", "]"}]}], ";", " ", 
   RowBox[{"shannonInformationComponents", "=", 
    RowBox[{"ParallelTable", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"currentPos", "\[LeftDoubleBracket]", 
         RowBox[{"$KernelID", "/.", " ", "kernels"}], 
         "\[RightDoubleBracket]"}], "=", 
        RowBox[{"{", 
         RowBox[{"i", ",", "j"}], "}"}]}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"totalInformativeCodonsByAAbyLocus", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ">", "0"}], 
         ",", 
         RowBox[{"N", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"logMultinomialCoefficientsByAA", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}], "-", 
            RowBox[{"Total", "[", 
             RowBox[{
              RowBox[{
              "combinedCountsByNonZeroCodonProbabilities", 
               "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "*", 
              RowBox[{
              "logInformativeConditionalCodonProbsByAA", 
               "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}], 
             "]"}]}], ",", "200"}], "]"}], ",", "0"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "totalInformativeCodonsByAAbyLocus", "]"}]}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"Length", "[", 
         RowBox[{
         "totalInformativeCodonsByAAbyLocus", "\[LeftDoubleBracket]", "i", 
          "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Shannon", " ", "information", " ", "components", " ", "for", " ", "each",
      " ", "multinomial", " ", "calculations"}], " ", "*)"}]}]}]}], "Input",
 CellChangeTimes->{{3.826109661929944*^9, 3.826109687154008*^9}, {
   3.826109958450173*^9, 3.826109980280661*^9}, {3.8261299976889677`*^9, 
   3.826130015936466*^9}, 3.82613004881805*^9, {3.827856230844625*^9, 
   3.827856260540552*^9}, {3.8866686829906063`*^9, 3.886668696638736*^9}, {
   3.886668814735319*^9, 3.88666883486345*^9}, {3.886668870943808*^9, 
   3.886668922496455*^9}},ExpressionUUID->"9938ee8d-f7fe-4b2a-b7b6-\
9863fa3b9797"],

Cell[BoxData[
 RowBox[{
  RowBox[{"shannonInformation", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Total", ",", "shannonInformationComponents", ",", 
     RowBox[{"{", "1", "}"}]}], "]"}]}], ";", 
  RowBox[{"(*", " ", 
   RowBox[{"Shannon", " ", "information", " ", "per", " ", "locus"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.826110177005299*^9, 3.826110180421565*^9}, 
   3.826110235679089*^9, 3.8261104903652*^9, {3.826110525509679*^9, 
   3.826110543222507*^9}, 3.826110605152544*^9, {3.886668937231917*^9, 
   3.886668940543901*^9}},ExpressionUUID->"6c131f8b-eb88-4a28-819f-\
8f98550794e0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"shannonInformationUninformative", "[", "highgapproportion_", "]"}],
   ":=", 
  RowBox[{
   RowBox[{"shannonInformationUninformative", "[", "highgapproportion", "]"}],
    "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"SetSharedVariable", "[", "currentPos", "]"}], ";", 
     RowBox[{"currentPos", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{
        RowBox[{"{", "0", "}"}], ",", " ", 
        RowBox[{"Length", "@", "kernels"}]}], "]"}]}], ";", 
     RowBox[{"PrintTemporary", "[", 
      RowBox[{
      "\"\<Creating Shannon information array that only considers loci with \
gap proportion less than \>\"", "<>", 
       RowBox[{"ToString", "[", "highgapproportion", "]"}], "<>", 
       "\"\<. Current positions in calculation:\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", " ", 
     RowBox[{"PrintTemporary", "@", 
      RowBox[{"Dynamic", "[", "currentPos", "]"}]}], ";", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"currentPos", "\[LeftDoubleBracket]", 
          RowBox[{"$KernelID", "/.", " ", "kernels"}], 
          "\[RightDoubleBracket]"}], "=", 
         RowBox[{"{", "i", "}"}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"codondistributionsbylocation", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "65"}], "\[RightDoubleBracket]"}], "/", 
            "numSeqs"}], ">", "highgapproportion"}], ",", "\"\<Uninform\>\"", 
          ",", 
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{
            "shannonInformation", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], ",", "200"}], "]"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "codondistributionsbylocation", "]"}]}], 
        "}"}]}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.8263068178412333`*^9, 3.826306940186557*^9}, {
   3.8264502860709333`*^9, 3.826450360608883*^9}, {3.826451849842284*^9, 
   3.826451867106104*^9}, 3.826451897971362*^9, {3.826455653027213*^9, 
   3.8264556659788313`*^9}, {3.82785621707751*^9, 3.8278562180270987`*^9}, 
   3.8278562625003557`*^9, {3.8595583631649513`*^9, 3.85955836613204*^9}, {
   3.886669007280533*^9, 3.886669026224512*^9}, {3.886669072656864*^9, 
   3.886669157009432*^9}},ExpressionUUID->"4f35b023-dfab-4102-a90f-\
0cd2983f0822"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "shannonInformationGapsSuppressed", "[", "highgapproportion_", "]"}], ":=", 
  
  RowBox[{
   RowBox[{
   "shannonInformationGapsSuppressed", "[", "highgapproportion", "]"}], "=", 
   RowBox[{
    RowBox[{
    "shannonInformationUninformative", "[", "highgapproportion", "]"}], "/.", 
    
    RowBox[{"{", 
     RowBox[{"\"\<Uninform\>\"", "\[Rule]", "0"}], "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.82645574507609*^9, 3.826455768324923*^9}},
 CellLabel->
  "In[105]:=",ExpressionUUID->"e844c670-b9ba-4b67-92e0-ff472a87bb23"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"shannonInformationUninformative", "[", "0.1", "]"}], ";", 
  RowBox[{"shannonInformationGapsSuppressed", "[", "0.1", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "The", " ", "code", " ", "works", " ", "on", " ", "the", " ", "basis", 
     " ", "of", " ", "suppressing", " ", "loci", " ", "with"}], " ", ">", 
    RowBox[{"10", "%", " ", 
     RowBox[{"gaps", ".", "  ", "The"}], " ", "value", " ", "of", " ", "0.1", 
     " ", "in", " ", "the", " ", "code", " ", "can", " ", "be", " ", 
     "amended", " ", "to", " ", "change", " ", 
     RowBox[{"this", "."}]}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.8264498700371637`*^9, 3.826449878923265*^9}, {
  3.826455774061194*^9, 3.826455780524482*^9}, {3.886671954479607*^9, 
  3.886671999182652*^9}},ExpressionUUID->"6e51c628-aa40-453d-aabd-\
34bd1d68536f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nPDsGapsSuppressed", "[", "highgapproportion_", "]"}], ":=", 
  RowBox[{
   RowBox[{"nPDsGapsSuppressed", "[", "highgapproportion", "]"}], "=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"N", "[", 
         RowBox[{
          RowBox[{
          "shannonInformationGapsSuppressed", "[", "highgapproportion", "]"}],
           "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "]"}], 
        "\[Equal]", "0."}], ",", "\"\<Uninform\>\"", ",", 
       RowBox[{"N", "[", 
        RowBox[{
        "nPDs", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
        "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "nPDs", "]"}]}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.842682651989493*^9, 3.8426826677737427`*^9}, {
  3.8426854712248363`*^9, 3.8426854728485107`*^9}, {3.886672097950993*^9, 
  3.8866721051029863`*^9}},ExpressionUUID->"16b74c77-dce0-4514-a8f1-\
d574b0ed3722"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Second section: perform the calculations to determine where significantly \
conserved regions may be found.  Report Z scores and bootstrap \
\[OpenCurlyDoubleQuote]p-values\[CloseCurlyDoubleQuote] for each calculation.\
\
\>", "Subsection",
 CellChangeTimes->{{3.886672625795269*^9, 
  3.886672704497851*^9}},ExpressionUUID->"7fb67a0d-fcaf-47aa-a9c7-\
66e44ead9f87"],

Cell[CellGroupData[{

Cell["\<\
Modified version of maxdrop algorithm from 2018 PLoS ONE paper \
(Gog/Lever/Skittrall).  This version of the algorithm can use weightings.\
\>", "Subsubsection",
 CellChangeTimes->{{3.8866727321157093`*^9, 
  3.886672803058385*^9}},ExpressionUUID->"15ce62a9-ebbd-402e-81e4-\
f798f4c9577a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "These", " ", "functions", " ", "normalise", " ", "and", " ", 
     "cumulative", " ", "sum", " ", "the", " ", "raw", " ", "data"}], ",", 
    " ", 
    RowBox[{"using", " ", "a", " ", "weighting", " ", "function"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"wnorm", "[", 
      RowBox[{"p_", ",", "w_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"temp", ",", "temp2", ",", "temp3", ",", "temp4", ",", 
         RowBox[{"n", "=", 
          RowBox[{"Length", "[", "p", "]"}]}], ",", "res"}], "}"}], ",", 
       RowBox[{
        RowBox[{"temp", "=", 
         RowBox[{"Total", "[", "w", "]"}]}], ";", 
        RowBox[{"temp2", "=", 
         RowBox[{"Total", "[", 
          RowBox[{"w", "*", "w"}], "]"}]}], ";", 
        RowBox[{"temp3", "=", 
         RowBox[{"Total", "[", "p", "]"}]}], ";", 
        RowBox[{"temp4", "=", 
         RowBox[{"Total", "[", 
          RowBox[{"w", "*", "p"}], "]"}]}], ";", 
        RowBox[{"res", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"w", "*", "p"}], "-", 
            RowBox[{"w", "*", 
             RowBox[{"(", 
              RowBox[{"temp4", "/", "temp"}], ")"}]}]}], ")"}], "/", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"temp", "/", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["temp", "2"], "-", "temp2"}], ")"}]}], ")"}], 
            "*", 
            RowBox[{"Total", "[", 
             RowBox[{"w", "*", 
              RowBox[{"(", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"p", "-", 
                  RowBox[{"(", 
                   RowBox[{"temp", "/", "n"}], ")"}]}], ")"}], "2"], ")"}]}], 
             "]"}]}], "]"}]}]}], ";", 
        RowBox[{"ClearAll", "[", 
         RowBox[{"temp", ",", "temp2", ",", "temp3", ",", "temp4", ",", "n"}],
          "]"}], ";", "res"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Weighted", " ", "normalisation", " ", "function"}], ";", " ", 
     RowBox[{"see", " ", "manuscript", " ", "for", " ", "more", " ", 
      RowBox[{"details", ".", "  ", "p"}], " ", "is", " ", "a", " ", 
      "distance", " ", "measure", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"e", ".", "g", ".", " ", "nPD"}], ",", " ", 
        RowBox[{"weighted", " ", "rank"}]}], ")"}]}], ";", " ", 
     RowBox[{
     "w", " ", "is", " ", "a", " ", "corresponding", " ", "vector", " ", "of",
       " ", 
      RowBox[{"weightings", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"wcumu", "[", 
      RowBox[{"p_", ",", "w_"}], "]"}], ":=", 
     RowBox[{"Prepend", "[", 
      RowBox[{
       RowBox[{"Accumulate", "[", 
        RowBox[{"wnorm", "[", 
         RowBox[{"p", ",", "w"}], "]"}], "]"}], ",", "0"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"key", " ", "idea", " ", "for", " ", "speed", " ", 
      RowBox[{"up", ":", " ", 
       RowBox[{
       "a", " ", "run", " ", "must", " ", "start", " ", "with", " ", "its", 
        " ", "max", " ", "value", " ", "and", " ", "end", " ", "with", " ", 
        "its", " ", "min"}]}]}], ",", " ", 
     RowBox[{
     "otherwise", " ", "it", " ", "is", " ", "not", " ", "the", " ", "best", 
      " ", "Z"}]}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"maxdrop", "[", 
     RowBox[{"raw_", ",", "rawseps_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"sampletest", "=", 
       RowBox[{"wcumu", "[", 
        RowBox[{"raw", ",", "rawseps"}], "]"}]}], ";", 
      RowBox[{"sampleseps", "=", 
       RowBox[{"Prepend", "[", 
        RowBox[{
         RowBox[{"Accumulate", "[", "rawseps", "]"}], ",", "0"}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "potential", " ", "end", " ", "points", " ", "must", " ", "start", 
         " ", "and", " ", "end", " ", "with", " ", "a", " ", "downwards", " ",
          "step"}], ",", " ", 
        RowBox[{
        "so", " ", "restrict", " ", "to", " ", "these", " ", "candidate", " ",
          "best", " ", "start", " ", "points", " ", 
         RowBox[{"(", "iset", ")"}], " ", "and", " ", "end", " ", "points", 
         RowBox[{"(", "jset", ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"negs", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{"wnorm", "[", 
            RowBox[{"raw", ",", "rawseps"}], "]"}], "]"}], ",", 
          RowBox[{"x_", "/;", 
           RowBox[{"x", "<", "0"}]}]}], "]"}], "]"}]}], ";", " ", 
      RowBox[{"Nj", "=", 
       RowBox[{"Length", "[", "negs", "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "need", " ", "to", " ", "take", " ", "numerical", " ", "value", " ", 
        "to", " ", "avoid", " ", "strange", " ", "behaviour", " ", "by", " ", 
        "Position", " ", "when", " ", "expressions", " ", "used"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"jset", "=", 
       RowBox[{"negs", "+", "1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"iset", "=", "negs"}], ";", "\[IndentingNewLine]", 
      RowBox[{"jsample", "=", 
       RowBox[{
       "sampletest", "\[LeftDoubleBracket]", "jset", 
        "\[RightDoubleBracket]"}]}], ";", 
      RowBox[{"jseps", "=", 
       RowBox[{
       "sampleseps", "\[LeftDoubleBracket]", "jset", 
        "\[RightDoubleBracket]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"evaluate", " ", "at", " ", "potential", " ", "ends"}], " ", 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"idea", ",", " ", 
        RowBox[{"take", " ", "endpoints", " ", 
         RowBox[{"(", "jset", ")"}], " ", "and", " ", "see", " ", "which", 
         " ", "startpoints", " ", 
         RowBox[{"(", "iset", ")"}], " ", "could", " ", "go", " ", "with", 
         " ", 
         RowBox[{"it", ".", " ", "Working"}], " ", "left", " ", "from", " ", 
         "the", " ", "endpoint"}], ",", " ", 
        RowBox[{
        "if", " ", "we", " ", "pass", " ", "a", " ", "lower", " ", "point", 
         " ", "then", " ", "no", " ", "point", " ", "trying", " ", "any", " ",
          "further", " ", "back", " ", "startpoints"}], ",", " ", 
        RowBox[{
        "fits", " ", "location", " ", "nearest", " ", "earlier", " ", "lower",
          " ", "point"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "\"\<fits and gits\>\"", " ", "is", " ", "an", " ", "iterative", " ", 
        RowBox[{"approach", ".", " ", "\[IndentingNewLine]", 
         RowBox[{"fits", "[", "n", "]"}]}], " ", "is", " ", "the", " ", 
        "closest", " ", "position", " ", "to", " ", "the", " ", "left", " ", 
        "that", " ", "has", " ", "lower", " ", "value", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"or", " ", "0", " ", "if", " ", "none"}], ")"}], ".", " ", 
         "\[IndentingNewLine]", "It"}], " ", "can", " ", "then", " ", "be", 
        " ", "computed", " ", "iteratively", " ", "using", " ", "gits", " ", 
        "which", " ", "then", " ", "runs", " ", "through", " ", "checking", 
        " ", "only", " ", "previous", " ", "mins"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Clear", "[", 
       RowBox[{"fits", ",", "gits"}], "]"}], ";", " ", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"fits", "[", "n_", "]"}], ":=", 
       RowBox[{
        RowBox[{"fits", "[", "n", "]"}], "=", 
        RowBox[{"gits", "[", 
         RowBox[{
          RowBox[{
          "jsample", "\[LeftDoubleBracket]", "n", "\[RightDoubleBracket]"}], 
          ",", 
          RowBox[{"n", "-", "1"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fits", "[", "1", "]"}], "=", "0"}], ";", 
      RowBox[{
       RowBox[{"gits", "[", 
        RowBox[{"x_", ",", "0"}], "]"}], ":=", "0"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"gits", "[", 
        RowBox[{"val_", ",", "m_"}], "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
          "jsample", "\[LeftDoubleBracket]", "m", "\[RightDoubleBracket]"}], 
          ">", "val"}], ",", 
         RowBox[{"gits", "[", 
          RowBox[{"val", ",", 
           RowBox[{"fits", "[", "m", "]"}]}], "]"}], ",", "m"}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "now", " ", "use", " ", "fits", " ", "function", " ", "to", " ", 
         "create", " ", "candidate", " ", "list", " ", "of", " ", "start"}], 
        "-", 
        RowBox[{"end", " ", "pairs"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"pairs", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "iset", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
             ",", 
             RowBox[{
             "jset", "\[LeftDoubleBracket]", "jj", 
              "\[RightDoubleBracket]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"jj", ",", "Nj"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", 
             RowBox[{
              RowBox[{"fits", "[", "jj", "]"}], "+", "1"}], ",", "jj"}], 
            "}"}]}], "]"}], ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "compute", " ", "Z", " ", "for", " ", "those", " ", "and", " ", "take",
         " ", "the", " ", "best"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Zpairs", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"N", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"sampleseps", "\[LeftDoubleBracket]", 
                RowBox[{
                "xx", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                "\[RightDoubleBracket]"}], "-", 
               RowBox[{"sampleseps", "\[LeftDoubleBracket]", 
                RowBox[{
                "xx", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                "\[RightDoubleBracket]"}]}], ",", "200"}], "]"}], "\[Equal]", 
            "0."}], ",", "0", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"sampletest", "\[LeftDoubleBracket]", 
               RowBox[{
               "xx", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "\[RightDoubleBracket]"}], "-", 
              RowBox[{"sampletest", "\[LeftDoubleBracket]", 
               RowBox[{
               "xx", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               "\[RightDoubleBracket]"}]}], ")"}], "/", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"N", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"sampleseps", "\[LeftDoubleBracket]", 
                 RowBox[{
                 "xx", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                  "\[RightDoubleBracket]"}], "-", 
                RowBox[{"sampleseps", "\[LeftDoubleBracket]", 
                 RowBox[{
                 "xx", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                  "\[RightDoubleBracket]"}]}], ",", "200"}], "]"}], "]"}]}]}],
           "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"xx", ",", "pairs"}], "}"}]}], "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "\"\<If\>\"", " ", "here", " ", "as", " ", "a", " ", "final", " ", 
        "way", " ", "to", " ", "catch", " ", "floating", " ", "point", " ", 
        "errors", " ", "when", " ", "weightings", " ", "have", " ", "vastly", 
        " ", "different", " ", "magnitudes"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"toppos", "=", 
       RowBox[{
        RowBox[{"Ordering", "[", 
         RowBox[{"Zpairs", ",", 
          RowBox[{"-", "1"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"top", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "pairs", "\[LeftDoubleBracket]", "toppos", 
           "\[RightDoubleBracket]"}], ",", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", "xx", "}"}], ",", 
            RowBox[{
             RowBox[{"xx", "=", 
              RowBox[{
              "pairs", "\[LeftDoubleBracket]", "toppos", 
               "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{
               "not", " ", "sure", " ", "last", " ", "step", " ", "is", " ", 
                "necessary"}], ",", " ", 
               RowBox[{
               "but", " ", "a", " ", "final", " ", "calculate", " ", "for", 
                " ", 
                RowBox[{"luck", "!!"}]}]}], " ", "*)"}], 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sampletest", "\[LeftDoubleBracket]", 
                 RowBox[{
                 "xx", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                  "\[RightDoubleBracket]"}], "-", 
                RowBox[{"sampletest", "\[LeftDoubleBracket]", 
                 RowBox[{
                 "xx", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                  "\[RightDoubleBracket]"}]}], ")"}], "/", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sampleseps", "\[LeftDoubleBracket]", 
                  RowBox[{
                  "xx", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], "-", 
                 
                 RowBox[{"sampleseps", "\[LeftDoubleBracket]", 
                  RowBox[{
                  "xx", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}], 
                ")"}], "]"}]}]}]}], "]"}]}], "}"}], "]"}]}]}], 
     "\[IndentingNewLine]", ")"}]}], "\n"}]}]], "Input",
 CellChangeTimes->{{3.6546167129709806`*^9, 3.65461679132968*^9}, {
   3.654616823713365*^9, 3.6546168531215067`*^9}, {3.6546169295140944`*^9, 
   3.654616960257152*^9}, {3.654617101977818*^9, 3.6546171536727457`*^9}, {
   3.65461726686908*^9, 3.654617272370202*^9}, {3.6546173165394373`*^9, 
   3.6546173184829493`*^9}, {3.6546173638496037`*^9, 3.654617392242181*^9}, {
   3.654617446148574*^9, 3.65461747105748*^9}, {3.655561008676116*^9, 
   3.655561028752586*^9}, {3.6555614955674877`*^9, 3.655561516126834*^9}, {
   3.655561568191433*^9, 3.655561660158288*^9}, {3.655561708804995*^9, 
   3.6555617117257967`*^9}, {3.655561757705724*^9, 3.655562040628956*^9}, {
   3.6555620896216183`*^9, 3.6555623189169407`*^9}, {3.655562352196947*^9, 
   3.655562352483179*^9}, {3.6555624667335453`*^9, 3.655562474932386*^9}, {
   3.658269144989142*^9, 3.6582691453972816`*^9}, {3.670653098409316*^9, 
   3.670653108270172*^9}, {3.671868292980088*^9, 3.6718683225863523`*^9}, {
   3.747307429064823*^9, 3.747307445297757*^9}, {3.7945659613415003`*^9, 
   3.7945660030291224`*^9}, {3.82611170851159*^9, 3.826111747253891*^9}, {
   3.826111813858863*^9, 3.826111821089925*^9}, {3.82611185171436*^9, 
   3.8261119212121553`*^9}, 3.8261119841509047`*^9, {3.826112263276351*^9, 
   3.8261122987895527`*^9}, {3.826112370975398*^9, 3.826112403008437*^9}, {
   3.826112445913107*^9, 3.826112463953176*^9}, {3.826171475684041*^9, 
   3.826171519386283*^9}, {3.8261715501972313`*^9, 3.8261715558811417`*^9}, 
   3.826175304048566*^9, {3.8261753402766447`*^9, 3.826175353480959*^9}, {
   3.826175537949232*^9, 3.8261755426611767`*^9}, {3.8261756723003683`*^9, 
   3.8261757213355017`*^9}, {3.826175753512147*^9, 3.82617575382415*^9}, {
   3.8261758137711287`*^9, 3.826175852042398*^9}, {3.8261760711586237`*^9, 
   3.826176103647665*^9}, {3.8261761393617077`*^9, 3.826176159032485*^9}, {
   3.826176267852708*^9, 3.8261762889885607`*^9}, {3.826176370999074*^9, 
   3.826176391310384*^9}, 3.826176514386903*^9, {3.8264464515628033`*^9, 
   3.8264464530338497`*^9}, {3.8264465316573277`*^9, 3.82644664762894*^9}, {
   3.826447117413047*^9, 3.826447253162668*^9}, {3.826447292835968*^9, 
   3.8264472939446793`*^9}, {3.8264473629476843`*^9, 3.826447383836404*^9}, {
   3.826447466159094*^9, 3.826447466359429*^9}, {3.826448064944826*^9, 
   3.8264480820688334`*^9}, {3.826466306993286*^9, 3.826466356016264*^9}, {
   3.8264664667388277`*^9, 3.82646649466009*^9}, {3.827085693438216*^9, 
   3.8270857126828623`*^9}, {3.827086285031116*^9, 3.827086309343281*^9}, {
   3.827644593676918*^9, 3.8276446330291243`*^9}, {3.827644679283004*^9, 
   3.827644683734571*^9}, {3.827644845142672*^9, 3.827644851135845*^9}, {
   3.8276449925251217`*^9, 3.827645021224338*^9}, {3.827645085163377*^9, 
   3.827645110393518*^9}, {3.827647754305902*^9, 3.827647759410532*^9}, {
   3.827803685193012*^9, 3.8278036961773148`*^9}, {3.827851150326153*^9, 
   3.8278511538686857`*^9}, {3.827858617861208*^9, 3.827858697702581*^9}, {
   3.827888290634345*^9, 3.8278882926069517`*^9}, {3.827888412995763*^9, 
   3.8278884652502947`*^9}, {3.8432801842916813`*^9, 3.843280254135551*^9}, {
   3.843314272872197*^9, 3.843314293655362*^9}, {3.886672824803053*^9, 
   3.8866728611228943`*^9}, {3.8866729596513166`*^9, 3.886673015733642*^9}, 
   3.8866749291985273`*^9},ExpressionUUID->"47c66ac8-445e-4e37-9d0a-\
88f796c20b05"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Algorithm to shuffle the nMPD list to work out a bootstrap \
\[OpenCurlyDoubleQuote]p-value\[CloseCurlyDoubleQuote] for a particular \
descent\
\>", "Subsubsection",
 CellChangeTimes->{{3.886673136133922*^9, 
  3.886673155299971*^9}},ExpressionUUID->"a9748c5f-5c85-405c-8f7b-\
25726c6e6253"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Parallelised", " ", "version"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"PValueCalc", "[", 
     RowBox[{
     "list_", ",", "shannonlist_", ",", "pvalue_", ",", "maxtrials_"}], "]"}],
     ":=", 
    RowBox[{"(", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "list", "]"}], "\[LessEqual]", "1"}], "||", 
        RowBox[{
         RowBox[{"N", "[", 
          RowBox[{"list", "-", 
           RowBox[{"Mean", "[", "list", "]"}]}], "]"}], "\[Equal]", 
         RowBox[{"Table", "[", 
          RowBox[{"0.", ",", 
           RowBox[{"Length", "[", "list", "]"}]}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "If", " ", "the", " ", "list", " ", "has", " ", "length", " ", "1"}],
          ",", " ", 
         RowBox[{
          RowBox[{"it", "'"}], "s", " ", "not", " ", "possible", " ", "to", 
          " ", "rearrange", " ", "to", " ", "get", " ", "a", " ", "more", " ",
           "extreme", " ", "list", " ", "and", " ", "some", " ", "of", " ", 
          "the", " ", "later", " ", "code", " ", "will", " ", "fall", " ", 
          RowBox[{"over", "!"}], " ", "If", " ", "the", " ", "list", " ", 
          "is", " ", "constant"}], ",", " ", 
         RowBox[{
         "then", " ", "the", " ", "standard", " ", "deviation", " ", 
          "calculation", " ", "will", " ", "yield", " ", 
          RowBox[{"a", " ", "/", "0"}], " ", "error"}], ",", " ", 
         RowBox[{
         "but", " ", "again", " ", "the", " ", "list", " ", "will", " ", "be",
           " ", "unchangeable", " ", "when", " ", 
          RowBox[{"rearranged", ".", " ", "Many"}], " ", "ways", " ", "of", 
          " ", "checking", " ", "whether", " ", "there", " ", "is", " ", "a", 
          " ", "constant", " ", "list", " ", "but", " ", "this", " ", "step", 
          " ", 
          RowBox[{"doesn", "'"}], "t", " ", "require", " ", "heavy", " ", 
          RowBox[{"optimisation", "."}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"realdrop", "=", 
            RowBox[{"maxdrop", "[", 
             RowBox[{"list", ",", "shannonlist"}], "]"}]}], ",", "currdrop", 
           ",", "numfails", ",", "seed"}], "}"}], ",", "\[IndentingNewLine]", 
         
         RowBox[{
          RowBox[{"SetSharedVariable", "[", "currentNumber", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"currentNumber", "=", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", " ", 
             RowBox[{"Length", "@", "kernels"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
          "PrintTemporary", "[", "\"\<Current p value trials being run:\>\"", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"PrintTemporary", "@", 
           RowBox[{"Dynamic", "[", "currentNumber", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"SetSharedVariable", "[", "numfails", "]"}], ";", " ", 
          RowBox[{"numfails", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"DistributeDefinitions", "[", "currdrop", "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
           "doFullRuns", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ParallelDo", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"currentNumber", "\[LeftDoubleBracket]", 
                  RowBox[{"$KernelID", "/.", " ", "kernels"}], 
                  "\[RightDoubleBracket]"}], "=", "i"}], ";", 
                RowBox[{"seed", "=", 
                 RowBox[{
                  RowBox[{"UnixTime", "[", "]"}], "*", 
                  RowBox[{"RandomInteger", "[", "100000000000", "]"}]}]}], 
                ";", 
                RowBox[{"currdrop", "=", 
                 RowBox[{"maxdrop", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"SeedRandom", "[", "seed", "]"}], ";", 
                    RowBox[{"RandomSample", "[", "list", "]"}]}], ")"}], ",", 
                   
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"SeedRandom", "[", "seed", "]"}], ";", 
                    RowBox[{"RandomSample", "[", "shannonlist", "]"}]}], 
                    ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                   "currdrop", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], "\[GreaterEqual]", 
                   RowBox[{
                   "realdrop", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], ",", 
                  RowBox[{"numfails", "++"}]}], "]"}], ";"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "maxtrials"}], "}"}]}], "]"}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"Remove", "[", "currdrop", "]"}], ";"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{"realdrop", ",", 
                RowBox[{"numfails", "/", "maxtrials"}]}], "}"}], "]"}]}], ",",
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ParallelDo", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"currentNumber", "\[LeftDoubleBracket]", 
                  RowBox[{"$KernelID", "/.", " ", "kernels"}], 
                  "\[RightDoubleBracket]"}], "=", "i"}], ";", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"numfails", "/", "maxtrials"}], "\[GreaterEqual]", 
                   "pvalue"}], ",", 
                  RowBox[{"Break", "[", "]"}]}], "]"}], ";", 
                RowBox[{"seed", "=", 
                 RowBox[{
                  RowBox[{"UnixTime", "[", "]"}], "*", 
                  RowBox[{"RandomInteger", "[", "100000000000", "]"}]}]}], 
                ";", 
                RowBox[{"currdrop", "=", 
                 RowBox[{"maxdrop", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"SeedRandom", "[", "seed", "]"}], ";", 
                    RowBox[{"RandomSample", "[", "list", "]"}]}], ")"}], ",", 
                   
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"SeedRandom", "[", "seed", "]"}], ";", 
                    RowBox[{"RandomSample", "[", "shannonlist", "]"}]}], 
                    ")"}]}], "]"}]}], ";", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                   "currdrop", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], "\[GreaterEqual]", 
                   RowBox[{
                   "realdrop", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], ",", 
                  RowBox[{"numfails", "++"}]}], "]"}], ";"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "maxtrials"}], "}"}], ",", " ", 
               RowBox[{"Method", " ", "\[Rule]", " ", 
                RowBox[{
                "\"\<EvaluationsPerKernel\>\"", " ", "\[Rule]", " ", 
                 "1"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{"realdrop", ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"numfails", "/", "maxtrials"}], "\[GreaterEqual]", 
                   "pvalue"}], ",", "1", ",", 
                  RowBox[{"numfails", "/", "maxtrials"}]}], "]"}]}], "}"}], 
              "]"}]}]}], "]"}]}]}], "]"}]}], "]"}], ")"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "Modified", " ", "version", " ", "to", " ", "allow", " ", "doing", " ", 
       "a", " ", "full", " ", "run", " ", "of", " ", "non"}], "-", 
      RowBox[{"significant", " ", "values"}]}], ",", " ", 
     RowBox[{
     "by", " ", "setting", " ", "the", " ", "last", " ", "value", " ", "to", 
      " ", "True"}]}], " ", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.777027267056855*^9, 3.777027271139472*^9}, {
   3.777027318487589*^9, 3.777027369106653*^9}, {3.777027448709268*^9, 
   3.7770275885478*^9}, {3.77702761862785*^9, 3.777027678996224*^9}, {
   3.77702771008409*^9, 3.777027721688528*^9}, {3.777027759367846*^9, 
   3.777027760420498*^9}, {3.77702779119202*^9, 3.7770278167410173`*^9}, {
   3.77702787741369*^9, 3.777027987095728*^9}, {3.77702802176612*^9, 
   3.7770280352699747`*^9}, {3.777028553467609*^9, 3.7770285593061934`*^9}, {
   3.7770288144621267`*^9, 3.777028831404269*^9}, 3.777029070943969*^9, {
   3.789210647736712*^9, 3.78921065226259*^9}, {3.789210730776105*^9, 
   3.7892107571767178`*^9}, {3.789210832873344*^9, 3.7892108348397093`*^9}, {
   3.78921132829941*^9, 3.789211347097969*^9}, {3.7892117195017853`*^9, 
   3.789211744540537*^9}, {3.789212140380398*^9, 3.7892121457406063`*^9}, {
   3.7892127364201593`*^9, 3.789212748835105*^9}, {3.7892129226616507`*^9, 
   3.789212950985424*^9}, {3.794556317561042*^9, 3.7945563327902393`*^9}, {
   3.7945563901214*^9, 3.794556424312606*^9}, {3.794557508756155*^9, 
   3.794557574795216*^9}, {3.7945576352157173`*^9, 3.794557635604644*^9}, {
   3.794566491355727*^9, 3.794566495858609*^9}, {3.794572944824622*^9, 
   3.7945730077372093`*^9}, {3.794573040195856*^9, 3.794573119098879*^9}, {
   3.794590473436944*^9, 3.794590698158342*^9}, {3.794590809347859*^9, 
   3.794590833562242*^9}, {3.795798682071821*^9, 3.795798682716248*^9}, {
   3.826112668390991*^9, 3.8261126779737186`*^9}, {3.82611300006081*^9, 
   3.8261130148131332`*^9}, {3.82611308531208*^9, 3.826113110381254*^9}, {
   3.826113160233473*^9, 3.826113167817301*^9}, 3.826113213713776*^9, {
   3.826131766524699*^9, 3.826131792213241*^9}, {3.8264665773341293`*^9, 
   3.826466622165872*^9}, {3.827048451652956*^9, 3.8270484572657223`*^9}, {
   3.827646540010973*^9, 3.8276465723290052`*^9}, {3.8430402171206493`*^9, 
   3.84304022079813*^9}, {3.843040263581526*^9, 3.843040276571913*^9}, {
   3.886673216709311*^9, 3.886673223413464*^9}, {3.886673293573842*^9, 
   3.8866733230457497`*^9}, {3.8866749530700493`*^9, 
   3.886674962398127*^9}},ExpressionUUID->"7bec1c3a-9393-4bda-a721-\
da2b3096d7e7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Algorithms to run the above algorithms iteratively until significant descents \
are no longer found, and then gather together the output\
\>", "Subsubsection",
 CellChangeTimes->{{3.886682410785429*^9, 
  3.886682442192545*^9}},ExpressionUUID->"386c519e-4d71-45fe-afab-\
d755389502ec"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
     "unmaskedSignificantRegionsOrExtraCalcs", "\[Equal]", 
      "\"\<extracalcs\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"UninformListExtremalDescents", "[", 
        RowBox[{
        "list_", ",", "shannonlist_", ",", "sigthreshold_", ",", 
         "maxrandomlists_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"currlist", "=", 
            RowBox[{"N", "[", "list", "]"}]}], ",", 
           RowBox[{"currshannonlist", "=", "shannonlist"}], ",", 
           "duffcurrlist", ",", "duffcurrshannonlist", ",", 
           RowBox[{"uninformlist", "=", 
            RowBox[{"Position", "[", 
             RowBox[{"list", ",", "\"\<Uninform\>\""}], "]"}]}], ",", 
           RowBox[{"lookuplist", "=", 
            RowBox[{"Table", "[", 
             RowBox[{"i", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}], ",",
            "dufflookuplist", ",", "currdescent", ",", 
           RowBox[{"extdescents", "=", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"calccurrentpvalue", "=", "1"}], ",", "currpcalc", ",", 
           "duffpcalc", ",", "duffOffset", ",", "duffDrop", ",", 
           RowBox[{"duffPsAllowed", "=", "numberExtraMaxdropCalcs"}], ",", 
           RowBox[{"firstDuffP", "=", "True"}], ",", 
           RowBox[{"afterFirstDuffP", "=", "False"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", "\[IndentingNewLine]", 
          RowBox[{
          "Remove", " ", "uninformative", " ", "cases", " ", "from", " ", 
           "consideration"}], "\[IndentingNewLine]", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"currlist", "=", 
           RowBox[{"Delete", "[", 
            RowBox[{"currlist", ",", "uninformlist"}], "]"}]}], ";", 
          RowBox[{"currshannonlist", "=", 
           RowBox[{"Delete", "[", 
            RowBox[{"currshannonlist", ",", "uninformlist"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"duffcurrlist", "=", "currlist"}], ";", 
          RowBox[{"duffcurrshannonlist", "=", "currshannonlist"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"lookuplist", "=", 
           RowBox[{"Delete", "[", 
            RowBox[{"lookuplist", ",", "uninformlist"}], "]"}]}], ";", 
          RowBox[{"dufflookuplist", "=", "lookuplist"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", "\[IndentingNewLine]", 
           RowBox[{
           "Run", " ", "PValueCalc", " ", "until", " ", "the", " ", 
            "significance", " ", "threshold", " ", "is", " ", "exceeded", " ",
             "or", " ", "there", " ", "is", " ", "no", " ", "list", " ", 
            "left"}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "currlist", "]"}], ">", "0"}], "&&", 
             RowBox[{"calccurrentpvalue", "\[Equal]", "1"}]}], ",", 
            RowBox[{
             RowBox[{"currpcalc", "=", 
              RowBox[{"PValueCalc", "[", 
               RowBox[{
               "currlist", ",", "currshannonlist", ",", "sigthreshold", ",", 
                "maxrandomlists"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"extdescents", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"extdescents", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lookuplist", "\[LeftDoubleBracket]", 
                   RowBox[{
                    RowBox[{
                    "currpcalc", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ";;", 
                    RowBox[{
                    RowBox[{
                    "currpcalc", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "-", "1"}]}], 
                   "\[RightDoubleBracket]"}], ",", 
                  RowBox[{
                  "currpcalc", "\[LeftDoubleBracket]", "3", 
                   "\[RightDoubleBracket]"}], ",", ",", 
                  RowBox[{
                  "currpcalc", "\[LeftDoubleBracket]", "4", 
                   "\[RightDoubleBracket]"}]}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"afterFirstDuffP", ",", 
               RowBox[{
                RowBox[{"duffDrop", "=", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "currpcalc", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "<", 
                    RowBox[{
                    "duffpcalc", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{
                    "currpcalc", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    RowBox[{
                    "currpcalc", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "+", "duffOffset"}]}], "]"}], 
                   ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "currpcalc", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "-", "1"}], "<", 
                    RowBox[{
                    "duffpcalc", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    "currpcalc", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "-", "1"}], ",", 
                    RowBox[{
                    RowBox[{
                    "currpcalc", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "+", "duffOffset", "-", 
                    "1"}]}], "]"}]}], "}"}]}], ";", 
                RowBox[{"afterFirstDuffP", "=", "False"}], ";", 
                RowBox[{"dufflookuplist", "=", 
                 RowBox[{"Drop", "[", 
                  RowBox[{"dufflookuplist", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "duffDrop", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "duffDrop", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "}"}]}], "]"}]}], ";", 
                RowBox[{"duffcurrlist", "=", 
                 RowBox[{"Drop", "[", 
                  RowBox[{"duffcurrlist", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "duffDrop", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "duffDrop", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "}"}]}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"duffcurrshannonlist", "=", 
                 RowBox[{"Drop", "[", 
                  RowBox[{"duffcurrshannonlist", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "duffDrop", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "duffDrop", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "}"}]}], "]"}]}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                "currpcalc", "\[LeftDoubleBracket]", "4", 
                 "\[RightDoubleBracket]"}], ">", "sigthreshold"}], ",", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"duffPsAllowed", "<", "1"}], ",", 
                  RowBox[{"calccurrentpvalue", "=", "0"}], ",", 
                  RowBox[{"duffPsAllowed", "--"}]}], "]"}], ";", 
                RowBox[{"If", "[", 
                 RowBox[{"firstDuffP", ",", 
                  RowBox[{
                   RowBox[{"firstDuffP", "=", "False"}], ";", 
                   RowBox[{"afterFirstDuffP", "=", "True"}], ";", 
                   RowBox[{"duffpcalc", "=", "currpcalc"}], ";", 
                   RowBox[{"duffOffset", "=", 
                    RowBox[{
                    RowBox[{
                    "currpcalc", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "currpcalc", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}]}], ";", 
                   RowBox[{"dufflookuplist", "=", "lookuplist"}], ";", 
                   RowBox[{"duffcurrlist", "=", "currlist"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"duffcurrshannonlist", "=", "currshannonlist"}], 
                   ";"}]}], "\[IndentingNewLine]", "]"}]}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
              "Book", " ", "keeping", " ", "is", " ", "to", " ", "make", " ", 
               "a", " ", "record", " ", "so", " ", "that", " ", "at", " ", 
               "the", " ", "end", " ", "we", " ", "can", " ", "run", " ", "a",
                " ", "MaxDrop", " ", "on", " ", "the", " ", "sequence", " ", 
               "with", " ", "the", " ", "next", " ", "value", " ", "excised", 
               " ", "to", " ", "see", " ", "whether", " ", "the", " ", 
               "first", " ", "then", " ", "becomes", " ", "significant"}], 
              " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"lookuplist", "=", 
              RowBox[{"Drop", "[", 
               RowBox[{"lookuplist", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                  "currpcalc", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], ",", 
                  RowBox[{
                   RowBox[{
                   "currpcalc", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "-", "1"}]}], "}"}]}], "]"}]}],
              ";", 
             RowBox[{"currlist", "=", 
              RowBox[{"Drop", "[", 
               RowBox[{"currlist", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                  "currpcalc", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], ",", 
                  RowBox[{
                   RowBox[{
                   "currpcalc", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "-", "1"}]}], "}"}]}], "]"}]}],
              ";", 
             RowBox[{"currshannonlist", "=", 
              RowBox[{"Drop", "[", 
               RowBox[{"currshannonlist", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                  "currpcalc", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], ",", 
                  RowBox[{
                   RowBox[{
                   "currpcalc", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "-", "1"}]}], "}"}]}], "]"}]}],
              ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
          ";", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
             "If", " ", "we", " ", "recorded", " ", "a", " ", "value", " ", 
              "after", " ", "a", " ", "non"}], "-", 
             RowBox[{"significant", " ", "value"}]}], ",", " ", 
            RowBox[{
             RowBox[{
             "run", " ", "MaxDrop", " ", "on", " ", "the", " ", "version", 
              " ", "that", " ", "has", " ", "the", " ", "follow"}], "-", 
             RowBox[{"up", " ", "value", " ", "excised"}]}], ",", " ", 
            RowBox[{
            "to", " ", "see", " ", "whether", " ", "the", " ", "previous", 
             " ", "one", " ", "becomes", " ", "significant"}]}], " ", "*)"}], 
          " ", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"numberExtraMaxdropCalcs", ">", "0"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"duffpcalc", "=", 
              RowBox[{"PValueCalc", "[", 
               RowBox[{
               "duffcurrlist", ",", "duffcurrshannonlist", ",", 
                "sigthreshold", ",", "maxrandomlists"}], "]"}]}], ";", 
             RowBox[{"duffPCalc", "=", "duffpcalc"}], ";", 
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<P value calculation result on first non-signficant region \
if the following region is excised would be \>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"N", "[", "duffpcalc", "]"}], "]"}]}], "]"}], ";"}]}],
            "]"}], ";", 
          RowBox[{"{", "extdescents", "}"}]}]}], "]"}]}], ";"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{" ", 
           RowBox[{
            RowBox[{
            "Uninformative", " ", "points", " ", "are", " ", "hardcoded", " ",
              "here", " ", "as", " ", "being", " ", "those", " ", "points", 
             " ", "in", " ", "the", " ", "initially", " ", "passed", " ", 
             "list", " ", "with", " ", "value"}], " ", "-", 
            RowBox[{
            "1", "\[IndentingNewLine]", "\[IndentingNewLine]", "Output", " ", 
             
             RowBox[{"format", ":", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "list", " ", "of", " ", "nodes", " ", "in", " ", 
                    "descent"}], "}"}], ",", 
                  RowBox[{"descent_length", "_current", "_normalisation"}], 
                  ",", "NULL", ",", 
                  RowBox[{"descent_current", "_pvalue"}]}], "}"}], ",", 
                "..."}], "}"}]}]}]}], "}"}], ".", "  ", "Descents"}], " ", 
         "are", " ", "positive"}], " ", "-", " ", 
        RowBox[{
         RowBox[{"i", ".", "e", ".", " ", "negative"}], " ", "values", " ", 
         "are", " ", 
         RowBox[{"ascents", ".", "  ", "The"}], " ", "NULL", " ", "value", 
         " ", "here", " ", "is", " ", "present", " ", "because", " ", "in", 
         " ", "the", " ", "option", " ", "with", " ", "unmasking"}]}], ",", 
       " ", 
       RowBox[{
       "this", " ", "location", " ", "is", " ", "used", " ", "to", " ", 
        "record", " ", "whether", " ", "unmasking", " ", "has", " ", "been", 
        " ", 
        RowBox[{"required", "."}]}]}], "  ", "*)"}], "\[IndentingNewLine]", 
     ",", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"UninformListExtremalDescents", "[", 
        RowBox[{
        "list_", ",", "shannonlist_", ",", "sigthreshold_", ",", 
         "maxrandomlists_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"currlist", "=", 
            RowBox[{"N", "[", "list", "]"}]}], ",", 
           RowBox[{"currshannonlist", "=", "shannonlist"}], ",", 
           RowBox[{"uninformlist", "=", 
            RowBox[{"Position", "[", 
             RowBox[{"list", ",", "\"\<Uninform\>\""}], "]"}]}], ",", 
           RowBox[{"lookuplist", "=", 
            RowBox[{"Table", "[", 
             RowBox[{"i", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}], ",",
            "currdescent", ",", 
           RowBox[{"extdescents", "=", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"calccurrentpvalue", "=", "True"}], ",", "currpcalc", ",", 
           
           RowBox[{"unmaskedSig", "=", "False"}], ",", 
           RowBox[{"continuePcalcs", "=", "True"}], ",", 
           RowBox[{"lastPduff", "=", "False"}], ",", "prevlist", ",", 
           "prevshannonlist", ",", "prevlookuplist", ",", "nextpcalc", ",", 
           "nextpdroppedlookuplist", ",", "nextpdroppedshannonlist", ",", 
           "nextpdroppedlist", ",", "nextpdroppedcalc"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", "\[IndentingNewLine]", 
          RowBox[{
          "Remove", " ", "uninformative", " ", "cases", " ", "from", " ", 
           "consideration"}], "\[IndentingNewLine]", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"currlist", "=", 
           RowBox[{"Delete", "[", 
            RowBox[{"currlist", ",", "uninformlist"}], "]"}]}], ";", 
          RowBox[{"currshannonlist", "=", 
           RowBox[{"Delete", "[", 
            RowBox[{"currshannonlist", ",", "uninformlist"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"lookuplist", "=", 
           RowBox[{"Delete", "[", 
            RowBox[{"lookuplist", ",", "uninformlist"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{"continuePcalcs", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"continuePcalcs", "=", "False"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", "\[IndentingNewLine]", 
              RowBox[{
              "Run", " ", "PValueCalc", " ", "until", " ", "the", " ", 
               "significance", " ", "threshold", " ", "is", " ", "exceeded", 
               " ", "or", " ", "there", " ", "is", " ", "no", " ", "list", 
               " ", "left"}], "\[IndentingNewLine]", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"While", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "currlist", "]"}], ">", "0"}], "&&", 
                "calccurrentpvalue"}], ",", 
               RowBox[{
                RowBox[{"currpcalc", "=", 
                 RowBox[{"PValueCalc", "[", 
                  RowBox[{
                  "currlist", ",", "currshannonlist", ",", "sigthreshold", 
                   ",", "maxrandomlists"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"extdescents", "=", 
                 RowBox[{"Append", "[", 
                  RowBox[{"extdescents", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"lookuplist", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    "currpcalc", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ";;", 
                    RowBox[{
                    RowBox[{
                    "currpcalc", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "-", "1"}]}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "currpcalc", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "unmaskedSig", ",", 
                    RowBox[{
                    "currpcalc", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "}"}]}], "]"}]}], ";", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                   "currpcalc", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ">", "sigthreshold"}], ",", 
                  RowBox[{
                   RowBox[{"calccurrentpvalue", "=", "False"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    "recordUnmaskedSignificantRegions", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"prevlookuplist", "=", "lookuplist"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"prevshannonlist", "=", "currshannonlist"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"prevlist", "=", "currlist"}], ";"}]}], "]"}]}]}],
                  "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{
                   RowBox[{
                   "Need", " ", "to", " ", "store", " ", "the", " ", "lists", 
                    " ", "before", " ", "we", " ", "drop", " ", "the", " ", 
                    "non"}], "-", 
                   RowBox[{"significant", " ", "bit"}]}], " ", "*)"}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"If", " ", "non"}], "-", "significant"}], ",", " ", 
                  RowBox[{
                  "break", " ", "this", " ", "inner", " ", "loop", " ", "and",
                    " ", "go", " ", "to", " ", "the", " ", "next", " ", 
                   "section"}], ",", " ", 
                  RowBox[{
                  "which", " ", "optionally", " ", "removes", " ", "the", " ",
                    "following", " ", "region", " ", "and", " ", "then", " ", 
                   "recalculates", " ", "what", " ", "remains"}]}], " ", 
                 "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"lookuplist", "=", 
                 RowBox[{"Drop", "[", 
                  RowBox[{"lookuplist", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "currpcalc", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    RowBox[{
                    "currpcalc", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "-", "1"}]}], "}"}]}], "]"}]}],
                 ";", 
                RowBox[{"currlist", "=", 
                 RowBox[{"Drop", "[", 
                  RowBox[{"currlist", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "currpcalc", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    RowBox[{
                    "currpcalc", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "-", "1"}]}], "}"}]}], "]"}]}],
                 ";", 
                RowBox[{"currshannonlist", "=", 
                 RowBox[{"Drop", "[", 
                  RowBox[{"currshannonlist", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "currpcalc", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    RowBox[{
                    "currpcalc", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "-", "1"}]}], "}"}]}], "]"}]}],
                 ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}],
              ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{
                RowBox[{
                "Get", " ", "the", " ", "next", " ", "value", " ", "and", " ",
                  "run", " ", "MaxDrop", " ", "on", " ", "the", " ", 
                 "version", " ", "that", " ", "has", " ", "the", " ", 
                 "follow"}], "-", 
                RowBox[{"up", " ", "value", " ", "excised"}]}], ",", " ", 
               RowBox[{
               "to", " ", "see", " ", "whether", " ", "the", " ", "previous", 
                " ", "one", " ", "becomes", " ", "significant"}]}], " ", 
              "*)"}], " ", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"recordUnmaskedSignificantRegions", "&&", 
                RowBox[{
                 RowBox[{"Length", "[", "currlist", "]"}], ">", "0"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"unmaskedSig", "=", "True"}], ";", " ", 
                RowBox[{"(*", " ", 
                 RowBox[{
                 "Set", " ", "the", " ", "flag", " ", "that", " ", "we", " ", 
                  "are", " ", "working", " ", "on", " ", "regions", " ", 
                  "whose", " ", "significance", " ", "has", " ", "only", " ", 
                  "been", " ", "unmasked", " ", "by", " ", "removing", " ", 
                  "at", " ", "least", " ", "later", " ", "region", " ", 
                  "somewhere", " ", "in", " ", "the", " ", "chain"}], " ", 
                 "*)"}], "\[IndentingNewLine]", 
                RowBox[{"nextpcalc", "=", 
                 RowBox[{"PValueCalc", "[", 
                  RowBox[{
                  "currlist", ",", "currshannonlist", ",", "0", ",", "1"}], 
                  "]"}]}], ";", " ", 
                RowBox[{"(*", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Don", "'"}], "t", " ", "actually", " ", "need", 
                    " ", "the", " ", "p"}], "-", 
                   RowBox[{"value", " ", "calculation"}]}], ",", " ", 
                  RowBox[{
                  "but", " ", "it", " ", "may", " ", "create", " ", 
                   "dependency", " ", "issues", " ", "to", " ", "pull", " ", 
                   "out", " ", "the", " ", "components"}], ",", " ", 
                  RowBox[{
                   RowBox[{
                   "so", " ", "run", " ", "a", " ", "minimal", " ", "p"}], 
                   "-", 
                   RowBox[{
                   "value", " ", "calculation", " ", "and", " ", "just", " ", 
                    "use", " ", "the", " ", "calculated", " ", "maxdrop", " ",
                     "later"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    "nextpcalc", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "<", 
                    RowBox[{
                    "currpcalc", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "&&", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    "nextpcalc", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "-", "1"}], "\[GreaterEqual]", 
                    
                    RowBox[{
                    "currpcalc", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"(*", " ", 
                   RowBox[{
                    RowBox[{
                    "Implies", " ", "there", " ", "is", " ", "a", " ", 
                    "nested", " ", "set", " ", "of", " ", "descents"}], ";", 
                    " ", 
                    RowBox[{
                    "in", " ", "this", " ", "case", " ", "work", " ", "on", 
                    " ", "the", " ", "basis", " ", "that", " ", "this", " ", 
                    "is", " ", "not", " ", "unmasking", " ", "something", " ", 
                    RowBox[{"else", "!"}]}]}], " ", "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                   "Print", "[", 
                    "\"\<First identified descent after non-significant \
descent nests the significant region (i.e. is not separate): no further \
calculation for unmasking significance undertaken.\>\"", "]"}], ";"}], 
                  "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "nextpcalc", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "nextpcalc", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "\[Equal]", "0"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    "Print", "[", 
                    "\"\<First identified descent after non-significant \
descent has length 1: no further calculation for unmasking significance \
undertaken.\>\"", "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    "Set", " ", "up", " ", "lists", " ", "that", " ", "allow",
                     " ", "significance", " ", "calculation", " ", "without", 
                    " ", "the", " ", "next", " ", "region"}], " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"nextpdroppedlookuplist", "=", 
                    RowBox[{"Drop", "[", 
                    RowBox[{"prevlookuplist", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "nextpcalc", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "<", 
                    RowBox[{
                    "currpcalc", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{
                    "nextpcalc", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    RowBox[{
                    "nextpcalc", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "+", 
                    RowBox[{
                    "currpcalc", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "currpcalc", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "nextpcalc", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "-", "1"}], "<", 
                    RowBox[{
                    "currpcalc", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    "nextpcalc", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "-", "1"}], ",", 
                    RowBox[{
                    RowBox[{
                    "nextpcalc", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "-", "1", "+", 
                    RowBox[{
                    "currpcalc", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "currpcalc", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}]}], "]"}]}], "}"}]}], "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"nextpdroppedshannonlist", "=", 
                    RowBox[{"Drop", "[", 
                    RowBox[{"prevshannonlist", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "nextpcalc", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "<", 
                    RowBox[{
                    "currpcalc", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{
                    "nextpcalc", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    RowBox[{
                    "nextpcalc", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "+", 
                    RowBox[{
                    "currpcalc", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "currpcalc", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "nextpcalc", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "-", "1"}], "<", 
                    RowBox[{
                    "currpcalc", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    "nextpcalc", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "-", "1"}], ",", 
                    RowBox[{
                    RowBox[{
                    "nextpcalc", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "-", "1", "+", 
                    RowBox[{
                    "currpcalc", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "currpcalc", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}]}], "]"}]}], "}"}]}], "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"nextpdroppedlist", "=", 
                    RowBox[{"Drop", "[", 
                    RowBox[{"prevlist", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "nextpcalc", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "<", 
                    RowBox[{
                    "currpcalc", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{
                    "nextpcalc", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    RowBox[{
                    "nextpcalc", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "+", 
                    RowBox[{
                    "currpcalc", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "currpcalc", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "nextpcalc", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "-", "1"}], "<", 
                    RowBox[{
                    "currpcalc", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    "nextpcalc", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "-", "1"}], ",", 
                    RowBox[{
                    RowBox[{
                    "nextpcalc", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "-", "1", "+", 
                    RowBox[{
                    "currpcalc", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "currpcalc", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}]}], "]"}]}], "}"}]}], "]"}]}], 
                    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    "and", " ", "do", " ", "the", " ", "calculation"}], " ", 
                    "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"nextpdroppedcalc", "=", 
                    RowBox[{"PValueCalc", "[", 
                    RowBox[{
                    "nextpdroppedlist", ",", "nextpdroppedshannonlist", ",", 
                    "sigthreshold", ",", "maxrandomlists"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    "append", " ", "the", " ", "result", " ", "to", " ", 
                    "the", " ", "extremal", " ", "descent", " ", "lists", " ",
                     "in", " ", "any", " ", "case"}], " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"extdescents", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"extdescents", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "nextpdroppedlookuplist", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    "nextpdroppedcalc", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ";;", 
                    RowBox[{
                    RowBox[{
                    "nextpdroppedcalc", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "-", "1"}]}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "nextpdroppedcalc", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "unmaskedSig", ",", 
                    RowBox[{
                    "nextpdroppedcalc", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    RowBox[{"if", " ", "significant"}], ",", " ", 
                    RowBox[{
                    RowBox[{
                    "set", " ", "the", " ", "flag", " ", "to", " ", 
                    "continue", " ", "calculating"}], ";", " ", 
                    RowBox[{
                    "note", " ", "that", " ", "the", " ", "main", " ", "list",
                     " ", "already", " ", "is", " ", "the", " ", "list", " ", 
                    "with", " ", "this", " ", "descent", " ", "removed", " ", 
                    "and", " ", "the", " ", "following", " ", "one", " ", 
                    "in", " ", "for", " ", "full", " ", "calculation"}]}]}], 
                    " ", "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "nextpdroppedcalc", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], "\[LessEqual]", 
                    "sigthreshold"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"extdescents", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1", ",", "1"}], 
                    "\[RightDoubleBracket]"}], "\[Equal]", 
                    RowBox[{"extdescents", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"-", "2"}], ",", "1", ",", "1"}], 
                    "\[RightDoubleBracket]"}]}], "&&", 
                    RowBox[{
                    RowBox[{"extdescents", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1", ",", 
                    RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], 
                    "\[Equal]", 
                    RowBox[{"extdescents", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"-", "2"}], ",", "1", ",", 
                    RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}]}], " ", 
                    
                    RowBox[{"(*", " ", 
                    RowBox[{
                    RowBox[{
                    "Check", " ", "that", " ", "excision", " ", "of", " ", 
                    "the", " ", "following", " ", "region", " ", 
                    RowBox[{"hasn", "'"}], "t", " ", "moved", " ", "where", 
                    " ", "the", " ", "maxdrop", " ", "occurs"}], ";", " ", 
                    RowBox[{
                    "if", " ", "so", " ", "discontinue", " ", "and", " ", 
                    "print", " ", "error", " ", "message"}]}], " ", "*)"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"continuePcalcs", "=", "True"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"calccurrentpvalue", "=", "True"}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "Print", "[", 
                    "\"\<ERROR: Excision of next non-significant region has \
led to a new significant region that differs from the earlier identified \
region.  This can happen when excision of an adjacent region lengthens the \
previous non-significant region. Please review manually to ensure appropriate \
labelling of significant regions.\>\"", "]"}], ";"}]}], "\[IndentingNewLine]",
                     "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ClearAll", "[", 
           RowBox[{
           "currlist", ",", "currshannonlist", ",", "uninformlist", ",", 
            "lookuplist", ",", "currdescent", ",", "calccurrentpvalue", ",", 
            "currpcalc", ",", "unmaskedSig", ",", "continuePcalcs", ",", 
            "lastPduff", ",", "nextpcalc", ",", "nextpdroppedlookuplist", ",",
             "nextpdroppedshannonlist", ",", "nextpdroppedlist", ",", 
            "nextpdroppedcalc", ",", "prevlist", ",", "prevshannonlist", ",", 
            "prevlookuplist"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Remove", "[", 
           RowBox[{
           "currlist", ",", "currshannonlist", ",", "uninformlist", ",", 
            "lookuplist", ",", "currdescent", ",", "calccurrentpvalue", ",", 
            "currpcalc", ",", "unmaskedSig", ",", "continuePcalcs", ",", 
            "lastPduff", ",", "nextpcalc", ",", "nextpdroppedlookuplist", ",",
             "nextpdroppedshannonlist", ",", "nextpdroppedlist", ",", 
            "nextpdroppedcalc", ",", "prevlist", ",", "prevshannonlist", ",", 
            "prevlookuplist"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"{", "extdescents", "}"}]}]}], "]"}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{" ", 
       RowBox[{"Output", " ", 
        RowBox[{"format", ":", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "list", " ", "of", " ", "nodes", " ", "in", " ", "descent"}], 
              "}"}], ",", 
             RowBox[{"descent_length", "_current", "_normalisation"}], ",", 
             RowBox[{
              RowBox[{"whether_calculation", "_performed", "_pre"}], "-", 
              RowBox[{"_or", "_post"}], "-", 
              RowBox[{
              "excision_of", "_a", "_following", "_significant", 
               "_region"}]}], ",", 
             RowBox[{"descent_current", "_pvalue"}]}], "}"}], ",", "..."}], 
          "}"}]}]}], "}"}], ".", "  ", "Descents"}], " ", "are", " ", 
     "positive"}], " ", "-", " ", 
    RowBox[{
     RowBox[{"i", ".", "e", ".", " ", "negative"}], " ", "values", " ", "are",
      " ", 
     RowBox[{"ascents", "."}]}]}], "   ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.672727671901743*^9, 3.672727885188319*^9}, {
   3.6727279293101*^9, 3.672727934157032*^9}, {3.672728458870619*^9, 
   3.672728508561482*^9}, {3.67272857482437*^9, 3.6727286015528584`*^9}, {
   3.672728648248534*^9, 3.672728649662477*^9}, {3.672728747996902*^9, 
   3.6727287594922533`*^9}, 3.672728923865727*^9, {3.6727289898011417`*^9, 
   3.672728995867749*^9}, {3.672729246380525*^9, 3.672729272882353*^9}, {
   3.672729459401732*^9, 3.672729511621256*^9}, 3.672729545088361*^9, {
   3.6727296233303537`*^9, 3.672729712350078*^9}, {3.67273068046635*^9, 
   3.6727306859648457`*^9}, {3.672730929830255*^9, 3.672730930549214*^9}, {
   3.6727314135916758`*^9, 3.672731416501049*^9}, {3.672731497215473*^9, 
   3.672731520818983*^9}, {3.672731639055779*^9, 3.6727316411645393`*^9}, {
   3.6729846328062277`*^9, 3.67298465667889*^9}, {3.672984775073717*^9, 
   3.67298516764004*^9}, {3.672986501364756*^9, 3.672986628154628*^9}, {
   3.6729962351267567`*^9, 3.672996263562831*^9}, {3.672996298042913*^9, 
   3.6729964140137577`*^9}, {3.672996445770072*^9, 3.672996578477166*^9}, {
   3.673694645676195*^9, 3.67369470330873*^9}, {3.673694738790222*^9, 
   3.673694740298759*^9}, {3.6736947735613422`*^9, 3.673694870353115*^9}, 
   3.674236777901947*^9, {3.679467379968202*^9, 3.679467382786562*^9}, {
   3.6794686558870497`*^9, 3.679468675767153*^9}, {3.6794706713288507`*^9, 
   3.6794706956089163`*^9}, {3.746702209977028*^9, 3.7467022263610687`*^9}, {
   3.775999417594385*^9, 3.7759994451463213`*^9}, 3.795798683470522*^9, {
   3.808742601406021*^9, 3.808742605344386*^9}, {3.8087481120139713`*^9, 
   3.808748134337645*^9}, {3.808748241844315*^9, 3.8087482487160463`*^9}, 
   3.808748287030651*^9, {3.8087589375342007`*^9, 3.8087589391436768`*^9}, {
   3.808814436605544*^9, 3.808814445148395*^9}, {3.80881448433541*^9, 
   3.808814501423719*^9}, {3.808814581530073*^9, 3.808814595386311*^9}, {
   3.8088146511030407`*^9, 3.808814718022046*^9}, {3.808822672317573*^9, 
   3.808822824391168*^9}, {3.808822858000877*^9, 3.808822866360652*^9}, {
   3.8089105709386463`*^9, 3.808910638920167*^9}, {3.808910720389475*^9, 
   3.808910721221661*^9}, {3.8089107515367317`*^9, 3.8089107518196087`*^9}, {
   3.808910811351306*^9, 3.80891083162236*^9}, {3.8091568364891977`*^9, 
   3.8091568547536373`*^9}, {3.826113285165264*^9, 3.826113369269843*^9}, {
   3.8261134589514427`*^9, 3.8261136466433353`*^9}, {3.8261137510899267`*^9, 
   3.8261139340664997`*^9}, {3.8261139717957573`*^9, 3.826114087062819*^9}, 
   3.82611413891612*^9, {3.826186016256177*^9, 3.826186021697689*^9}, {
   3.826466650869503*^9, 3.826467026535656*^9}, 3.826473291513522*^9, {
   3.826473326638743*^9, 3.826473362370449*^9}, {3.827047270576336*^9, 
   3.827047277624427*^9}, {3.827048463302061*^9, 3.827048490448676*^9}, {
   3.82705219197331*^9, 3.827052231414277*^9}, {3.8270531273557568`*^9, 
   3.8270531962598248`*^9}, {3.8270532334274693`*^9, 
   3.8270532383070087`*^9}, {3.827126048972327*^9, 3.827126051960186*^9}, {
   3.8271291456134*^9, 3.8271291606072187`*^9}, {3.827646613423152*^9, 
   3.8276466207913857`*^9}, {3.827646652688857*^9, 3.827646759848796*^9}, 
   3.843040132152048*^9, {3.843040301541582*^9, 3.843040306308025*^9}, {
   3.843040495227665*^9, 3.8430404957567377`*^9}, {3.843040546044118*^9, 
   3.843040554587893*^9}, {3.843040591675724*^9, 3.843040779374084*^9}, {
   3.886675480275799*^9, 3.886675700116375*^9}, {3.88667574571599*^9, 
   3.886675745972231*^9}, {3.886675827894494*^9, 3.886675832212241*^9}, 
   3.886676335446679*^9, {3.886676367798703*^9, 3.886676585495277*^9}, 
   3.88675249498687*^9, {3.886753926418392*^9, 
   3.886753927538163*^9}},ExpressionUUID->"a365e41d-f330-4e04-bf98-\
51d374c10f4c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "following", " ", "takes", " ", "output", " ", "from", " ", 
    "above", " ", "and", " ", "just", " ", "returns", " ", "a", " ", "list", 
    " ", "of", " ", "loci", " ", "within", " ", "regions", " ", "deemed", " ",
     "to", " ", "be", " ", "significantly", " ", "conserved"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"UnifiedSigDescentsWithUninform", "[", 
      RowBox[{"list_", ",", "extdesclist_", ",", "sigthreshold_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"output", ",", 
         RowBox[{"uninformlist", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Position", "[", 
            RowBox[{"list", ",", "\"\<Uninform\>\""}], "]"}], "]"}]}], ",", 
         "UninformToInteresting", ",", "extrapoints", ",", "endmaxdrops", ",",
          "ii"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "Set", " ", "output", " ", "to", " ", "the", " ", "union", " ", "of",
           " ", "the", " ", "interesting", " ", "lists"}], ",", " ", 
         RowBox[{"and", " ", "sort", " ", 
          RowBox[{"it", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"output", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"extdesclist", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "i", ",", "5"}], 
                    "\[RightDoubleBracket]"}], "\[LessEqual]", 
                   "sigthreshold"}], ")"}], "&&", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"extdesclist", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "i", ",", "3"}], 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"extdesclist", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", 
                    RowBox[{"i", "-", "1"}], ",", "5"}], 
                    "\[RightDoubleBracket]"}], "\[LessEqual]", "0.05"}], 
                    ")"}], "||", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"extdesclist", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", 
                    RowBox[{"i", "-", "1"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}], "\[Equal]", 
                    RowBox[{"extdesclist", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "i", ",", "1"}], 
                    "\[RightDoubleBracket]"}]}], ")"}]}], ")"}], ",", 
                   "True"}], "]"}]}], ")"}], ",", 
               RowBox[{"extdesclist", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "i", ",", "1"}], "\[RightDoubleBracket]"}], 
               ",", 
               RowBox[{"{", "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", 
                RowBox[{
                "extdesclist", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"endmaxdrops", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{"Select", "[", 
           RowBox[{"output", ",", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"MemberQ", "[", 
               RowBox[{"output", ",", 
                RowBox[{"#", "+", "1"}]}], "]"}]}], "&"}]}], "]"}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "Start", " ", "by", " ", "defining", " ", "an", " ", "internal", 
           " ", "function", " ", "that", " ", "takes", " ", "an", " ", 
           "ordered", " ", "list", " ", "of", " ", "uninformative", " ", 
           "points"}], ",", " ", 
          RowBox[{
          "and", " ", "1.", " ", "checks", " ", "whether", " ", "the", " ", 
           "next", " ", "point", " ", "is", " ", "uninformative"}], ",", " ", 
          
          RowBox[{
           RowBox[{
           "in", " ", "which", " ", "case", " ", "it", " ", "calls", " ", 
            "itself", " ", "with", " ", "that", " ", "point", " ", "appended",
             " ", "to", " ", "the", " ", "list"}], ";", " ", 
           RowBox[{
           "2.", " ", "checks", " ", "whether", " ", "the", " ", "next", " ", 
            "point", " ", "is", " ", "interesting"}]}], ",", " ", 
          RowBox[{
          "in", " ", "which", " ", "case", " ", "it", " ", "returns", " ", 
           "the", " ", 
           RowBox[{"list", ".", "  ", "If"}], " ", "the", " ", "next", " ", 
           "point", " ", "is", " ", "uninteresting"}], ",", " ", 
          RowBox[{"it", " ", "returns", " ", "the", " ", "empty", " ", 
           RowBox[{"set", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"UninformToInteresting", "[", "points_", "]"}], ":=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"uninformlist", ",", 
             RowBox[{
              RowBox[{"points", "\[LeftDoubleBracket]", 
               RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "+", "1"}]}], 
            "]"}], ",", 
           RowBox[{"UninformToInteresting", "[", 
            RowBox[{"Append", "[", 
             RowBox[{"points", ",", 
              RowBox[{
               RowBox[{"points", "\[LeftDoubleBracket]", 
                RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "+", "1"}]}], 
             "]"}], "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"output", ",", 
               RowBox[{
                RowBox[{"points", "\[LeftDoubleBracket]", 
                 RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "+", "1"}]}], 
              "]"}], ",", "points", ",", 
             RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "Go", " ", "through", " ", "all", " ", "points", " ", "at", " ", 
           "the", " ", "end", " ", "of", " ", "maxdrops"}], ",", " ", 
          RowBox[{
          "to", " ", "see", " ", "whether", " ", "there", " ", "is", " ", 
           "an", " ", "uninformative", " ", "point", " ", "to", " ", "the", 
           " ", "right", " ", "of", " ", 
           RowBox[{"it", ".", " ", "If"}], " ", "so"}], ",", " ", 
          RowBox[{
          "keep", " ", "looking", " ", "to", " ", "the", " ", "right", " ", 
           "until", " ", "an", " ", "informative", " ", "point", " ", "is", 
           " ", "found"}], ",", " ", 
          RowBox[{
          "then", " ", "do", " ", "nothing", " ", "if", " ", "an", " ", 
           "uninteresting", " ", "point"}], ",", " ", 
          RowBox[{
          "or", " ", "make", " ", "all", " ", "the", " ", "uninformative", 
           " ", "points", " ", "picked", " ", "up", " ", "interesting", " ", 
           "if", " ", "an", " ", "interesting", " ", 
           RowBox[{"point", ".", "  ", "Start"}], " ", "at", " ", "the", " ", 
           "penultimate", " ", "position", " ", "in", " ", "the", " ", 
           "maxdrop", " ", "ends", " ", "list"}], ",", " ", 
          RowBox[{
          "since", " ", "there", " ", "cannot", " ", "be", " ", "an", " ", 
           "interesting", " ", "point", " ", "to", " ", "the", " ", "right", 
           " ", "of", " ", "the", " ", "last", " ", 
           RowBox[{"point", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"ii", "=", 
         RowBox[{
          RowBox[{"Length", "[", "endmaxdrops", "]"}], "-", "1"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"ii", ">", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"uninformlist", ",", 
               RowBox[{
                RowBox[{
                "endmaxdrops", "\[LeftDoubleBracket]", "ii", 
                 "\[RightDoubleBracket]"}], "+", "1"}]}], "]"}], ",", 
             RowBox[{
              RowBox[{"extrapoints", "=", 
               RowBox[{"UninformToInteresting", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                  "endmaxdrops", "\[LeftDoubleBracket]", "ii", 
                   "\[RightDoubleBracket]"}], "+", "1"}], "}"}], "]"}]}], ";", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "extrapoints", "]"}], "\[NotEqual]", 
                 "0"}], ",", 
                RowBox[{"output", "=", 
                 RowBox[{"Sort", "[", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{"{", 
                    RowBox[{"output", ",", "extrapoints"}], "}"}], "]"}], 
                  "]"}]}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"ii", "-=", "1"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "output"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"UnifiedSigDescentsWithUninformNoUnmaskedRegions", "[", 
      RowBox[{"list_", ",", "extdesclist_", ",", "sigthreshold_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"output", ",", 
         RowBox[{"uninformlist", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Position", "[", 
            RowBox[{"list", ",", "\"\<Uninform\>\""}], "]"}], "]"}]}], ",", 
         "UninformToInteresting", ",", "extrapoints", ",", "endmaxdrops", ",",
          "ii"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "Set", " ", "output", " ", "to", " ", "the", " ", "union", " ", "of",
           " ", "the", " ", "interesting", " ", "lists"}], ",", " ", 
         RowBox[{"and", " ", "sort", " ", 
          RowBox[{"it", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"output", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"extdesclist", "\[LeftDoubleBracket]", 
                  RowBox[{"1", ",", "i", ",", "4"}], 
                  "\[RightDoubleBracket]"}], "\[LessEqual]", "sigthreshold"}],
                 "&&", 
                RowBox[{
                 RowBox[{"extdesclist", "\[LeftDoubleBracket]", 
                  RowBox[{"1", ",", "i", ",", "3"}], 
                  "\[RightDoubleBracket]"}], "\[NotEqual]", "True"}]}], ",", 
               RowBox[{"extdesclist", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "i", ",", "1"}], "\[RightDoubleBracket]"}], 
               ",", 
               RowBox[{"{", "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", 
                RowBox[{
                "extdesclist", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Comparator", " ", "to", " ", "True", " ", "so", " ", "that", " ", 
          "output", " ", "returned", " ", "if", " ", "inadvertently", " ", 
          "using", " ", "the", " ", "version", " ", "that", " ", "does", " ", 
          "not", " ", "look", " ", "for", " ", "unmasked", " ", "regions", 
          " ", "at", " ", "all"}], " ", "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"endmaxdrops", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{"Select", "[", 
           RowBox[{"output", ",", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"MemberQ", "[", 
               RowBox[{"output", ",", 
                RowBox[{"#", "+", "1"}]}], "]"}]}], "&"}]}], "]"}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "Start", " ", "by", " ", "defining", " ", "an", " ", "internal", 
           " ", "function", " ", "that", " ", "takes", " ", "an", " ", 
           "ordered", " ", "list", " ", "of", " ", "uninformative", " ", 
           "points"}], ",", " ", 
          RowBox[{
          "and", " ", "1.", " ", "checks", " ", "whether", " ", "the", " ", 
           "next", " ", "point", " ", "is", " ", "uninformative"}], ",", " ", 
          
          RowBox[{
           RowBox[{
           "in", " ", "which", " ", "case", " ", "it", " ", "calls", " ", 
            "itself", " ", "with", " ", "that", " ", "point", " ", "appended",
             " ", "to", " ", "the", " ", "list"}], ";", " ", 
           RowBox[{
           "2.", " ", "checks", " ", "whether", " ", "the", " ", "next", " ", 
            "point", " ", "is", " ", "interesting"}]}], ",", " ", 
          RowBox[{
          "in", " ", "which", " ", "case", " ", "it", " ", "returns", " ", 
           "the", " ", 
           RowBox[{"list", ".", "  ", "If"}], " ", "the", " ", "next", " ", 
           "point", " ", "is", " ", "uninteresting"}], ",", " ", 
          RowBox[{"it", " ", "returns", " ", "the", " ", "empty", " ", 
           RowBox[{"set", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"UninformToInteresting", "[", "points_", "]"}], ":=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"uninformlist", ",", 
             RowBox[{
              RowBox[{"points", "\[LeftDoubleBracket]", 
               RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "+", "1"}]}], 
            "]"}], ",", 
           RowBox[{"UninformToInteresting", "[", 
            RowBox[{"Append", "[", 
             RowBox[{"points", ",", 
              RowBox[{
               RowBox[{"points", "\[LeftDoubleBracket]", 
                RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "+", "1"}]}], 
             "]"}], "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"output", ",", 
               RowBox[{
                RowBox[{"points", "\[LeftDoubleBracket]", 
                 RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "+", "1"}]}], 
              "]"}], ",", "points", ",", 
             RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "Go", " ", "through", " ", "all", " ", "points", " ", "at", " ", 
           "the", " ", "end", " ", "of", " ", "maxdrops"}], ",", " ", 
          RowBox[{
          "to", " ", "see", " ", "whether", " ", "there", " ", "is", " ", 
           "an", " ", "uninformative", " ", "point", " ", "to", " ", "the", 
           " ", "right", " ", "of", " ", 
           RowBox[{"it", ".", " ", "If"}], " ", "so"}], ",", " ", 
          RowBox[{
          "keep", " ", "looking", " ", "to", " ", "the", " ", "right", " ", 
           "until", " ", "an", " ", "informative", " ", "point", " ", "is", 
           " ", "found"}], ",", " ", 
          RowBox[{
          "then", " ", "do", " ", "nothing", " ", "if", " ", "an", " ", 
           "uninteresting", " ", "point"}], ",", " ", 
          RowBox[{
          "or", " ", "make", " ", "all", " ", "the", " ", "uninformative", 
           " ", "points", " ", "picked", " ", "up", " ", "interesting", " ", 
           "if", " ", "an", " ", "interesting", " ", 
           RowBox[{"point", ".", "  ", "Start"}], " ", "at", " ", "the", " ", 
           "penultimate", " ", "position", " ", "in", " ", "the", " ", 
           "maxdrop", " ", "ends", " ", "list"}], ",", " ", 
          RowBox[{
          "since", " ", "there", " ", "cannot", " ", "be", " ", "an", " ", 
           "interesting", " ", "point", " ", "to", " ", "the", " ", "right", 
           " ", "of", " ", "the", " ", "last", " ", 
           RowBox[{"point", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"ii", "=", 
         RowBox[{
          RowBox[{"Length", "[", "endmaxdrops", "]"}], "-", "1"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"ii", ">", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"uninformlist", ",", 
               RowBox[{
                RowBox[{
                "endmaxdrops", "\[LeftDoubleBracket]", "ii", 
                 "\[RightDoubleBracket]"}], "+", "1"}]}], "]"}], ",", 
             RowBox[{
              RowBox[{"extrapoints", "=", 
               RowBox[{"UninformToInteresting", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                  "endmaxdrops", "\[LeftDoubleBracket]", "ii", 
                   "\[RightDoubleBracket]"}], "+", "1"}], "}"}], "]"}]}], ";", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "extrapoints", "]"}], "\[NotEqual]", 
                 "0"}], ",", 
                RowBox[{"output", "=", 
                 RowBox[{"Sort", "[", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{"{", 
                    RowBox[{"output", ",", "extrapoints"}], "}"}], "]"}], 
                  "]"}]}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"ii", "-=", "1"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "output"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SigDescentStartEnd", "[", "unifiedList_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"output", "=", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"ii", "=", "1"}], ",", "jj"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "Get", " ", "the", " ", "start", " ", "and", " ", "end", " ", 
          "points", " ", "as", " ", "pairs", " ", "from", " ", "a", " ", 
          "unified", " ", "list"}], " ", "-", " ", 
         RowBox[{
         "saves", " ", "needing", " ", "to", " ", "check", " ", 
          "uninformative", " ", "points", " ", "again"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "unifiedList", "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{"ii", "\[LessEqual]", 
             RowBox[{"Length", "[", "unifiedList", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"ii", " ", "indexes", " ", "start", " ", "points"}], 
              ",", " ", 
              RowBox[{"jj", " ", "indexes", " ", "end", " ", "points"}]}], 
             " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"ii", "\[Equal]", 
                RowBox[{"Length", "[", "unifiedList", "]"}]}], ",", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"output", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"3", "*", 
                    RowBox[{
                    "unifiedList", "\[LeftDoubleBracket]", "ii", 
                    "\[RightDoubleBracket]"}]}], "-", "2"}], ",", 
                   RowBox[{"3", "*", 
                    RowBox[{
                    "unifiedList", "\[LeftDoubleBracket]", "ii", 
                    "\[RightDoubleBracket]"}]}]}], "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"jj", "=", 
                 RowBox[{"ii", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"While", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"jj", "\[LessEqual]", 
                    RowBox[{"Length", "[", "unifiedList", "]"}]}], "&&", 
                   RowBox[{
                    RowBox[{
                    "unifiedList", "\[LeftDoubleBracket]", "jj", 
                    "\[RightDoubleBracket]"}], "\[Equal]", 
                    RowBox[{
                    RowBox[{"unifiedList", "\[LeftDoubleBracket]", 
                    RowBox[{"jj", "-", "1"}], "\[RightDoubleBracket]"}], "+", 
                    "1"}]}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"(*", " ", 
                   RowBox[{
                   "Keep", " ", "incrementing", " ", "the", " ", "end", " ", 
                    "point", " ", "until", " ", "it", " ", "is", " ", "no", 
                    " ", "longer", " ", "contiguous", " ", "with", " ", "the",
                     " ", "start", " ", "point"}], " ", "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"jj", "++"}], ";"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"output", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"3", "*", 
                    RowBox[{
                    "unifiedList", "\[LeftDoubleBracket]", "ii", 
                    "\[RightDoubleBracket]"}]}], "-", "2"}], ",", 
                    RowBox[{"3", "*", 
                    RowBox[{"unifiedList", "\[LeftDoubleBracket]", 
                    RowBox[{"jj", "-", "1"}], "\[RightDoubleBracket]"}]}]}], 
                   "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"ii", "=", "jj"}], ";"}]}], " ", 
              RowBox[{"(*", " ", 
               RowBox[{
               "Next", " ", "start", " ", "is", " ", "one", " ", "past", " ", 
                "the", " ", "last", " ", "finish"}], " ", "*)"}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"ii", "++"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]",
           "output"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.672727671901743*^9, 3.672727885188319*^9}, {
   3.6727279293101*^9, 3.672727934157032*^9}, {3.672728458870619*^9, 
   3.672728508561482*^9}, {3.67272857482437*^9, 3.6727286015528584`*^9}, {
   3.672728648248534*^9, 3.672728649662477*^9}, {3.672728747996902*^9, 
   3.6727287594922533`*^9}, 3.672728923865727*^9, {3.6727289898011417`*^9, 
   3.672728995867749*^9}, {3.672729246380525*^9, 3.672729272882353*^9}, {
   3.672729459401732*^9, 3.672729511621256*^9}, 3.672729545088361*^9, {
   3.6727296233303537`*^9, 3.672729712350078*^9}, {3.67273068046635*^9, 
   3.6727306859648457`*^9}, {3.672730929830255*^9, 3.672730930549214*^9}, {
   3.6727314135916758`*^9, 3.672731416501049*^9}, {3.672731497215473*^9, 
   3.672731520818983*^9}, {3.672731639055779*^9, 3.6727316411645393`*^9}, {
   3.6729846328062277`*^9, 3.67298465667889*^9}, {3.672984775073717*^9, 
   3.67298516764004*^9}, {3.672986501364756*^9, 3.672986628154628*^9}, {
   3.6729962351267567`*^9, 3.672996263562831*^9}, {3.672996298042913*^9, 
   3.6729964140137577`*^9}, {3.672996445770072*^9, 3.672996578477166*^9}, {
   3.673694645676195*^9, 3.67369470330873*^9}, {3.673694738790222*^9, 
   3.673694740298759*^9}, {3.6736947735613422`*^9, 3.673694870353115*^9}, 
   3.674236777901947*^9, {3.679467379968202*^9, 3.679467382786562*^9}, {
   3.6794686558870497`*^9, 3.679468675767153*^9}, {3.6794706713288507`*^9, 
   3.6794706956089163`*^9}, {3.746702209977028*^9, 3.7467022263610687`*^9}, {
   3.775999417594385*^9, 3.7759994451463213`*^9}, 3.795798683470522*^9, {
   3.808742601406021*^9, 3.808742605344386*^9}, {3.8087481120139713`*^9, 
   3.808748134337645*^9}, {3.808748241844315*^9, 3.8087482487160463`*^9}, 
   3.808748287030651*^9, {3.8087589375342007`*^9, 3.8087589391436768`*^9}, {
   3.808814436605544*^9, 3.808814445148395*^9}, {3.80881448433541*^9, 
   3.808814501423719*^9}, {3.808814581530073*^9, 3.808814595386311*^9}, {
   3.8088146511030407`*^9, 3.808814718022046*^9}, {3.808822672317573*^9, 
   3.808822824391168*^9}, {3.808822858000877*^9, 3.808822866360652*^9}, {
   3.8089105709386463`*^9, 3.808910638920167*^9}, {3.808910720389475*^9, 
   3.808910721221661*^9}, {3.8089107515367317`*^9, 3.8089107518196087`*^9}, {
   3.808910811351306*^9, 3.80891083162236*^9}, {3.8091568364891977`*^9, 
   3.8091568547536373`*^9}, {3.826113285165264*^9, 3.826113369269843*^9}, {
   3.8261134589514427`*^9, 3.8261136466433353`*^9}, {3.8261137510899267`*^9, 
   3.8261139340664997`*^9}, {3.8261139717957573`*^9, 3.826114087062819*^9}, 
   3.82611413891612*^9, {3.826186016256177*^9, 3.826186021697689*^9}, {
   3.826466650869503*^9, 3.826467026535656*^9}, 3.826473291513522*^9, {
   3.826473326638743*^9, 3.826473362370449*^9}, {3.827047270576336*^9, 
   3.827047277624427*^9}, {3.827048463302061*^9, 3.827048490448676*^9}, {
   3.82705219197331*^9, 3.827052231414277*^9}, {3.8270531273557568`*^9, 
   3.8270531962598248`*^9}, {3.8270532334274693`*^9, 
   3.8270532383070087`*^9}, {3.827126048972327*^9, 3.827126051960186*^9}, {
   3.8271291456134*^9, 3.8271291606072187`*^9}, {3.827646613423152*^9, 
   3.8276466207913857`*^9}, {3.827646652688857*^9, 3.827646759848796*^9}, 
   3.843040132152048*^9, {3.843040301541582*^9, 3.843040306308025*^9}, {
   3.843040495227665*^9, 3.8430404957567377`*^9}, {3.843040546044118*^9, 
   3.843040554587893*^9}, {3.843040591675724*^9, 3.843040779374084*^9}, 
   3.886676772006377*^9, {3.886676824230565*^9, 3.8866768295267887`*^9}, {
   3.8866768605031767`*^9, 3.886676891879836*^9}, {3.886678976945122*^9, 
   3.88667900888179*^9}, 
   3.89935521466495*^9},ExpressionUUID->"fe2131da-b37c-4520-a084-\
9544452e020c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rank", "[", "list_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"temp", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Ordering", "@", 
          RowBox[{"Ordering", "@", "list"}]}], "+", 
         RowBox[{"Reverse", "@", 
          RowBox[{"Ordering", "@", 
           RowBox[{"Ordering", "@", 
            RowBox[{"Reverse", "@", "list"}]}]}]}]}], ")"}], "/", "2"}]}], 
     "}"}], ",", 
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"#2", "\[Equal]", "\"\<Uninform\>\""}], ",", 
         "\"\<Uninform\>\"", ",", "#1"}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"temp", ",", "list"}], "}"}]}], "]"}]}], "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "When", " ", "using", " ", "nPD", " ", "ranks", " ", "rather", " ", "than",
     " ", "actual", " ", "values"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.8276474404866037`*^9, 3.827647462644559*^9}, {
   3.827658193030588*^9, 3.827658213853615*^9}, {3.8276582605033083`*^9, 
   3.827658315396125*^9}, 3.827658369618923*^9},
 CellLabel->"In[40]:=",ExpressionUUID->"ee4c5e83-1d2a-4f88-805f-bc18bcc81e80"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"shannonRank", "[", 
     RowBox[{"list_", ",", "information_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"temp1", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "/.", 
            RowBox[{"Thread", "[", 
             RowBox[{
              RowBox[{"Sort", "@", "#"}], "\[Rule]", 
              RowBox[{"Range", "[", 
               RowBox[{"Length", "@", "#"}], "]"}]}], "]"}]}], "&"}], "@", 
          "list"}]}], ",", 
        RowBox[{"temp2", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "/.", 
            RowBox[{"Thread", "[", 
             RowBox[{
              RowBox[{"Reverse", "@", 
               RowBox[{"Sort", "@", "#"}]}], "\[Rule]", 
              RowBox[{"Reverse", "[", 
               RowBox[{"Range", "[", 
                RowBox[{"Length", "@", "#"}], "]"}], "]"}]}], "]"}]}], "&"}], 
          "@", "list"}]}], ",", 
        RowBox[{"temp3", "=", 
         RowBox[{"Ordering", "@", "list"}]}], ",", "temp4", ",", "temp5", ",",
         "temp6", ",", "temp7", ",", "temp8"}], "}"}], ",", 
      RowBox[{
       RowBox[{"temp4", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Range", ",", 
          RowBox[{"{", 
           RowBox[{"temp1", ",", "temp2"}], "}"}]}], "]"}]}], ";", 
       RowBox[{"temp5", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"temp3", "\[LeftDoubleBracket]", 
           RowBox[{
           "temp4", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], 
           "\[RightDoubleBracket]"}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "temp3", "]"}], "]"}]}]}], ";", 
       RowBox[{"temp6", "=", 
        RowBox[{
        "temp5", "\[LeftDoubleBracket]", "temp3", "\[RightDoubleBracket]"}]}],
        ";", 
       RowBox[{"temp7", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{"information", "\[LeftDoubleBracket]", 
             RowBox[{
             "temp6", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], 
             "\[RightDoubleBracket]"}], "]"}], "/", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{"Length", ",", "temp6"}], "]"}], "\[LeftDoubleBracket]", 
            "#", "\[RightDoubleBracket]"}]}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "temp6", "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"temp8", "=", 
        RowBox[{"Accumulate", "[", "temp7", "]"}]}], ";", 
       RowBox[{"ClearAll", "[", 
        RowBox[{
        "temp2", ",", "temp3", ",", "temp4", ",", "temp5", ",", "temp6", ",", 
         "temp7"}], "]"}], ";", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"#2", "\[Equal]", "\"\<Uninform\>\""}], ",", 
            "\"\<Uninform\>\"", ",", 
            RowBox[{
            "temp8", "\[LeftDoubleBracket]", "#1", 
             "\[RightDoubleBracket]"}]}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"temp1", ",", "list"}], "}"}]}], "]"}]}]}], "]"}]}], ";"}], 
  
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Produces", " ", "a", " ", "ranked", " ", "list", " ", "of", " ", 
     "nPDs"}], ",", " ", 
    RowBox[{"as", " ", "above"}], ",", " ", 
    RowBox[{
    "but", " ", "rather", " ", "than", " ", "integer", " ", "ranking"}], ",", 
    " ", 
    RowBox[{
    "the", " ", "list", " ", "is", " ", "incremented", " ", "by", " ", "the", 
     " ", "amount", " ", "of", " ", "Shannon", " ", "information", " ", "in", 
     " ", "each", " ", "list", " ", "component", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
        "so", " ", "\"\<list\>\"", " ", "and", " ", "\"\<information\>\"", 
         " ", "have", " ", "to", " ", "have", " ", "the", " ", "same", " ", 
         "length"}], ",", " ", 
        RowBox[{
        "and", " ", "correspond", " ", "to", " ", "each", " ", "other"}]}], 
       ")"}], ".", "  ", "Where"}], " ", "two", " ", "or", " ", "more", " ", 
     "nPDs", " ", "are", " ", "equal"}], ",", " ", 
    RowBox[{
    "the", " ", "rank", " ", "is", " ", "incremented", " ", "by", " ", "the", 
     " ", "mean", " ", "Shannon", " ", "information", " ", "of", " ", "all", 
     " ", "of", " ", "them", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
       "most", " ", "of", " ", "the", " ", "intermediate", " ", "steps", " ", 
        "exist", " ", "to", " ", "deal", " ", "with", " ", "this", " ", 
        "potential", " ", "issue", " ", "for", " ", "an", " ", "arbitrary", 
        " ", "number", " ", "of", " ", "ties"}], ")"}], ".", "  ", 
      "Finally"}]}], ",", " ", 
    RowBox[{
    "the", " ", "function", " ", "carries", " ", "through", " ", 
     "uninformative", " ", "position", " ", 
     RowBox[{"markers", "."}]}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.842703790224567*^9, 3.8427037911515627`*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"ed1146eb-98b6-4fa0-9032-399e8fb6295b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CalculatePDExtremalDescent", "[", 
    RowBox[{
    "numtrials_", ",", "highgapproportion_", ",", "weighted_", ",", 
     "stattype_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{
      RowBox[{
      "PrintTemporary", "[", 
       "\"\<Calculating extremal descents on PDs...\>\"", "]"}], ";", 
      RowBox[{"UninformListExtremalDescents", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"stattype", "\[Equal]", "\"\<Ranked\>\""}], ",", 
          RowBox[{"If", "[", 
           RowBox[{"weighted", ",", 
            RowBox[{"shannonRank", "[", 
             RowBox[{
              RowBox[{"nPDsGapsSuppressed", "[", "highgapproportion", "]"}], 
              ",", 
              RowBox[{
              "shannonInformationGapsSuppressed", "[", "highgapproportion", 
               "]"}]}], "]"}], ",", 
            RowBox[{"rank", "[", 
             RowBox[{"nPDsGapsSuppressed", "[", "highgapproportion", "]"}], 
             "]"}]}], "]"}], ",", 
          RowBox[{"nPDsGapsSuppressed", "[", "highgapproportion", "]"}]}], 
         "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{"weighted", ",", 
          FractionBox[
           RowBox[{
           "shannonInformationGapsSuppressed", "[", "highgapproportion", 
            "]"}], 
           RowBox[{"Mean", "[", 
            RowBox[{
            "shannonInformationGapsSuppressed", "[", "highgapproportion", 
             "]"}], "]"}]], ",", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"nPDsGapsSuppressed", "[", "highgapproportion", "]"}], 
             "]"}]}], "]"}]}], "]"}], ",", "0.05", ",", "numtrials"}], 
       "]"}]}]}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"OrganismPDExtremalDescentLists", "[", 
    RowBox[{"highgapproportion_", ",", "weighted_", ",", "stattype_"}], "]"}],
    ":=", 
   RowBox[{
    RowBox[{"OrganismPDExtremalDescentLists", "[", 
     RowBox[{"highgapproportion", ",", "weighted", ",", "stattype"}], "]"}], 
    "=", 
    RowBox[{"CalculatePDExtremalDescent", "[", 
     RowBox[{
     "maxdropReplicates", ",", "highgapproportion", ",", "weighted", ",", 
      "stattype"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.786974521288578*^9, 3.786974533856756*^9}, {
   3.786974578377926*^9, 3.78697459125054*^9}, {3.786974648820128*^9, 
   3.786974664548223*^9}, {3.789996456143683*^9, 3.7899964622799797`*^9}, {
   3.790068946922401*^9, 3.790068950314849*^9}, {3.790327655757471*^9, 
   3.7903276558921947`*^9}, {3.790327946108028*^9, 3.7903279788413877`*^9}, {
   3.794421154605166*^9, 3.7944211635365868`*^9}, 3.7945741592280893`*^9, {
   3.826013204640188*^9, 3.8260132046523952`*^9}, 3.826022963621533*^9, {
   3.826114213281351*^9, 3.826114215039858*^9}, {3.826114245960689*^9, 
   3.826114253256865*^9}, 3.826176998736847*^9, 3.826307208244561*^9, {
   3.826466433432826*^9, 3.826466446208396*^9}, {3.826474107654603*^9, 
   3.826474120803253*^9}, {3.8264741542968397`*^9, 3.826474203457431*^9}, {
   3.826474238435176*^9, 3.82647423873794*^9}, {3.827647076567594*^9, 
   3.827647207227693*^9}, {3.827647251110437*^9, 3.827647252470199*^9}, {
   3.827647584937764*^9, 3.82764760644627*^9}, {3.827647671137224*^9, 
   3.827647691745077*^9}, {3.827669648969242*^9, 3.827669653049179*^9}, {
   3.842950901387208*^9, 3.8429509063278646`*^9}, 3.843040831111899*^9, {
   3.8430417002126207`*^9, 3.8430417012517843`*^9}, 3.886679261841963*^9, {
   3.886679795620469*^9, 3.886679885812828*^9}, {3.886680538679792*^9, 
   3.886680538808072*^9}},ExpressionUUID->"af9449cf-4a4c-4d74-b32f-\
3c3542cb167b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CalculatedPDOrganismExtremalDescentList", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"whichCalculations", "\[LeftDoubleBracket]", 
     RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{
     RowBox[{
     "PrintTemporary", "[", "\"\<Unweighted calculation on raw nPDs\>\"", 
      "]"}], ";", 
     RowBox[{
      RowBox[{
      "CalculatedPDOrganismExtremalDescentList", "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"OrganismPDExtremalDescentLists", "[", 
       RowBox[{"0.1", ",", "False", ",", "\"\<Normal\>\""}], "]"}]}]}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"whichCalculations", "\[LeftDoubleBracket]", 
     RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{
     RowBox[{
     "PrintTemporary", "[", "\"\<Unweighted calculation on ranked nPDs\>\"", 
      "]"}], ";", 
     RowBox[{
      RowBox[{
      "CalculatedPDOrganismExtremalDescentList", "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"OrganismPDExtremalDescentLists", "[", 
       RowBox[{"0.1", ",", "False", ",", "\"\<Ranked\>\""}], "]"}]}]}]}], 
   "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"whichCalculations", "\[LeftDoubleBracket]", 
     RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{
     RowBox[{
     "PrintTemporary", "[", "\"\<Weighted calculation on raw nPDs\>\"", "]"}],
      ";", 
     RowBox[{
      RowBox[{
      "CalculatedPDOrganismExtremalDescentList", "\[LeftDoubleBracket]", 
       RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"OrganismPDExtremalDescentLists", "[", 
       RowBox[{"0.1", ",", "True", ",", "\"\<Normal\>\""}], "]"}]}]}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"whichCalculations", "\[LeftDoubleBracket]", 
     RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{
     RowBox[{
     "PrintTemporary", "[", "\"\<Weighted calculation on ranked nPDs\>\"", 
      "]"}], ";", 
     RowBox[{
      RowBox[{
      "CalculatedPDOrganismExtremalDescentList", "\[LeftDoubleBracket]", 
       RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"OrganismPDExtremalDescentLists", "[", 
       RowBox[{"0.1", ",", "True", ",", "\"\<Ranked\>\""}], "]"}]}]}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7869747241421843`*^9, 3.786974764750207*^9}, {
  3.788616204785001*^9, 3.7886162347770977`*^9}, {3.788616285240799*^9, 
  3.788616285692157*^9}, {3.827647831028289*^9, 3.827647883643075*^9}, {
  3.827647923659753*^9, 3.827648048004076*^9}, {3.8276482516136627`*^9, 
  3.8276482903105507`*^9}, {3.827655867541853*^9, 3.8276558705736027`*^9}, {
  3.827664435292156*^9, 3.827664437226934*^9}, {3.827669699850493*^9, 
  3.827669708698017*^9}, {3.886679733413021*^9, 3.886679735588098*^9}, {
  3.886680277910327*^9, 3.886680278646462*^9}, {3.886680469543277*^9, 
  3.8866804829043922`*^9}},ExpressionUUID->"a4f08342-c684-40e3-9d2c-\
c8d24845075a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CalculatePDUnifiedDescent", "[", "highgapproportion_", "]"}], ":=", 
   RowBox[{
    RowBox[{"CalculatePDUnifiedDescent", "[", "highgapproportion", "]"}], "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"whichCalculations", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"UnifiedSigDescentsWithUninform", "[", 
           RowBox[{
            RowBox[{"nPDsGapsSuppressed", "[", "highgapproportion", "]"}], 
            ",", 
            RowBox[{
            "CalculatedPDOrganismExtremalDescentList", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
            "0.05"}], "]"}], ","}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "2"}], "}"}]}], "]"}]}], "]"}]}]}], ";", 
  RowBox[{"OrganismPDUnifiedSigDescentLists", "=", 
   RowBox[{"CalculatePDUnifiedDescent", "[", "0.1", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
      "unmaskedSignificantRegionsOrExtraCalcs", "\[Equal]", 
       "\"\<unmaskedregions\>\""}], "&&", 
      "recordUnmaskedSignificantRegions"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
       "CalculatePDUnifiedDescentNoUnmaskedRegions", "[", 
        "highgapproportion_", "]"}], ":=", 
       RowBox[{
        RowBox[{
        "CalculatePDUnifiedDescentNoUnmaskedRegions", "[", 
         "highgapproportion", "]"}], "=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{
           RowBox[{
           "PrintTemporary", "[", 
            "\"\<Calculating PD unified descents without unmasked \
regions...\>\"", "]"}], ";", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"whichCalculations", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
               RowBox[{"UnifiedSigDescentsWithUninformNoUnmaskedRegions", "[", 
                RowBox[{
                 RowBox[{
                 "nPDsGapsSuppressed", "[", "highgapproportion", "]"}], ",", 
                 RowBox[{
                 "CalculatedPDOrganismExtremalDescentList", 
                  "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
                 "0.05"}], "]"}], ","}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "2"}], "}"}]}], "]"}]}]}], "]"}]}]}], ";", 
      RowBox[{"OrganismPDUnifiedSigDescentListsNoUnmaskedRegions", "=", 
       RowBox[{
       "CalculatePDUnifiedDescentNoUnmaskedRegions", "[", "0.1", "]"}]}]}]}], 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
    "unmaskedSignificantRegionsOrExtraCalcs", "\[Equal]", 
     "\"\<extracalcs\>\""}], ",", "\n", 
    RowBox[{
     RowBox[{
      RowBox[{
      "CalculatePDUnifiedDescentInclMarginal", "[", "highgapproportion_", 
       "]"}], ":=", 
      RowBox[{
       RowBox[{
       "CalculatePDUnifiedDescentInclMarginal", "[", "highgapproportion", 
        "]"}], "=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{
          RowBox[{
          "PrintTemporary", "[", "\"\<Calculating unified PD descents...\>\"",
            "]"}], ";", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"whichCalculations", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
              RowBox[{"UnifiedSigDescentsWithUninform", "[", 
               RowBox[{
                RowBox[{"nPDsGapsSuppressed", "[", "highgapproportion", "]"}],
                 ",", 
                RowBox[{
                "CalculatedPDOrganismExtremalDescentList", 
                 "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
                "1"}], "]"}], ","}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "2"}], "}"}]}], "]"}]}]}], "]"}]}]}], ";", 
     RowBox[{"OrganismPDUnifiedSigDescentListsInclMarginal", "=", 
      RowBox[{"CalculatePDUnifiedDescentInclMarginal", "[", "0.1", "]"}]}]}], 
    ",", 
    RowBox[{
     RowBox[{"OrganismPDUnifiedSigDescentListsInclMarginal", "=", 
      RowBox[{
      "PrintTemporary", "[", "\"\<Calculating unified PD descents...\>\"", 
       "]"}]}], ";", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"whichCalculations", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"UnifiedSigDescentsWithUninform", "[", 
          RowBox[{
           RowBox[{"nPDsGapsSuppressed", "[", "0.1", "]"}], ",", 
           RowBox[{
           "CalculatedPDOrganismExtremalDescentList", "\[LeftDoubleBracket]", 
            
            RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", "1"}], 
          "]"}], ","}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "2"}], "}"}]}], "]"}]}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6794714334120502`*^9, 3.6794714455448236`*^9}, {
   3.6794714849993887`*^9, 3.679471514313149*^9}, 3.6794723680260973`*^9, {
   3.679482909996348*^9, 3.6794829966282997`*^9}, {3.6794830357659483`*^9, 
   3.679483062539831*^9}, {3.680509500133855*^9, 3.68050951132125*^9}, {
   3.680509655297812*^9, 3.680509656258938*^9}, {3.6805097508364058`*^9, 
   3.680509755114056*^9}, {3.68067916027874*^9, 3.680679170104824*^9}, {
   3.706256441094778*^9, 3.706256489219396*^9}, {3.706425918918685*^9, 
   3.7064260393936853`*^9}, {3.706426958678995*^9, 3.706426961817019*^9}, {
   3.720854871692293*^9, 3.720854873870969*^9}, {3.776165981676855*^9, 
   3.7761659835934258`*^9}, {3.786974843392714*^9, 3.786974907995493*^9}, {
   3.786999207440919*^9, 3.7869992075429*^9}, {3.790069550444319*^9, 
   3.7900695600459633`*^9}, {3.79007310974745*^9, 3.790073114613226*^9}, {
   3.7900731509978848`*^9, 3.790073155206176*^9}, {3.790073191366036*^9, 
   3.7900732826496153`*^9}, {3.7944212985842657`*^9, 3.794421319186738*^9}, {
   3.808821168892788*^9, 3.808821272802003*^9}, {3.809018248734056*^9, 
   3.809018290822826*^9}, {3.8260132046779737`*^9, 3.826013204683711*^9}, {
   3.827648564072098*^9, 3.827648615048443*^9}, {3.82764865204148*^9, 
   3.827648672586391*^9}, {3.827648750905102*^9, 3.827648765833303*^9}, 
   3.827648875477606*^9, 3.827648961114952*^9, 3.8276490709672117`*^9, {
   3.827649117687273*^9, 3.827649185510355*^9}, {3.827649784750478*^9, 
   3.827649823023651*^9}, {3.8276566798198023`*^9, 3.8276566876196527`*^9}, {
   3.886680887642663*^9, 3.886681037658252*^9}, 3.886681069034561*^9, 
   3.886681171579316*^9, {3.886681383115823*^9, 3.886681383820056*^9}, {
   3.886681620748932*^9, 
   3.886681735197673*^9}},ExpressionUUID->"820ae879-4e22-41b5-a307-\
6ff0b2a78855"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Code to produce plots of the gene", "Subsubsection",
 CellChangeTimes->{{3.886835941080385*^9, 
  3.88683595346307*^9}},ExpressionUUID->"3bb3718d-cec1-4014-8109-\
2b7e8a0e0bd8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CBOrange", "=", 
   RowBox[{"RGBColor", "[", 
    RowBox[{
     RowBox[{"230", "/", "255"}], ",", 
     RowBox[{"159", "/", "255"}], ",", "0"}], "]"}]}], ";", 
  RowBox[{"CBSkyBlue", "=", 
   RowBox[{"RGBColor", "[", 
    RowBox[{
     RowBox[{"86", "/", "255"}], ",", 
     RowBox[{"180", "/", "255"}], ",", 
     RowBox[{"233", "/", "255"}]}], "]"}]}], ";", 
  RowBox[{"CBBlue", "=", 
   RowBox[{"RGBColor", "[", 
    RowBox[{"0", ",", 
     RowBox[{"114", "/", "255"}], ",", 
     RowBox[{"178", "/", "255"}]}], "]"}]}], ";", 
  RowBox[{"CBVermillion", "=", 
   RowBox[{"RGBColor", "[", 
    RowBox[{
     RowBox[{"213", "/", "255"}], ",", 
     RowBox[{"94", "/", "255"}], ",", "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "A", " ", "palette", " ", "suitable", " ", "for", " ", "colour", " ", 
    "blind", " ", "readers"}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.808813420174871*^9, 3.808813428206955*^9}, {
  3.8088135029675913`*^9, 3.808813639987836*^9}, {3.808829733116476*^9, 
  3.808829756030501*^9}, {3.886836121912182*^9, 
  3.886836155128626*^9}},ExpressionUUID->"ef13e217-9655-4a21-ab83-\
6d6877c6810f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"ListPlot", ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "20"}]}], "}"}]}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.789809285744343*^9, 3.789809307572454*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"fa202d21-d2a1-4d7b-898a-27419dbf102a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ListPlot", "[", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], "]"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Causes", " ", "the", " ", "plot", " ", "markers", " ", "to", " ", 
    "load"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{3.896867979140922*^9, 
  3.896868154286388*^9},ExpressionUUID->"d4da0f3e-37ff-4f0f-aad0-\
02e5e054bfe0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"solidCircle", "=", 
   RowBox[{
    RowBox[{"Charting`CommonDump`GraphicsPlotMarkers", "[", "]"}], 
    "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
  RowBox[{"solidCircleSize", "=", 
   RowBox[{
    RowBox[{"Charting`CommonDump`GraphicsPlotMarkers", "[", "]"}], 
    "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
  RowBox[{"openTriangle", "=", 
   RowBox[{
    RowBox[{"Charting`CommonDump`GraphicsPlotMarkers", "[", "]"}], 
    "\[LeftDoubleBracket]", 
    RowBox[{"9", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
  RowBox[{"openTriangleSize", "=", 
   RowBox[{
    RowBox[{"Charting`CommonDump`GraphicsPlotMarkers", "[", "]"}], 
    "\[LeftDoubleBracket]", 
    RowBox[{"9", ",", "2"}], "\[RightDoubleBracket]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.896199635066822*^9, 3.896199693644208*^9}, {
  3.896199757303576*^9, 3.896199766355349*^9}, {3.896199816805702*^9, 
  3.8961998238251123`*^9}},ExpressionUUID->"4c50b9b1-bd28-4256-99d4-\
dc5f3af811c1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"plotpadding", "=", "1.03"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Extra", " ", "padding", " ", "around", " ", "plot", " ", "to", " ", 
     "ensure", " ", "dots", " ", "are", " ", "fully", " ", "plotted"}], ";", 
    " ", 
    RowBox[{
    "set", " ", "to", " ", "1", " ", "to", " ", "have", " ", "no", " ", 
     "padding"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.857626049626576*^9, 3.857626054735208*^9}, {
  3.8576265371004953`*^9, 3.857626556956785*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"54b2369d-721e-45ea-a213-3ad9b659c2fa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"whichCalculations", "\[LeftDoubleBracket]", 
      RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"nPDGraph", "[", 
        RowBox[{
         RowBox[{"highgapprop_", ":", "0.1"}], ",", "marginal_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"sigdescentsmarginal", "=", 
            RowBox[{
             RowBox[{"CalculatePDUnifiedDescent", "[", "highgapprop", "]"}], 
             "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ",", 
           RowBox[{"sigdescents", "=", 
            RowBox[{
             RowBox[{
             "CalculatePDUnifiedDescentNoUnmaskedRegions", "[", "highgapprop",
               "]"}], "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ",", 
           RowBox[{"revlist", "=", 
            RowBox[{
             RowBox[{"N", "[", 
              RowBox[{"nPDsGapsSuppressed", "[", "highgapprop", "]"}], "]"}], 
             "/.", 
             RowBox[{"(", 
              RowBox[{"\"\<Uninform\>\"", "\[Rule]", "1"}], ")"}]}]}]}], " ", 
          
          RowBox[{"(*", " ", 
           RowBox[{
           "nPD", " ", "list", " ", "with", " ", "uninformative", " ", "site",
             " ", "nPD", " ", "set", " ", "to", " ", "1", " ", "at", " ", 
            "this", " ", "point"}], " ", "*)"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", "revlist", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{"nPDsGapsSuppressed", "[", "highgapprop", "]"}], 
                    "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], 
                    "]"}]}], "}"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "a_", ",", "b_", ",", "True", ",", "d_", ",", "True"}], 
                   "}"}], "->", 
                  RowBox[{"{", 
                   RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Missing", "[", "]"}], ",", 
                 RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", "revlist", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{"nPDsGapsSuppressed", "[", "highgapprop", "]"}], 
                    "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], 
                    "]"}]}], "}"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "a_", ",", "b_", ",", "False", ",", "True", ",", "True"}], 
                   "}"}], "->", 
                  RowBox[{"{", 
                   RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Missing", "[", "]"}], ",", 
                 RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", "revlist", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{"nPDsGapsSuppressed", "[", "highgapprop", "]"}], 
                    "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], 
                    "]"}]}], "}"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "a_", ",", "b_", ",", "False", ",", "False", ",", "True"}],
                    "}"}], "->", 
                  RowBox[{"{", 
                   RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Missing", "[", "]"}], ",", 
                 RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", "revlist", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{"nPDsGapsSuppressed", "[", "highgapprop", "]"}], 
                    "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], 
                    "]"}]}], "}"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "a_", ",", "b_", ",", "True", ",", "d_", ",", "False"}], 
                   "}"}], "->", 
                  RowBox[{"{", 
                   RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Missing", "[", "]"}], ",", 
                 RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", "revlist", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{"nPDsGapsSuppressed", "[", "highgapprop", "]"}], 
                    "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], 
                    "]"}]}], "}"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "a_", ",", "b_", ",", "False", ",", "True", ",", "False"}],
                    "}"}], "->", 
                  RowBox[{"{", 
                   RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Missing", "[", "]"}], ",", 
                 RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", "revlist", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{"nPDsGapsSuppressed", "[", "highgapprop", "]"}], 
                    "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], 
                    "]"}]}], "}"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "a_", ",", "b_", ",", "False", ",", "False", ",", 
                    "False"}], "}"}], "->", 
                  RowBox[{"{", 
                   RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Missing", "[", "]"}], ",", 
                 RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}]}], "}"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"PlotMarkers", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"openTriangle", ",", "openTriangleSize"}], "}"}], ",", 
              
              RowBox[{"{", 
               RowBox[{"openTriangle", ",", "openTriangleSize"}], "}"}], ",", 
              
              RowBox[{"{", 
               RowBox[{"openTriangle", ",", "openTriangleSize"}], "}"}], ",", 
              
              RowBox[{"{", 
               RowBox[{"solidCircle", ",", "solidCircleSize"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"solidCircle", ",", "solidCircleSize"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"solidCircle", ",", "solidCircleSize"}], "}"}]}], 
             "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"CBOrange", ",", 
              RowBox[{"If", "[", 
               RowBox[{"marginal", ",", "CBSkyBlue", ",", "Gray"}], "]"}], 
              ",", "Gray", ",", "CBVermillion", ",", 
              RowBox[{"If", "[", 
               RowBox[{"marginal", ",", "CBBlue", ",", "Black"}], "]"}], ",", 
              "Black"}], "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Mesh", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{"i", ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", 
                  RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}], 
              ",", 
              RowBox[{"{", "}"}]}], "}"}]}], ",", 
           RowBox[{"MeshStyle", "\[Rule]", "Gray"}], ",", 
           RowBox[{"MeshShading", "\[Rule]", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                "CBOrange", ",", "None"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}]}], 
           ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Frame", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"True", ",", "False"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "\"\<actual/expected pairwise distance\>\"", ",", "None"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<amino acid position in alignment\>\"", ",", "None"}], 
               "}"}]}], "}"}]}], ",", 
           RowBox[{"FrameTicks", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"True", ",", "False"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"plotpadding", "*", 
                 RowBox[{"Length", "[", "revlist", "]"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"Min", "[", "revlist", "]"}], "-", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"plotpadding", "-", "1"}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Max", "[", "revlist", "]"}], "-", 
                    RowBox[{"Min", "[", "revlist", "]"}]}], ")"}]}], ")"}]}], 
                ",", 
                RowBox[{
                 RowBox[{"Max", "[", "revlist", "]"}], "+", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"plotpadding", "-", "1"}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Max", "[", "revlist", "]"}], "-", 
                    RowBox[{"Min", "[", "revlist", "]"}]}], ")"}]}], 
                  ")"}]}]}], "}"}]}], "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
           RowBox[{"PlotRangeClipping", "\[Rule]", "False"}]}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "General", " ", "strategy", " ", "in", " ", "setting", " ", "up", " ",
          "the", " ", "plot", " ", "to", " ", "allow", " ", "different", " ", 
         "symbols", " ", "and", " ", "colours", " ", "is", " ", "to", " ", 
         "partition", " ", "the", " ", "loci", " ", "into", " ", "the", " ", 
         "different", " ", "categories", " ", "and", " ", "set", " ", "them", 
         " ", "up", " ", "as", " ", "separate", " ", "lists", " ", "to", " ", 
         "plot"}], ";", " ", 
        RowBox[{
        "appending", " ", "the", " ", "\"\<Missing[]\>\"", " ", "data", " ", 
         "allows", " ", "for", " ", "the", " ", "possibility", " ", "that", 
         " ", "a", " ", "category", " ", "is", " ", "empty"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PDCumuGraph", "[", 
        RowBox[{
         RowBox[{"highgapprop_", ":", "0.1"}], ",", "marginal_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"sigdescentsmarginal", "=", 
            RowBox[{
             RowBox[{"CalculatePDUnifiedDescent", "[", "highgapprop", "]"}], 
             "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ",", 
           RowBox[{"sigdescents", "=", 
            RowBox[{
             RowBox[{
             "CalculatePDUnifiedDescentNoUnmaskedRegions", "[", "highgapprop",
               "]"}], "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ",", "len",
            ",", "\[IndentingNewLine]", 
           RowBox[{"revlist", "=", 
            RowBox[{
             RowBox[{"nPDsGapsSuppressed", "[", "highgapprop", "]"}], "/.", 
             RowBox[{"(", 
              RowBox[{"\"\<Uninform\>\"", "\[Rule]", "0"}], ")"}]}]}], " ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "nPD", " ", "list", " ", "with", " ", "uninformative", " ", 
             "site", " ", "nMPD", " ", "set", " ", "to", " ", "zero", " ", 
             "at", " ", "this", " ", "point"}], " ", "*)"}], ",", 
           RowBox[{"numuninform", "=", 
            RowBox[{"Count", "[", 
             RowBox[{
              RowBox[{"nPDsGapsSuppressed", "[", "highgapprop", "]"}], ",", 
              "\"\<Uninform\>\""}], "]"}]}], " ", 
           RowBox[{"(*", " ", 
            RowBox[{"Number", " ", "of", " ", "uninformative", " ", "sites"}],
             " ", "*)"}], ",", "\[IndentingNewLine]", "listmean", ",", 
           "\[IndentingNewLine]", "listsd", ",", "\[IndentingNewLine]", 
           "temp", ",", "\[IndentingNewLine]", "walk"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"len", "=", 
           RowBox[{
            RowBox[{"Length", "[", "revlist", "]"}], "-", "numuninform"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"listmean", "=", 
           RowBox[{
            RowBox[{"N", "[", 
             RowBox[{"Total", "[", "revlist", "]"}], "]"}], "/", "len"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"temp", "=", 
           RowBox[{"N", "[", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{
              RowBox[{"nPDsGapsSuppressed", "[", "highgapprop", "]"}], ",", 
              RowBox[{"a_", "/;", 
               RowBox[{"a", "\[Equal]", "\"\<Uninform\>\""}]}]}], "]"}], " ", 
            "]"}]}], 
          RowBox[{"(*", " ", 
           RowBox[{
           "Make", " ", "a", " ", "version", " ", "of", " ", "the", " ", 
            "original", " ", "nMPD", " ", "list", " ", "with", " ", "no", " ",
             "uninformative", " ", "sites", " ", "and", " ", "use", " ", 
            "this", " ", "to", " ", "calculate", " ", "the", " ", "standard", 
            " ", "deviation"}], " ", "*)"}], ";", "\[IndentingNewLine]", 
          RowBox[{"listsd", "=", 
           SqrtBox[
            RowBox[{"Mean", "[", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"temp", "-", "listmean"}], ")"}], "2"], "]"}]]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"revlist", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"N", "[", 
                 RowBox[{
                  RowBox[{"nPDsGapsSuppressed", "[", "highgapprop", "]"}], 
                  "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                 "]"}], "\[Equal]", "\"\<Uninform\>\""}], ",", "0", ",", 
               FractionBox[
                RowBox[{
                 RowBox[{"N", "[", 
                  RowBox[{
                   RowBox[{"nPDsGapsSuppressed", "[", "highgapprop", "]"}], 
                   "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                  "]"}], "-", "listmean"}], "listsd"]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"nPDsGapsSuppressed", "[", "highgapprop", "]"}], 
                "]"}]}], "}"}]}], "]"}]}], " ", ";", "\[IndentingNewLine]", 
          RowBox[{"walk", "=", 
           RowBox[{"Accumulate", "[", "revlist", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"Cases", "[", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", "walk", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{"nPDsGapsSuppressed", "[", "highgapprop", "]"}], 
                    "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}]}], 
                    "}"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "a_", ",", "b_", ",", "True", ",", "d_", ",", "True"}], 
                    "}"}], "->", 
                   RowBox[{"{", 
                    RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Missing", "[", "]"}], ",", 
                  RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"Cases", "[", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", "walk", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{"nPDsGapsSuppressed", "[", "highgapprop", "]"}], 
                    "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}]}], 
                    "}"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "a_", ",", "b_", ",", "False", ",", "True", ",", "True"}],
                     "}"}], "->", 
                   RowBox[{"{", 
                    RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Missing", "[", "]"}], ",", 
                  RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}], ",", 
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"Cases", "[", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", "walk", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{"nPDsGapsSuppressed", "[", "highgapprop", "]"}], 
                    "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}]}], 
                    "}"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "a_", ",", "b_", ",", "False", ",", "False", ",", 
                    "True"}], "}"}], "->", 
                   RowBox[{"{", 
                    RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Missing", "[", "]"}], ",", 
                  RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}], ",", 
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"Cases", "[", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", "walk", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{"nPDsGapsSuppressed", "[", "highgapprop", "]"}], 
                    "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}]}], 
                    "}"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "a_", ",", "b_", ",", "True", ",", "d_", ",", "False"}], 
                    "}"}], "->", 
                   RowBox[{"{", 
                    RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Missing", "[", "]"}], ",", 
                  RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}], ",", 
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"Cases", "[", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", "walk", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{"nPDsGapsSuppressed", "[", "highgapprop", "]"}], 
                    "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}]}], 
                    "}"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "a_", ",", "b_", ",", "False", ",", "True", ",", 
                    "False"}], "}"}], "->", 
                   RowBox[{"{", 
                    RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Missing", "[", "]"}], ",", 
                  RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}], ",", 
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"Cases", "[", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", "walk", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{"nPDsGapsSuppressed", "[", "highgapprop", "]"}], 
                    "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}]}], 
                    "}"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "a_", ",", "b_", ",", "False", ",", "False", ",", 
                    "False"}], "}"}], "->", 
                   RowBox[{"{", 
                    RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Missing", "[", "]"}], ",", 
                  RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}]}], "}"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"PlotMarkers", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"openTriangle", ",", "openTriangleSize"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"openTriangle", ",", "openTriangleSize"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"openTriangle", ",", "openTriangleSize"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"solidCircle", ",", "solidCircleSize"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"solidCircle", ",", "solidCircleSize"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"solidCircle", ",", "solidCircleSize"}], "}"}]}], 
              "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"CBOrange", ",", 
               RowBox[{"If", "[", 
                RowBox[{"marginal", ",", "CBSkyBlue", ",", "Gray"}], "]"}], 
               ",", "Gray", ",", "CBVermillion", ",", 
               RowBox[{"If", "[", 
                RowBox[{"marginal", ",", "CBBlue", ",", "Black"}], "]"}], ",",
                "Black"}], "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Mesh", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{"i", ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", 
                   RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}], 
               ",", 
               RowBox[{"{", "}"}]}], "}"}]}], ",", 
            RowBox[{"MeshStyle", "\[Rule]", "Gray"}], ",", 
            RowBox[{"MeshShading", "\[Rule]", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"MemberQ", "[", 
                  RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                 "CBOrange", ",", "None"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}]}], 
            ",", 
            RowBox[{"Axes", "\[Rule]", "False"}], ",", 
            RowBox[{"Frame", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"True", ",", "False"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
            RowBox[{"FrameLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Column", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<cumulative sum of actual/expected\>\"", ",", 
                    "\"\<pairwise distance (normalised)\>\""}], "}"}], ",", 
                   "Center"}], "]"}], ",", "None"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<amino acid position in alignment\>\"", ",", "None"}], 
                "}"}]}], "}"}]}], ",", 
            RowBox[{"FrameTicks", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"True", ",", "False"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"plotpadding", "*", 
                  RowBox[{"Length", "[", "revlist", "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Min", "[", "walk", "]"}], "-", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"plotpadding", "-", "1"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Max", "[", "walk", "]"}], "-", 
                    RowBox[{"Min", "[", "walk", "]"}]}], ")"}]}], ")"}]}], 
                 ",", 
                 RowBox[{
                  RowBox[{"Max", "[", "walk", "]"}], "+", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"plotpadding", "-", "1"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Max", "[", "walk", "]"}], "-", 
                    RowBox[{"Min", "[", "walk", "]"}]}], ")"}]}], ")"}]}]}], 
                "}"}]}], "}"}]}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
            RowBox[{"PlotRangeClipping", "\[Rule]", "False"}]}], "]"}]}]}], 
        "]"}]}], ";"}]}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "General", " ", "strategy", " ", "in", " ", "setting", " ", "up", " ", 
       "the", " ", "plot", " ", "to", " ", "allow", " ", "different", " ", 
       "symbols", " ", "and", " ", "colours", " ", "is", " ", "to", " ", 
       "partition", " ", "the", " ", "loci", " ", "into", " ", "the", " ", 
       "different", " ", "categories", " ", "and", " ", "set", " ", "them", 
       " ", "up", " ", "as", " ", "separate", " ", "lists", " ", "to", " ", 
       "plot"}], ";", " ", 
      RowBox[{
      "appending", " ", "the", " ", "\"\<Missing[]\>\"", " ", "data", " ", 
       "allows", " ", "for", " ", "the", " ", "possibility", " ", "that", " ",
        "a", " ", "category", " ", "is", " ", "empty"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"whichCalculations", "\[LeftDoubleBracket]", 
      RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"nPDGraphRank", "[", 
        RowBox[{
         RowBox[{"highgapprop_", ":", "0.1"}], ",", "marginal_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"sigdescentsmarginal", "=", 
            RowBox[{
             RowBox[{"CalculatePDUnifiedDescent", "[", "highgapprop", "]"}], 
             "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], ",", 
           RowBox[{"sigdescents", "=", 
            RowBox[{
             RowBox[{
             "CalculatePDUnifiedDescentNoUnmaskedRegions", "[", "highgapprop",
               "]"}], "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], ",", 
           RowBox[{"revlist", "=", 
            RowBox[{
             RowBox[{"rank", "[", 
              RowBox[{"N", "[", 
               RowBox[{"nPDsGapsSuppressed", "[", "highgapprop", "]"}], "]"}],
               "]"}], "/.", 
             RowBox[{"(", 
              RowBox[{"\"\<Uninform\>\"", "\[Rule]", "0"}], ")"}]}]}]}], " ", 
          
          RowBox[{"(*", " ", 
           RowBox[{
           "nPD", " ", "list", " ", "with", " ", "uninformative", " ", "site",
             " ", "nPD", " ", "set", " ", "to", " ", "0", " ", "at", " ", 
            "this", " ", "point"}], " ", "*)"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", "revlist", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{"nPDsGapsSuppressed", "[", "highgapprop", "]"}], 
                    "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], 
                    "]"}]}], "}"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "a_", ",", "b_", ",", "True", ",", "d_", ",", "True"}], 
                   "}"}], "->", 
                  RowBox[{"{", 
                   RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Missing", "[", "]"}], ",", 
                 RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", "revlist", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{"nPDsGapsSuppressed", "[", "highgapprop", "]"}], 
                    "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], 
                    "]"}]}], "}"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "a_", ",", "b_", ",", "False", ",", "True", ",", "True"}], 
                   "}"}], "->", 
                  RowBox[{"{", 
                   RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Missing", "[", "]"}], ",", 
                 RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", "revlist", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{"nPDsGapsSuppressed", "[", "highgapprop", "]"}], 
                    "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], 
                    "]"}]}], "}"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "a_", ",", "b_", ",", "False", ",", "False", ",", "True"}],
                    "}"}], "->", 
                  RowBox[{"{", 
                   RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Missing", "[", "]"}], ",", 
                 RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", "revlist", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{"nPDsGapsSuppressed", "[", "highgapprop", "]"}], 
                    "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], 
                    "]"}]}], "}"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "a_", ",", "b_", ",", "True", ",", "d_", ",", "False"}], 
                   "}"}], "->", 
                  RowBox[{"{", 
                   RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Missing", "[", "]"}], ",", 
                 RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", "revlist", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{"nPDsGapsSuppressed", "[", "highgapprop", "]"}], 
                    "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], 
                    "]"}]}], "}"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "a_", ",", "b_", ",", "False", ",", "True", ",", "False"}],
                    "}"}], "->", 
                  RowBox[{"{", 
                   RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Missing", "[", "]"}], ",", 
                 RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", "revlist", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{"nPDsGapsSuppressed", "[", "highgapprop", "]"}], 
                    "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], 
                    "]"}]}], "}"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "a_", ",", "b_", ",", "False", ",", "False", ",", 
                    "False"}], "}"}], "->", 
                  RowBox[{"{", 
                   RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Missing", "[", "]"}], ",", 
                 RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}]}], "}"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"PlotMarkers", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"openTriangle", ",", "openTriangleSize"}], "}"}], ",", 
              
              RowBox[{"{", 
               RowBox[{"openTriangle", ",", "openTriangleSize"}], "}"}], ",", 
              
              RowBox[{"{", 
               RowBox[{"openTriangle", ",", "openTriangleSize"}], "}"}], ",", 
              
              RowBox[{"{", 
               RowBox[{"solidCircle", ",", "solidCircleSize"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"solidCircle", ",", "solidCircleSize"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"solidCircle", ",", "solidCircleSize"}], "}"}]}], 
             "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"CBOrange", ",", 
              RowBox[{"If", "[", 
               RowBox[{"marginal", ",", "CBSkyBlue", ",", "Gray"}], "]"}], 
              ",", "Gray", ",", "CBVermillion", ",", 
              RowBox[{"If", "[", 
               RowBox[{"marginal", ",", "CBBlue", ",", "Black"}], "]"}], ",", 
              "Black"}], "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Mesh", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{"i", ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", 
                  RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}], 
              ",", 
              RowBox[{"{", "}"}]}], "}"}]}], ",", 
           RowBox[{"MeshStyle", "\[Rule]", "Gray"}], ",", 
           RowBox[{"MeshShading", "\[Rule]", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                "CBOrange", ",", "None"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}]}], 
           ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Frame", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"True", ",", "False"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "\"\<ranked actual/expected pairwise distance\>\"", ",", 
                "None"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<amino acid position in alignment\>\"", ",", "None"}], 
               "}"}]}], "}"}]}], ",", 
           RowBox[{"FrameTicks", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"True", ",", "False"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"plotpadding", "*", 
                 RowBox[{"Length", "[", "revlist", "]"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"Min", "[", "revlist", "]"}], "-", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"plotpadding", "-", "1"}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Max", "[", "revlist", "]"}], "-", 
                    RowBox[{"Min", "[", "revlist", "]"}]}], ")"}]}], ")"}]}], 
                ",", 
                RowBox[{
                 RowBox[{"Max", "[", "revlist", "]"}], "+", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"plotpadding", "-", "1"}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Max", "[", "revlist", "]"}], "-", 
                    RowBox[{"Min", "[", "revlist", "]"}]}], ")"}]}], 
                  ")"}]}]}], "}"}]}], "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
           RowBox[{"PlotRangeClipping", "\[Rule]", "False"}]}], "]"}]}], 
        "]"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "General", " ", "strategy", " ", "in", " ", "setting", " ", "up", " ",
          "the", " ", "plot", " ", "to", " ", "allow", " ", "different", " ", 
         "symbols", " ", "and", " ", "colours", " ", "is", " ", "to", " ", 
         "partition", " ", "the", " ", "loci", " ", "into", " ", "the", " ", 
         "different", " ", "categories", " ", "and", " ", "set", " ", "them", 
         " ", "up", " ", "as", " ", "separate", " ", "lists", " ", "to", " ", 
         "plot"}], ";", " ", 
        RowBox[{
        "appending", " ", "the", " ", "\"\<Missing[]\>\"", " ", "data", " ", 
         "allows", " ", "for", " ", "the", " ", "possibility", " ", "that", 
         " ", "a", " ", "category", " ", "is", " ", "empty"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PDCumuGraphRank", "[", 
        RowBox[{
         RowBox[{"highgapprop_", ":", "0.1"}], ",", "marginal_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"sigdescentsmarginal", "=", 
            RowBox[{
             RowBox[{"CalculatePDUnifiedDescent", "[", "highgapprop", "]"}], 
             "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], ",", 
           RowBox[{"sigdescents", "=", 
            RowBox[{
             RowBox[{
             "CalculatePDUnifiedDescentNoUnmaskedRegions", "[", "highgapprop",
               "]"}], "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], ",", "len",
            ",", "\[IndentingNewLine]", 
           RowBox[{"revlist", "=", 
            RowBox[{
             RowBox[{"rank", "[", 
              RowBox[{"N", "[", 
               RowBox[{"nPDsGapsSuppressed", "[", "highgapprop", "]"}], "]"}],
               "]"}], "/.", 
             RowBox[{"(", 
              RowBox[{"\"\<Uninform\>\"", "\[Rule]", "0"}], ")"}]}]}], 
           RowBox[{"(*", " ", 
            RowBox[{
            "nPD", " ", "list", " ", "with", " ", "uninformative", " ", 
             "site", " ", "nMPD", " ", "set", " ", "to", " ", "zero", " ", 
             "at", " ", "this", " ", "point"}], " ", "*)"}], ",", 
           RowBox[{"numuninform", "=", 
            RowBox[{"Count", "[", 
             RowBox[{
              RowBox[{"nPDsGapsSuppressed", "[", "highgapprop", "]"}], ",", 
              "\"\<Uninform\>\""}], "]"}]}], " ", 
           RowBox[{"(*", " ", 
            RowBox[{"Number", " ", "of", " ", "uninformative", " ", "sites"}],
             " ", "*)"}], ",", "\[IndentingNewLine]", "listmean", ",", 
           "\[IndentingNewLine]", "listsd", ",", "\[IndentingNewLine]", 
           "temp", ",", "\[IndentingNewLine]", "walk"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"len", "=", 
           RowBox[{
            RowBox[{"Length", "[", "revlist", "]"}], "-", "numuninform"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"listmean", "=", 
           RowBox[{
            RowBox[{"N", "[", 
             RowBox[{"Total", "[", "revlist", "]"}], "]"}], "/", "len"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"temp", "=", 
           RowBox[{"N", "[", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{
              RowBox[{"rank", "[", 
               RowBox[{"nPDsGapsSuppressed", "[", "highgapprop", "]"}], "]"}],
               ",", 
              RowBox[{"a_", "/;", 
               RowBox[{"a", "\[Equal]", "\"\<Uninform\>\""}]}]}], "]"}], " ", 
            "]"}]}], 
          RowBox[{"(*", " ", 
           RowBox[{
           "Make", " ", "a", " ", "version", " ", "of", " ", "the", " ", 
            "original", " ", "nMPD", " ", "list", " ", "with", " ", "no", " ",
             "uninformative", " ", "sites", " ", "and", " ", "use", " ", 
            "this", " ", "to", " ", "calculate", " ", "the", " ", "standard", 
            " ", "deviation"}], " ", "*)"}], ";", "\[IndentingNewLine]", 
          RowBox[{"listsd", "=", 
           SqrtBox[
            RowBox[{"Mean", "[", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"temp", "-", "listmean"}], ")"}], "2"], "]"}]]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"revlist", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"N", "[", 
                 RowBox[{
                  RowBox[{"nPDsGapsSuppressed", "[", "highgapprop", "]"}], 
                  "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                 "]"}], "\[Equal]", "\"\<Uninform\>\""}], ",", "0", ",", 
               FractionBox[
                RowBox[{
                 RowBox[{"N", "[", 
                  RowBox[{
                   RowBox[{"rank", "[", 
                    RowBox[{"nPDsGapsSuppressed", "[", "highgapprop", "]"}], 
                    "]"}], "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], "]"}], "-", "listmean"}], 
                "listsd"]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"nPDsGapsSuppressed", "[", "highgapprop", "]"}], 
                "]"}]}], "}"}]}], "]"}]}], " ", ";", "\[IndentingNewLine]", 
          RowBox[{"walk", "=", 
           RowBox[{"Accumulate", "[", "revlist", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"Cases", "[", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", "walk", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{
                    "shannonScaledRankednPDsGapsSuppressed", "[", 
                    "highgapprop", "]"}], "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}]}], 
                    "}"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "a_", ",", "b_", ",", "True", ",", "d_", ",", "True"}], 
                    "}"}], "->", 
                   RowBox[{"{", 
                    RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Missing", "[", "]"}], ",", 
                  RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"Cases", "[", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", "walk", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{
                    "shannonScaledRankednPDsGapsSuppressed", "[", 
                    "highgapprop", "]"}], "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}]}], 
                    "}"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "a_", ",", "b_", ",", "False", ",", "True", ",", "True"}],
                     "}"}], "->", 
                   RowBox[{"{", 
                    RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Missing", "[", "]"}], ",", 
                  RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}], ",", 
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"Cases", "[", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", "walk", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{
                    "shannonScaledRankednPDsGapsSuppressed", "[", 
                    "highgapprop", "]"}], "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}]}], 
                    "}"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "a_", ",", "b_", ",", "False", ",", "False", ",", 
                    "True"}], "}"}], "->", 
                   RowBox[{"{", 
                    RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Missing", "[", "]"}], ",", 
                  RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}], ",", 
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"Cases", "[", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", "walk", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{
                    "shannonScaledRankednPDsGapsSuppressed", "[", 
                    "highgapprop", "]"}], "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}]}], 
                    "}"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "a_", ",", "b_", ",", "True", ",", "d_", ",", "False"}], 
                    "}"}], "->", 
                   RowBox[{"{", 
                    RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Missing", "[", "]"}], ",", 
                  RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}], ",", 
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"Cases", "[", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", "walk", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{
                    "shannonScaledRankednPDsGapsSuppressed", "[", 
                    "highgapprop", "]"}], "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}]}], 
                    "}"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "a_", ",", "b_", ",", "False", ",", "True", ",", 
                    "False"}], "}"}], "->", 
                   RowBox[{"{", 
                    RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Missing", "[", "]"}], ",", 
                  RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}], ",", 
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"Cases", "[", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", "walk", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{
                    "shannonScaledRankednPDsGapsSuppressed", "[", 
                    "highgapprop", "]"}], "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}]}], 
                    "}"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "a_", ",", "b_", ",", "False", ",", "False", ",", 
                    "False"}], "}"}], "->", 
                   RowBox[{"{", 
                    RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Missing", "[", "]"}], ",", 
                  RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}]}], "}"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"PlotMarkers", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"openTriangle", ",", "openTriangleSize"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"openTriangle", ",", "openTriangleSize"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"openTriangle", ",", "openTriangleSize"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"solidCircle", ",", "solidCircleSize"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"solidCircle", ",", "solidCircleSize"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"solidCircle", ",", "solidCircleSize"}], "}"}]}], 
              "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"CBOrange", ",", 
               RowBox[{"If", "[", 
                RowBox[{"marginal", ",", "CBSkyBlue", ",", "Gray"}], "]"}], 
               ",", "Gray", ",", "CBVermillion", ",", 
               RowBox[{"If", "[", 
                RowBox[{"marginal", ",", "CBBlue", ",", "Black"}], "]"}], ",",
                "Black"}], "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Mesh", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{"i", ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", 
                   RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}], 
               ",", 
               RowBox[{"{", "}"}]}], "}"}]}], ",", 
            RowBox[{"MeshStyle", "\[Rule]", "Gray"}], ",", 
            RowBox[{"MeshShading", "\[Rule]", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"MemberQ", "[", 
                  RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                 "CBOrange", ",", "None"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}]}], 
            ",", 
            RowBox[{"Axes", "\[Rule]", "False"}], ",", 
            RowBox[{"Frame", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"True", ",", "False"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
            RowBox[{"FrameLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Column", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<cumulative sum of ranked actual/expected\>\"", ",", 
                    "\"\<pairwise distance (normalised)\>\""}], "}"}], ",", 
                   "Center"}], "]"}], ",", "None"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<amino acid position in alignment\>\"", ",", "None"}], 
                "}"}]}], "}"}]}], ",", 
            RowBox[{"FrameTicks", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"True", ",", "False"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"plotpadding", "*", 
                  RowBox[{"Length", "[", "revlist", "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Min", "[", "walk", "]"}], "-", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"plotpadding", "-", "1"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Max", "[", "walk", "]"}], "-", 
                    RowBox[{"Min", "[", "walk", "]"}]}], ")"}]}], ")"}]}], 
                 ",", 
                 RowBox[{
                  RowBox[{"Max", "[", "walk", "]"}], "+", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"plotpadding", "-", "1"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Max", "[", "walk", "]"}], "-", 
                    RowBox[{"Min", "[", "walk", "]"}]}], ")"}]}], ")"}]}]}], 
                "}"}]}], "}"}]}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
            RowBox[{"PlotRangeClipping", "\[Rule]", "False"}]}], "]"}]}]}], 
        "]"}]}], ";"}]}], 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "General", " ", "strategy", " ", "in", " ", "setting", " ", "up", " ", 
       "the", " ", "plot", " ", "to", " ", "allow", " ", "different", " ", 
       "symbols", " ", "and", " ", "colours", " ", "is", " ", "to", " ", 
       "partition", " ", "the", " ", "loci", " ", "into", " ", "the", " ", 
       "different", " ", "categories", " ", "and", " ", "set", " ", "them", 
       " ", "up", " ", "as", " ", "separate", " ", "lists", " ", "to", " ", 
       "plot"}], ";", " ", 
      RowBox[{
      "appending", " ", "the", " ", "\"\<Missing[]\>\"", " ", "data", " ", 
       "allows", " ", "for", " ", "the", " ", "possibility", " ", "that", " ",
        "a", " ", "category", " ", "is", " ", "empty"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"shannonScalednPDsInformative", "[", "highgapproportion_", "]"}], 
    ":=", 
    RowBox[{
     RowBox[{"shannonScalednPDsInformative", "[", "highgapproportion", "]"}], 
     "=", "\[IndentingNewLine]", 
     RowBox[{"N", "[", 
      RowBox[{"wnorm", "[", 
       RowBox[{
        RowBox[{"N", "[", 
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"nPDsGapsSuppressed", "[", "highgapproportion", "]"}], ",", 
           RowBox[{"Except", "[", "\"\<Uninform\>\"", "]"}]}], "]"}], "]"}], 
        ",", 
        RowBox[{"N", "[", 
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{
             "shannonInformationGapsSuppressed", "[", "highgapproportion", 
              "]"}], ",", 
             RowBox[{"Except", "[", "0", "]"}]}], "]"}], ",", 
           RowBox[{"Except", "[", "0.", "]"}]}], "]"}], "]"}]}], "]"}], 
      "]"}]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "shannonScalednPDsGapsSuppressed", "[", "highgapproportion_", "]"}], ":=", 
   
   RowBox[{
    RowBox[{
    "shannonScalednPDsGapsSuppressed", "[", "highgapproportion", "]"}], "=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"SetSharedVariable", "[", "currentPos", "]"}], ";", 
      RowBox[{"currentPos", "=", 
       RowBox[{"{", "0", "}"}]}], ";", 
      RowBox[{
      "PrintTemporary", "[", "\"\<Current positions in calculation:\>\"", 
       "]"}], ";", "\[IndentingNewLine]", " ", 
      RowBox[{"PrintTemporary", "@", 
       RowBox[{"Dynamic", "[", "currentPos", "]"}]}], ";", 
      RowBox[{"totaluninform", "=", "0"}], ";", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"currentPos", "=", 
          RowBox[{"{", "i", "}"}]}], ";", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nPDsGapsSuppressed", "[", "highgapproportion", "]"}], 
             "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            "\[Equal]", "\"\<Uninform\>\""}], ",", 
           RowBox[{
            RowBox[{"totaluninform", "++"}], ";", "\"\<Uninform\>\""}], ",", 
           RowBox[{
            RowBox[{
            "shannonScalednPDsInformative", "[", "highgapproportion", "]"}], 
            "\[LeftDoubleBracket]", 
            RowBox[{"i", "-", "totaluninform"}], "\[RightDoubleBracket]"}]}], 
          "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "codondistributionsbylocation", "]"}]}], 
         "}"}]}], "]"}]}], ")"}]}]}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Cannot", " ", "parallelise"}], ",", " ", 
    RowBox[{
    "in", " ", "order", " ", "to", " ", "keep", " ", "a", " ", "tally", " ", 
     "of", " ", "where", " ", "we", " ", "are", " ", "with", " ", 
     "uninformative", " ", "points"}]}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
    "shannonInformationScaledInformative", "[", "highgapproportion_", "]"}], ":=", 
    RowBox[{
     RowBox[{
     "shannonInformationScaledInformative", "[", "highgapproportion", "]"}], 
     "=", 
     RowBox[{"N", "[", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{
          "shannonInformationGapsSuppressed", "[", "highgapproportion", "]"}],
           ",", 
          RowBox[{"Except", "[", "0", "]"}]}], "]"}], ",", 
        RowBox[{"Except", "[", "0.", "]"}]}], "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "shannonInformationScaledGapsSuppressed", "[", "highgapproportion_", "]"}],
    ":=", 
   RowBox[{
    RowBox[{
    "shannonInformationScaledGapsSuppressed", "[", "highgapproportion", "]"}],
     "=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"SetSharedVariable", "[", "currentPos", "]"}], ";", 
      RowBox[{"currentPos", "=", 
       RowBox[{"{", "0", "}"}]}], ";", 
      RowBox[{
      "PrintTemporary", "[", "\"\<Current positions in calculation:\>\"", 
       "]"}], ";", "\[IndentingNewLine]", " ", 
      RowBox[{"PrintTemporary", "@", 
       RowBox[{"Dynamic", "[", "currentPos", "]"}]}], ";", 
      RowBox[{"totaluninform", "=", "0"}], ";", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"currentPos", "=", 
          RowBox[{"{", "i", "}"}]}], ";", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nPDsGapsSuppressed", "[", "highgapproportion", "]"}], 
             "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            "\[Equal]", "\"\<Uninform\>\""}], ",", 
           RowBox[{
            RowBox[{"totaluninform", "++"}], ";", "\"\<Uninform\>\""}], ",", 
           RowBox[{
            RowBox[{
            "shannonInformationScaledInformative", "[", "highgapproportion", 
             "]"}], "\[LeftDoubleBracket]", 
            RowBox[{"i", "-", "totaluninform"}], "\[RightDoubleBracket]"}]}], 
          "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "codondistributionsbylocation", "]"}]}], 
         "}"}]}], "]"}]}], ")"}]}]}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Cannot", " ", "parallelise"}], ",", " ", 
    RowBox[{
    "in", " ", "order", " ", "to", " ", "keep", " ", "a", " ", "tally", " ", 
     "of", " ", "where", " ", "we", " ", "are", " ", "with", " ", 
     "uninformative", " ", "points"}]}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"whichCalculations", "\[LeftDoubleBracket]", 
      RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"nPDshannonGraph", "[", 
        RowBox[{
         RowBox[{"highgapprop_", ":", "0.1"}], ",", "marginal_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"sigdescentsmarginal", "=", 
            RowBox[{
             RowBox[{"CalculatePDUnifiedDescent", "[", "highgapprop", "]"}], 
             "\[LeftDoubleBracket]", 
             RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], ",", 
           RowBox[{"sigdescents", "=", 
            RowBox[{
             RowBox[{
             "CalculatePDUnifiedDescentNoUnmaskedRegions", "[", "highgapprop",
               "]"}], "\[LeftDoubleBracket]", 
             RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], ",", 
           RowBox[{"revlist", "=", 
            RowBox[{
             RowBox[{"N", "[", 
              RowBox[{
              "shannonScalednPDsGapsSuppressed", "[", "highgapprop", "]"}], 
              "]"}], "/.", 
             RowBox[{"(", 
              RowBox[{"\"\<Uninform\>\"", "\[Rule]", "0"}], ")"}]}]}]}], " ", 
          
          RowBox[{"(*", " ", 
           RowBox[{
           "nPD", " ", "list", " ", "with", " ", "uninformative", " ", "site",
             " ", "nPD", " ", "set", " ", "to", " ", "0", " ", "at", " ", 
            "this", " ", "point"}], " ", "*)"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", "revlist", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{
                    "shannonScalednPDsGapsSuppressed", "[", "highgapprop", 
                    "]"}], "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], 
                    "]"}]}], "}"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "a_", ",", "b_", ",", "True", ",", "d_", ",", "True"}], 
                   "}"}], "->", 
                  RowBox[{"{", 
                   RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Missing", "[", "]"}], ",", 
                 RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", "revlist", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{
                    "shannonScalednPDsGapsSuppressed", "[", "highgapprop", 
                    "]"}], "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], 
                    "]"}]}], "}"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "a_", ",", "b_", ",", "False", ",", "True", ",", "True"}], 
                   "}"}], "->", 
                  RowBox[{"{", 
                   RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Missing", "[", "]"}], ",", 
                 RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", "revlist", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{
                    "shannonScalednPDsGapsSuppressed", "[", "highgapprop", 
                    "]"}], "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], 
                    "]"}]}], "}"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "a_", ",", "b_", ",", "False", ",", "False", ",", "True"}],
                    "}"}], "->", 
                  RowBox[{"{", 
                   RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Missing", "[", "]"}], ",", 
                 RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", "revlist", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{
                    "shannonScalednPDsGapsSuppressed", "[", "highgapprop", 
                    "]"}], "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], 
                    "]"}]}], "}"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "a_", ",", "b_", ",", "True", ",", "d_", ",", "False"}], 
                   "}"}], "->", 
                  RowBox[{"{", 
                   RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Missing", "[", "]"}], ",", 
                 RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", "revlist", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{
                    "shannonScalednPDsGapsSuppressed", "[", "highgapprop", 
                    "]"}], "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], 
                    "]"}]}], "}"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "a_", ",", "b_", ",", "False", ",", "True", ",", "False"}],
                    "}"}], "->", 
                  RowBox[{"{", 
                   RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Missing", "[", "]"}], ",", 
                 RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", "revlist", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                     ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{
                    "shannonScalednPDsGapsSuppressed", "[", "highgapprop", 
                    "]"}], "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], 
                    "]"}]}], "}"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "a_", ",", "b_", ",", "False", ",", "False", ",", 
                    "False"}], "}"}], "->", 
                  RowBox[{"{", 
                   RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Missing", "[", "]"}], ",", 
                 RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}]}], "}"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"PlotMarkers", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"openTriangle", ",", "openTriangleSize"}], "}"}], ",", 
              
              RowBox[{"{", 
               RowBox[{"openTriangle", ",", "openTriangleSize"}], "}"}], ",", 
              
              RowBox[{"{", 
               RowBox[{"openTriangle", ",", "openTriangleSize"}], "}"}], ",", 
              
              RowBox[{"{", 
               RowBox[{"solidCircle", ",", "solidCircleSize"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"solidCircle", ",", "solidCircleSize"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"solidCircle", ",", "solidCircleSize"}], "}"}]}], 
             "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"CBOrange", ",", 
              RowBox[{"If", "[", 
               RowBox[{"marginal", ",", "CBSkyBlue", ",", "Gray"}], "]"}], 
              ",", "Gray", ",", "CBVermillion", ",", 
              RowBox[{"If", "[", 
               RowBox[{"marginal", ",", "CBBlue", ",", "Black"}], "]"}], ",", 
              "Black"}], "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Mesh", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{"i", ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", 
                  RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}], 
              ",", 
              RowBox[{"{", "}"}]}], "}"}]}], ",", 
           RowBox[{"MeshStyle", "\[Rule]", "Gray"}], ",", 
           RowBox[{"MeshShading", "\[Rule]", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                "CBOrange", ",", "None"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}]}], 
           ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Frame", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"True", ",", "False"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "\"\<weighted pairwise distance ratio\>\"", ",", "None"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<amino acid position in alignment\>\"", ",", "None"}], 
               "}"}]}], "}"}]}], ",", 
           RowBox[{"FrameTicks", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"True", ",", "False"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"plotpadding", "*", 
                 RowBox[{"Length", "[", "revlist", "]"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"Min", "[", "revlist", "]"}], "-", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"plotpadding", "-", "1"}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Max", "[", "revlist", "]"}], "-", 
                    RowBox[{"Min", "[", "revlist", "]"}]}], ")"}]}], ")"}]}], 
                ",", 
                RowBox[{
                 RowBox[{"Max", "[", "revlist", "]"}], "+", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"plotpadding", "-", "1"}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Max", "[", "revlist", "]"}], "-", 
                    RowBox[{"Min", "[", "revlist", "]"}]}], ")"}]}], 
                  ")"}]}]}], "}"}]}], "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
           RowBox[{"PlotRangeClipping", "\[Rule]", "False"}]}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "General", " ", "strategy", " ", "in", " ", "setting", " ", "up", " ",
          "the", " ", "plot", " ", "to", " ", "allow", " ", "different", " ", 
         "symbols", " ", "and", " ", "colours", " ", "is", " ", "to", " ", 
         "partition", " ", "the", " ", "loci", " ", "into", " ", "the", " ", 
         "different", " ", "categories", " ", "and", " ", "set", " ", "them", 
         " ", "up", " ", "as", " ", "separate", " ", "lists", " ", "to", " ", 
         "plot"}], ";", " ", 
        RowBox[{
        "appending", " ", "the", " ", "\"\<Missing[]\>\"", " ", "data", " ", 
         "allows", " ", "for", " ", "the", " ", "possibility", " ", "that", 
         " ", "a", " ", "category", " ", "is", " ", "empty"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PDshannonCumuGraph", "[", 
        RowBox[{
         RowBox[{"highgapprop_", ":", "0.1"}], ",", "marginal_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"sigdescentsmarginal", "=", 
            RowBox[{
             RowBox[{"CalculatePDUnifiedDescent", "[", "highgapprop", "]"}], 
             "\[LeftDoubleBracket]", 
             RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], ",", 
           RowBox[{"sigdescents", "=", 
            RowBox[{
             RowBox[{
             "CalculatePDUnifiedDescentNoUnmaskedRegions", "[", "highgapprop",
               "]"}], "\[LeftDoubleBracket]", 
             RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], ",", 
           RowBox[{"revlist", "=", 
            RowBox[{
             RowBox[{
             "shannonScalednPDsGapsSuppressed", "[", "highgapprop", "]"}], "/.", 
             RowBox[{"(", 
              RowBox[{"\"\<Uninform\>\"", "\[Rule]", "0"}], ")"}]}]}], " ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "nPD", " ", "list", " ", "with", " ", "uninformative", " ", 
             "site", " ", "nMPD", " ", "set", " ", "to", " ", "zero", " ", 
             "at", " ", "this", " ", "point"}], " ", "*)"}], ",", 
           "\[IndentingNewLine]", "walk", ",", 
           RowBox[{"information", "=", 
            RowBox[{
            "shannonInformationScaledGapsSuppressed", "[", "highgapprop", 
             "]"}]}], ",", "informationWalk"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"walk", "=", 
           RowBox[{"Accumulate", "[", "revlist", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"informationWalk", "=", 
           RowBox[{"Accumulate", "[", 
            RowBox[{"information", "/.", 
             RowBox[{"(", 
              RowBox[{"\"\<Uninform\>\"", "\[Rule]", "0"}], ")"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"Cases", "[", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{"{", 
                    RowBox[{"informationWalk", ",", "walk", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{
                    "shannonScalednPDsGapsSuppressed", "[", "highgapprop", 
                    "]"}], "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}]}], 
                    "}"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "a_", ",", "b_", ",", "True", ",", "d_", ",", "True"}], 
                    "}"}], "->", 
                   RowBox[{"{", 
                    RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Missing", "[", "]"}], ",", 
                  RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"Cases", "[", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{"{", 
                    RowBox[{"informationWalk", ",", "walk", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{
                    "shannonScalednPDsGapsSuppressed", "[", "highgapprop", 
                    "]"}], "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}]}], 
                    "}"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "a_", ",", "b_", ",", "False", ",", "True", ",", "True"}],
                     "}"}], "->", 
                   RowBox[{"{", 
                    RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Missing", "[", "]"}], ",", 
                  RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}], ",", 
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"Cases", "[", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{"{", 
                    RowBox[{"informationWalk", ",", "walk", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{
                    "shannonScalednPDsGapsSuppressed", "[", "highgapprop", 
                    "]"}], "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}]}], 
                    "}"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "a_", ",", "b_", ",", "False", ",", "False", ",", 
                    "True"}], "}"}], "->", 
                   RowBox[{"{", 
                    RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Missing", "[", "]"}], ",", 
                  RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}], ",", 
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"Cases", "[", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{"{", 
                    RowBox[{"informationWalk", ",", "walk", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{
                    "shannonScalednPDsGapsSuppressed", "[", "highgapprop", 
                    "]"}], "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}]}], 
                    "}"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "a_", ",", "b_", ",", "True", ",", "d_", ",", "False"}], 
                    "}"}], "->", 
                   RowBox[{"{", 
                    RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Missing", "[", "]"}], ",", 
                  RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}], ",", 
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"Cases", "[", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{"{", 
                    RowBox[{"informationWalk", ",", "walk", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{
                    "shannonScalednPDsGapsSuppressed", "[", "highgapprop", 
                    "]"}], "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}]}], 
                    "}"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "a_", ",", "b_", ",", "False", ",", "True", ",", 
                    "False"}], "}"}], "->", 
                   RowBox[{"{", 
                    RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Missing", "[", "]"}], ",", 
                  RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}], ",", 
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"Cases", "[", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{"{", 
                    RowBox[{"informationWalk", ",", "walk", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{
                    "shannonScalednPDsGapsSuppressed", "[", "highgapprop", 
                    "]"}], "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}]}], 
                    "}"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "a_", ",", "b_", ",", "False", ",", "False", ",", 
                    "False"}], "}"}], "->", 
                   RowBox[{"{", 
                    RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Missing", "[", "]"}], ",", 
                  RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}]}], "}"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"PlotMarkers", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"openTriangle", ",", "openTriangleSize"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"openTriangle", ",", "openTriangleSize"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"openTriangle", ",", "openTriangleSize"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"solidCircle", ",", "solidCircleSize"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"solidCircle", ",", "solidCircleSize"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"solidCircle", ",", "solidCircleSize"}], "}"}]}], 
              "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"CBOrange", ",", 
               RowBox[{"If", "[", 
                RowBox[{"marginal", ",", "CBSkyBlue", ",", "Gray"}], "]"}], 
               ",", "Gray", ",", "CBVermillion", ",", 
               RowBox[{"If", "[", 
                RowBox[{"marginal", ",", "CBBlue", ",", "Black"}], "]"}], ",",
                "Black"}], "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Mesh", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{"i", ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", 
                   RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}], 
               ",", 
               RowBox[{"{", "}"}]}], "}"}]}], ",", 
            RowBox[{"MeshStyle", "\[Rule]", "Gray"}], ",", 
            RowBox[{"MeshShading", "\[Rule]", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"MemberQ", "[", 
                  RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                 "CBOrange", ",", "None"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}]}], 
            ",", 
            RowBox[{"Axes", "\[Rule]", "False"}], ",", 
            RowBox[{"Frame", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"True", ",", "False"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
            RowBox[{"FrameLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Column", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<cumulative sum of normalised, weighted\>\"", ",", 
                    "\"\<actual/expected pairwise distance\>\""}], "}"}], ",",
                    "Center"}], "]"}], ",", "None"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<cumulative information from loci\>\"", ",", "None"}], 
                "}"}]}], "}"}]}], ",", 
            RowBox[{"FrameTicks", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"True", ",", "False"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"plotpadding", "*", 
                  RowBox[{"informationWalk", "\[LeftDoubleBracket]", 
                   RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}]}], "}"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Min", "[", "walk", "]"}], "-", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"plotpadding", "-", "1"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Max", "[", "walk", "]"}], "-", 
                    RowBox[{"Min", "[", "walk", "]"}]}], ")"}]}], ")"}]}], 
                 ",", 
                 RowBox[{
                  RowBox[{"Max", "[", "walk", "]"}], "+", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"plotpadding", "-", "1"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Max", "[", "walk", "]"}], "-", 
                    RowBox[{"Min", "[", "walk", "]"}]}], ")"}]}], ")"}]}]}], 
                "}"}]}], "}"}]}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
            RowBox[{"PlotRangeClipping", "\[Rule]", "False"}]}], "]"}]}]}], 
        " ", "]"}]}], ";"}]}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "General", " ", "strategy", " ", "in", " ", "setting", " ", "up", " ", 
       "the", " ", "plot", " ", "to", " ", "allow", " ", "different", " ", 
       "symbols", " ", "and", " ", "colours", " ", "is", " ", "to", " ", 
       "partition", " ", "the", " ", "loci", " ", "into", " ", "the", " ", 
       "different", " ", "categories", " ", "and", " ", "set", " ", "them", 
       " ", "up", " ", "as", " ", "separate", " ", "lists", " ", "to", " ", 
       "plot"}], ";", " ", 
      RowBox[{
      "appending", " ", "the", " ", "\"\<Missing[]\>\"", " ", "data", " ", 
       "allows", " ", "for", " ", "the", " ", "possibility", " ", "that", " ",
        "a", " ", "category", " ", "is", " ", "empty"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "shannonScaledRankednPDsInformative", "[", "highgapproportion_", "]"}], ":=", 
  RowBox[{
   RowBox[{
   "shannonScaledRankednPDsInformative", "[", "highgapproportion", "]"}], "=", 
   RowBox[{"N", "[", 
    RowBox[{"wnorm", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"N", "[", 
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"shannonRank", "[", 
           RowBox[{
            RowBox[{"nPDsGapsSuppressed", "[", "highgapproportion", "]"}], 
            ",", 
            RowBox[{
            "shannonInformationGapsSuppressed", "[", "highgapproportion", 
             "]"}]}], "]"}], ",", 
          RowBox[{"Except", "[", "\"\<Uninform\>\"", "]"}]}], "]"}], "]"}], 
       ")"}], ",", 
      RowBox[{"(", 
       RowBox[{"N", "[", 
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{
            "shannonInformationGapsSuppressed", "[", "highgapproportion", 
             "]"}], ",", 
            RowBox[{"Except", "[", "0", "]"}]}], "]"}], ",", 
          RowBox[{"Except", "[", "0.", "]"}]}], "]"}], "]"}], ")"}]}], "]"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "shannonInformationRankScaledInformative", "[", "highgapproportion_", 
    "]"}], ":=", 
   RowBox[{
    RowBox[{
    "shannonInformationRankScaledInformative", "[", "highgapproportion", 
     "]"}], "=", 
    RowBox[{
    "shannonInformationScaledInformative", "[", "highgapproportion", 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "shannonScaledRankednPDsGapsSuppressed", "[", "highgapproportion_", "]"}], 
   ":=", 
   RowBox[{
    RowBox[{
    "shannonScaledRankednPDsGapsSuppressed", "[", "highgapproportion", "]"}], 
    "=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"SetSharedVariable", "[", "currentPos", "]"}], ";", 
      RowBox[{"currentPos", "=", 
       RowBox[{"{", "0", "}"}]}], ";", 
      RowBox[{
      "PrintTemporary", "[", "\"\<Current positions in calculation:\>\"", 
       "]"}], ";", "\[IndentingNewLine]", " ", 
      RowBox[{"PrintTemporary", "@", 
       RowBox[{"Dynamic", "[", "currentPos", "]"}]}], ";", 
      RowBox[{"totaluninform", "=", "0"}], ";", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"currentPos", "=", 
          RowBox[{"{", "i", "}"}]}], ";", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nPDsGapsSuppressed", "[", "highgapproportion", "]"}], 
             "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            "\[Equal]", "\"\<Uninform\>\""}], ",", 
           RowBox[{
            RowBox[{"totaluninform", "++"}], ";", "\"\<Uninform\>\""}], ",", 
           RowBox[{
            RowBox[{
            "shannonScaledRankednPDsInformative", "[", "highgapproportion", 
             "]"}], "\[LeftDoubleBracket]", 
            RowBox[{"i", "-", "totaluninform"}], "\[RightDoubleBracket]"}]}], 
          "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "codondistributionsbylocation", "]"}]}], 
         "}"}]}], "]"}]}], ")"}]}]}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Cannot", " ", "parallelise"}], ",", " ", 
    RowBox[{
    "in", " ", "order", " ", "to", " ", "keep", " ", "a", " ", "tally", " ", 
     "of", " ", "where", " ", "we", " ", "are", " ", "with", " ", 
     "uninformative", " ", "points"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "shannonInformationRankScaledGapsSuppressed", "[", "highgapproportion_", 
    "]"}], ":=", 
   RowBox[{
    RowBox[{
    "shannonInformationScaledGapsSuppressed", "[", "highgapproportion", "]"}],
     "=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"SetSharedVariable", "[", "currentPos", "]"}], ";", 
      RowBox[{"currentPos", "=", 
       RowBox[{"{", "0", "}"}]}], ";", 
      RowBox[{
      "PrintTemporary", "[", "\"\<Current positions in calculation:\>\"", 
       "]"}], ";", "\[IndentingNewLine]", " ", 
      RowBox[{"PrintTemporary", "@", 
       RowBox[{"Dynamic", "[", "currentPos", "]"}]}], ";", 
      RowBox[{"totaluninform", "=", "0"}], ";", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"currentPos", "=", 
          RowBox[{"{", "i", "}"}]}], ";", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nPDsGapsSuppressed", "[", "highgapproportion", "]"}], 
             "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            "\[Equal]", "\"\<Uninform\>\""}], ",", 
           RowBox[{
            RowBox[{"totaluninform", "++"}], ";", "\"\<Uninform\>\""}], ",", 
           RowBox[{
            RowBox[{
            "shannonInformationRankScaledInformative", "[", 
             "highgapproportion", "]"}], "\[LeftDoubleBracket]", 
            RowBox[{"i", "-", "totaluninform"}], "\[RightDoubleBracket]"}]}], 
          "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "codondistributionsbylocation", "]"}]}], 
         "}"}]}], "]"}]}], ")"}]}]}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Cannot", " ", "parallelise"}], ",", " ", 
    RowBox[{
    "in", " ", "order", " ", "to", " ", "keep", " ", "a", " ", "tally", " ", 
     "of", " ", "where", " ", "we", " ", "are", " ", "with", " ", 
     "uninformative", " ", "points"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"whichCalculations", "\[LeftDoubleBracket]", 
     RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"nPDshannonGraphRank", "[", 
       RowBox[{
        RowBox[{"highgapprop_", ":", "0.1"}], ",", "marginal_"}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"sigdescentsmarginal", "=", 
           RowBox[{
            RowBox[{"CalculatePDUnifiedDescent", "[", "highgapprop", "]"}], 
            "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], ",", 
          RowBox[{"sigdescents", "=", 
           RowBox[{
            RowBox[{
            "CalculatePDUnifiedDescentNoUnmaskedRegions", "[", "highgapprop", 
             "]"}], "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], ",", 
          RowBox[{"revlist", "=", 
           RowBox[{
            RowBox[{"N", "[", 
             RowBox[{
             "shannonScaledRankednPDsGapsSuppressed", "[", "highgapprop", 
              "]"}], "]"}], "/.", 
            RowBox[{"(", 
             RowBox[{"\"\<Uninform\>\"", "\[Rule]", "0"}], ")"}]}]}]}], " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "nPD", " ", "list", " ", "with", " ", "uninformative", " ", "site", 
           " ", "nPD", " ", "set", " ", "to", " ", "0", " ", "at", " ", 
           "this", " ", "point"}], " ", "*)"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                    ",", "revlist", ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                    ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                    ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{
                    "shannonScaledRankednPDsGapsSuppressed", "[", 
                    "highgapprop", "]"}], "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], 
                    "]"}]}], "}"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "a_", ",", "b_", ",", "True", ",", "d_", ",", "True"}], 
                  "}"}], "->", 
                 RowBox[{"{", 
                  RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Missing", "[", "]"}], ",", 
                RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                    ",", "revlist", ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                    ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                    ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{
                    "shannonScaledRankednPDsGapsSuppressed", "[", 
                    "highgapprop", "]"}], "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], 
                    "]"}]}], "}"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "a_", ",", "b_", ",", "False", ",", "True", ",", "True"}], 
                  "}"}], "->", 
                 RowBox[{"{", 
                  RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Missing", "[", "]"}], ",", 
                RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                    ",", "revlist", ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                    ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                    ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{
                    "shannonScaledRankednPDsGapsSuppressed", "[", 
                    "highgapprop", "]"}], "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], 
                    "]"}]}], "}"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "a_", ",", "b_", ",", "False", ",", "False", ",", "True"}], 
                  "}"}], "->", 
                 RowBox[{"{", 
                  RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Missing", "[", "]"}], ",", 
                RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                    ",", "revlist", ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                    ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                    ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{
                    "shannonScaledRankednPDsGapsSuppressed", "[", 
                    "highgapprop", "]"}], "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], 
                    "]"}]}], "}"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "a_", ",", "b_", ",", "True", ",", "d_", ",", "False"}], 
                  "}"}], "->", 
                 RowBox[{"{", 
                  RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Missing", "[", "]"}], ",", 
                RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                    ",", "revlist", ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                    ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                    ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{
                    "shannonScaledRankednPDsGapsSuppressed", "[", 
                    "highgapprop", "]"}], "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], 
                    "]"}]}], "}"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "a_", ",", "b_", ",", "False", ",", "True", ",", "False"}], 
                  "}"}], "->", 
                 RowBox[{"{", 
                  RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Missing", "[", "]"}], ",", 
                RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                    ",", "revlist", ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                    ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}],
                    ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{
                    "shannonScaledRankednPDsGapsSuppressed", "[", 
                    "highgapprop", "]"}], "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], 
                    "]"}]}], "}"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "a_", ",", "b_", ",", "False", ",", "False", ",", "False"}],
                   "}"}], "->", 
                 RowBox[{"{", 
                  RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Missing", "[", "]"}], ",", 
                RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}]}], "}"}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"PlotMarkers", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"openTriangle", ",", "openTriangleSize"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"openTriangle", ",", "openTriangleSize"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"openTriangle", ",", "openTriangleSize"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"solidCircle", ",", "solidCircleSize"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"solidCircle", ",", "solidCircleSize"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"solidCircle", ",", "solidCircleSize"}], "}"}]}], 
            "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"CBOrange", ",", 
             RowBox[{"If", "[", 
              RowBox[{"marginal", ",", "CBSkyBlue", ",", "Gray"}], "]"}], ",",
              "Gray", ",", "CBVermillion", ",", 
             RowBox[{"If", "[", 
              RowBox[{"marginal", ",", "CBBlue", ",", "Black"}], "]"}], ",", 
             "Black"}], "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Mesh", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{"i", ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}], 
             ",", 
             RowBox[{"{", "}"}]}], "}"}]}], ",", 
          RowBox[{"MeshStyle", "\[Rule]", "Gray"}], ",", 
          RowBox[{"MeshShading", "\[Rule]", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
               "CBOrange", ",", "None"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}]}], 
          ",", 
          RowBox[{"Axes", "\[Rule]", "False"}], ",", 
          RowBox[{"Frame", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"True", ",", "False"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\"\<weighted ranked pairwise distance ratio\>\"", ",", 
               "None"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "\"\<amino acid position in alignment\>\"", ",", "None"}], 
              "}"}]}], "}"}]}], ",", 
          RowBox[{"FrameTicks", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"True", ",", "False"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"plotpadding", "*", 
                RowBox[{"Length", "[", "revlist", "]"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"Min", "[", "revlist", "]"}], "-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"plotpadding", "-", "1"}], ")"}], "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Max", "[", "revlist", "]"}], "-", 
                    RowBox[{"Min", "[", "revlist", "]"}]}], ")"}]}], ")"}]}], 
               ",", 
               RowBox[{
                RowBox[{"Max", "[", "revlist", "]"}], "+", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"plotpadding", "-", "1"}], ")"}], "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Max", "[", "revlist", "]"}], "-", 
                    RowBox[{"Min", "[", "revlist", "]"}]}], ")"}]}], 
                 ")"}]}]}], "}"}]}], "}"}]}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
          RowBox[{"PlotRangeClipping", "\[Rule]", "False"}]}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "General", " ", "strategy", " ", "in", " ", "setting", " ", "up", " ", 
        "the", " ", "plot", " ", "to", " ", "allow", " ", "different", " ", 
        "symbols", " ", "and", " ", "colours", " ", "is", " ", "to", " ", 
        "partition", " ", "the", " ", "loci", " ", "into", " ", "the", " ", 
        "different", " ", "categories", " ", "and", " ", "set", " ", "them", 
        " ", "up", " ", "as", " ", "separate", " ", "lists", " ", "to", " ", 
        "plot"}], ";", " ", 
       RowBox[{
       "appending", " ", "the", " ", "\"\<Missing[]\>\"", " ", "data", " ", 
        "allows", " ", "for", " ", "the", " ", "possibility", " ", "that", 
        " ", "a", " ", "category", " ", "is", " ", "empty"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PDshannonCumuGraphRank", "[", 
       RowBox[{
        RowBox[{"highgapprop_", ":", "0.1"}], ",", "marginal_"}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"sigdescentsmarginal", "=", 
           RowBox[{
            RowBox[{"CalculatePDUnifiedDescent", "[", "highgapprop", "]"}], 
            "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], ",", 
          RowBox[{"sigdescents", "=", 
           RowBox[{
            RowBox[{
            "CalculatePDUnifiedDescentNoUnmaskedRegions", "[", "highgapprop", 
             "]"}], "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], ",", 
          RowBox[{"revlist", "=", 
           RowBox[{
            RowBox[{
            "shannonScaledRankednPDsGapsSuppressed", "[", "highgapprop", 
             "]"}], "/.", 
            RowBox[{"(", 
             RowBox[{"\"\<Uninform\>\"", "\[Rule]", "0"}], ")"}]}]}], " ", 
          RowBox[{"(*", " ", 
           RowBox[{
           "nPD", " ", "list", " ", "with", " ", "uninformative", " ", "site",
             " ", "nMPD", " ", "set", " ", "to", " ", "zero", " ", "at", " ", 
            "this", " ", "point"}], " ", "*)"}], ",", "\[IndentingNewLine]", 
          "walk", ",", 
          RowBox[{"information", "=", 
           RowBox[{
           "shannonInformationRankScaledGapsSuppressed", "[", "highgapprop", 
            "]"}]}], ",", "informationWalk"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"walk", "=", 
          RowBox[{"Accumulate", "[", "revlist", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"informationWalk", "=", 
          RowBox[{"Accumulate", "[", 
           RowBox[{"information", "/.", 
            RowBox[{"(", 
             RowBox[{"\"\<Uninform\>\"", "\[Rule]", "0"}], ")"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{"informationWalk", ",", "walk", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{
                    "shannonScaledRankednPDsGapsSuppressed", "[", 
                    "highgapprop", "]"}], "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}]}], 
                   "}"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "a_", ",", "b_", ",", "True", ",", "d_", ",", "True"}], 
                   "}"}], "->", 
                  RowBox[{"{", 
                   RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Missing", "[", "]"}], ",", 
                 RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{"informationWalk", ",", "walk", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{
                    "shannonScaledRankednPDsGapsSuppressed", "[", 
                    "highgapprop", "]"}], "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}]}], 
                   "}"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "a_", ",", "b_", ",", "False", ",", "True", ",", "True"}], 
                   "}"}], "->", 
                  RowBox[{"{", 
                   RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Missing", "[", "]"}], ",", 
                 RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{"informationWalk", ",", "walk", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{
                    "shannonScaledRankednPDsGapsSuppressed", "[", 
                    "highgapprop", "]"}], "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}]}], 
                   "}"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "a_", ",", "b_", ",", "False", ",", "False", ",", "True"}],
                    "}"}], "->", 
                  RowBox[{"{", 
                   RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Missing", "[", "]"}], ",", 
                 RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{"informationWalk", ",", "walk", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{
                    "shannonScaledRankednPDsGapsSuppressed", "[", 
                    "highgapprop", "]"}], "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}]}], 
                   "}"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "a_", ",", "b_", ",", "True", ",", "d_", ",", "False"}], 
                   "}"}], "->", 
                  RowBox[{"{", 
                   RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Missing", "[", "]"}], ",", 
                 RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{"informationWalk", ",", "walk", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{
                    "shannonScaledRankednPDsGapsSuppressed", "[", 
                    "highgapprop", "]"}], "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}]}], 
                   "}"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "a_", ",", "b_", ",", "False", ",", "True", ",", "False"}],
                    "}"}], "->", 
                  RowBox[{"{", 
                   RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Missing", "[", "]"}], ",", 
                 RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{"informationWalk", ",", "walk", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescents", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{
                    "shannonScaledRankednPDsGapsSuppressed", "[", 
                    "highgapprop", "]"}], "]"}], "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "==", "\"\<Uninform\>\""}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "walk", "]"}]}], "}"}]}], "]"}]}], 
                   "}"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "a_", ",", "b_", ",", "False", ",", "False", ",", 
                    "False"}], "}"}], "->", 
                  RowBox[{"{", 
                   RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Missing", "[", "]"}], ",", 
                 RowBox[{"Missing", "[", "]"}]}], "}"}]}], "]"}]}], "}"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"PlotMarkers", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"openTriangle", ",", "openTriangleSize"}], "}"}], ",", 
              
              RowBox[{"{", 
               RowBox[{"openTriangle", ",", "openTriangleSize"}], "}"}], ",", 
              
              RowBox[{"{", 
               RowBox[{"openTriangle", ",", "openTriangleSize"}], "}"}], ",", 
              
              RowBox[{"{", 
               RowBox[{"solidCircle", ",", "solidCircleSize"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"solidCircle", ",", "solidCircleSize"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"solidCircle", ",", "solidCircleSize"}], "}"}]}], 
             "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"CBOrange", ",", 
              RowBox[{"If", "[", 
               RowBox[{"marginal", ",", "CBSkyBlue", ",", "Gray"}], "]"}], 
              ",", "Gray", ",", "CBVermillion", ",", 
              RowBox[{"If", "[", 
               RowBox[{"marginal", ",", "CBBlue", ",", "Black"}], "]"}], ",", 
              "Black"}], "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Mesh", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{"i", ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", 
                  RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}], 
              ",", 
              RowBox[{"{", "}"}]}], "}"}]}], ",", 
           RowBox[{"MeshStyle", "\[Rule]", "Gray"}], ",", 
           RowBox[{"MeshShading", "\[Rule]", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{"sigdescentsmarginal", ",", "i"}], "]"}], ",", 
                "CBOrange", ",", "None"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "revlist", "]"}]}], "}"}]}], "]"}]}], 
           ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Frame", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"True", ",", "False"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Column", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<cumulative sum of normalised, weighted\>\"", ",", 
                    "\"\<ranked actual/expected pairwise distance\>\""}], 
                   "}"}], ",", "Center"}], "]"}], ",", "None"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<cumulative information from loci\>\"", ",", "None"}], 
               "}"}]}], "}"}]}], ",", 
           RowBox[{"FrameTicks", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"True", ",", "False"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"plotpadding", "*", 
                 RowBox[{"informationWalk", "\[LeftDoubleBracket]", 
                  RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}]}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"Min", "[", "walk", "]"}], "-", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"plotpadding", "-", "1"}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Max", "[", "walk", "]"}], "-", 
                    RowBox[{"Min", "[", "walk", "]"}]}], ")"}]}], ")"}]}], 
                ",", 
                RowBox[{
                 RowBox[{"Max", "[", "walk", "]"}], "+", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"plotpadding", "-", "1"}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Max", "[", "walk", "]"}], "-", 
                    RowBox[{"Min", "[", "walk", "]"}]}], ")"}]}], ")"}]}]}], 
               "}"}]}], "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
           RowBox[{"PlotRangeClipping", "\[Rule]", "False"}]}], "]"}]}]}], 
       "]"}]}], ";"}]}], 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "General", " ", "strategy", " ", "in", " ", "setting", " ", "up", " ", 
      "the", " ", "plot", " ", "to", " ", "allow", " ", "different", " ", 
      "symbols", " ", "and", " ", "colours", " ", "is", " ", "to", " ", 
      "partition", " ", "the", " ", "loci", " ", "into", " ", "the", " ", 
      "different", " ", "categories", " ", "and", " ", "set", " ", "them", 
      " ", "up", " ", "as", " ", "separate", " ", "lists", " ", "to", " ", 
      "plot"}], ";", " ", 
     RowBox[{
     "appending", " ", "the", " ", "\"\<Missing[]\>\"", " ", "data", " ", 
      "allows", " ", "for", " ", "the", " ", "possibility", " ", "that", " ", 
      "a", " ", "category", " ", "is", " ", "empty"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"whichCalculations", "\[LeftDoubleBracket]", 
     RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{
     RowBox[{"shannonScalednPDsInformative", "[", "0.1", "]"}], ";", 
     RowBox[{"shannonInformationScaledInformative", "[", "0.1", "]"}], 
     ";"}]}], "]"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Code", " ", "to", " ", "work", " ", "out", " ", "the", " ", "weight"}], 
    "-", 
    RowBox[{
    "scaled", " ", "nPDs", " ", "and", " ", "information", " ", "for", " ", 
     "plotting"}], " ", "-", " ", 
    RowBox[{
    "run", " ", "here", " ", "so", " ", "that", " ", "it", " ", "is", " ", 
     "in", " ", "memory", " ", "when", " ", "plotted", " ", "below"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"whichCalculations", "\[LeftDoubleBracket]", 
     RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{
     RowBox[{"shannonScaledRankednPDsInformative", "[", "0.1", "]"}], ";", 
     RowBox[{"shannonInformationRankScaledInformative", "[", "0.1", "]"}], 
     ";"}]}], "]"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Code", " ", "to", " ", "work", " ", "out", " ", "the", " ", "weight"}], 
    "-", 
    RowBox[{
    "scaled", " ", "ranked", " ", "nPDs", " ", "and", " ", "information", " ",
      "for", " ", "plotting"}], " ", "-", " ", 
    RowBox[{
    "run", " ", "here", " ", "so", " ", "that", " ", "it", " ", "is", " ", 
     "in", " ", "memory", " ", "when", " ", "plotted", " ", "below"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]"}]}], "Input",
 CellChangeTimes->{{3.770904521782506*^9, 3.7709045454600773`*^9}, {
   3.7709045851521072`*^9, 3.770904641424638*^9}, 3.77090509414325*^9, {
   3.770905143919607*^9, 3.770905149197484*^9}, {3.770905182057191*^9, 
   3.770905186121015*^9}, {3.770905307124877*^9, 3.770905354165698*^9}, {
   3.770905590196703*^9, 3.770905683630693*^9}, {3.770905725535802*^9, 
   3.770905760200398*^9}, {3.770905848403615*^9, 3.770905894210361*^9}, {
   3.770905931893618*^9, 3.770905960588995*^9}, {3.7709060092229013`*^9, 
   3.7709060187754803`*^9}, {3.770906097313936*^9, 3.770906107121879*^9}, {
   3.770906147034638*^9, 3.770906174563429*^9}, {3.7709066761365557`*^9, 
   3.7709066994043407`*^9}, {3.770906736498333*^9, 3.770906750002009*^9}, {
   3.7709069921692247`*^9, 3.77090706213138*^9}, {3.770907098381933*^9, 
   3.770907098860249*^9}, {3.770907272625433*^9, 3.770907301016962*^9}, {
   3.7800527545640907`*^9, 3.7800527784685373`*^9}, {3.780053727722056*^9, 
   3.780053816426527*^9}, {3.780053857373641*^9, 3.78005385930733*^9}, {
   3.78005391591544*^9, 3.780053916859172*^9}, {3.7800539500432*^9, 
   3.780053990987129*^9}, {3.7800540422052937`*^9, 3.780054091214779*^9}, 
   3.780054125053753*^9, {3.7801276041259604`*^9, 3.780127610858042*^9}, {
   3.7801278332780523`*^9, 3.780127926140397*^9}, 3.7801285768226423`*^9, {
   3.780129567270905*^9, 3.7801295702347403`*^9}, {3.78012986729191*^9, 
   3.780129873999688*^9}, {3.7869756344149427`*^9, 3.7869756345144377`*^9}, {
   3.786975673850111*^9, 3.786975673940894*^9}, {3.790086197547414*^9, 
   3.790086293835566*^9}, {3.7900863399800034`*^9, 3.790086471040316*^9}, {
   3.7903241996005583`*^9, 3.790324201865143*^9}, {3.790325254319787*^9, 
   3.790325259199266*^9}, {3.79032579864886*^9, 3.790325800310494*^9}, {
   3.790424019512041*^9, 3.790424069195794*^9}, {3.790424265485567*^9, 
   3.790424267991363*^9}, {3.7944214609483137`*^9, 3.794421466799409*^9}, {
   3.808813684357029*^9, 3.808813685311191*^9}, {3.808813758147234*^9, 
   3.808813764607451*^9}, {3.8088234265129023`*^9, 3.808823450878893*^9}, {
   3.808823486919395*^9, 3.8088235257299633`*^9}, {3.808823555858458*^9, 
   3.808823613165367*^9}, {3.8088236448126307`*^9, 3.808823647652692*^9}, {
   3.808823738730833*^9, 3.8088237654572906`*^9}, {3.82612260295607*^9, 
   3.8261226089823027`*^9}, {3.8261227008550043`*^9, 3.826122719279274*^9}, {
   3.8263080472392817`*^9, 3.8263081347829943`*^9}, {3.8276570339643583`*^9, 
   3.827657078514738*^9}, {3.827657116686728*^9, 3.827657134011057*^9}, {
   3.827657234426496*^9, 3.8276572503781433`*^9}, {3.827657280698349*^9, 
   3.82765736088023*^9}, {3.827657413681275*^9, 3.827657512699213*^9}, {
   3.827658863632382*^9, 3.827658881091591*^9}, {3.845527270603857*^9, 
   3.845527289866527*^9}, {3.845528047668366*^9, 3.8455280525548286`*^9}, {
   3.85762602015274*^9, 3.8576261642231293`*^9}, {3.857626570847355*^9, 
   3.857626616802787*^9}, {3.859886106156456*^9, 3.859886177037222*^9}, {
   3.859895131230411*^9, 3.8598951945677547`*^9}, {3.8867601592051573`*^9, 
   3.886760197220502*^9}, {3.886760310057941*^9, 3.886760506530073*^9}, {
   3.886760605458036*^9, 3.88676064696173*^9}, {3.886760710482932*^9, 
   3.8867608462765713`*^9}, {3.886760968163989*^9, 3.88676102910878*^9}, {
   3.886761062837372*^9, 3.886761113364418*^9}, {3.8867611820528183`*^9, 
   3.886761257815403*^9}, {3.8867613090921926`*^9, 3.886761310821806*^9}, {
   3.886761366613962*^9, 3.8867613973827877`*^9}, {3.88676168288769*^9, 
   3.886761708839478*^9}, {3.8867618177668047`*^9, 3.886761894871369*^9}, {
   3.886761958646595*^9, 3.8867620627237673`*^9}, {3.886762157722794*^9, 
   3.8867621618829193`*^9}, {3.88676330466263*^9, 3.886763311238894*^9}, 
   3.886764311966256*^9, {3.886764445065084*^9, 3.8867644551322947`*^9}, 
   3.886764485849399*^9, {3.886828630557617*^9, 3.886828686312796*^9}, {
   3.886828818670261*^9, 3.886828829978643*^9}, {3.886829060573019*^9, 
   3.88682907479405*^9}, {3.886829806639738*^9, 3.886829851965638*^9}, {
   3.886829922318634*^9, 3.886829956718431*^9}, {3.886835778142414*^9, 
   3.886835913340582*^9}, {3.88683619943377*^9, 3.8868362505853367`*^9}, {
   3.8968652720166473`*^9, 3.896865272576643*^9}, {3.896865370881456*^9, 
   3.896865443027856*^9}, {3.89686554544382*^9, 3.8968655624840097`*^9}, 
   3.8968656146476707`*^9, {3.8968656588735237`*^9, 3.8968657244675617`*^9}, {
   3.896865774291841*^9, 3.896865832935747*^9}, {3.89686587181619*^9, 
   3.896865924806102*^9}, {3.896865958706406*^9, 3.896866236230856*^9}, {
   3.896866281312611*^9, 3.8968664675616693`*^9}, {3.8968665099531317`*^9, 
   3.896866697845385*^9}},ExpressionUUID->"2861770a-392a-4df3-9437-\
14152fdc6710"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Run the code below, finally, to get calculation output and lists of \
significant regions\
\>", "Subsubsection",
 CellChangeTimes->{{3.8866824684338827`*^9, 
  3.88668253433696*^9}},ExpressionUUID->"dad38a03-5522-4ef4-83ab-\
501fe83be921"],

Cell[BoxData[{
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"whichCalculations", "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{
   "CalculatedPDOrganismExtremalDescentList", "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Unweighted", " ", "calculation", " ", "on", " ", "raw", " ", "nPDs"}], 
    ",", " ", 
    RowBox[{
    "by", " ", "default", " ", "as", " ", "a", " ", "list", " ", "consisting",
      " ", "of", " ", "entries", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "Loci", " ", "in", " ", "most", " ", "extreme", " ", "descent"}], 
        "}"}], ",", 
       RowBox[{
       "Z", " ", "statistic", " ", "for", " ", "this", " ", "descent"}], ",", 
       
       RowBox[{
       "Whether", " ", "descent", " ", "evaluated", " ", "after", " ", 
        "first", " ", "time", " ", "a", " ", "less", " ", "significant", " ", 
        "descent", " ", "is", " ", "excised", " ", "to", " ", "check", " ", 
        "for", " ", "interference"}], ",", 
       RowBox[{"Bootstrap", " ", "\"\<p-value\>\""}]}], "}"}]}]}], " ", 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.886680582489361*^9, 3.8866806991925707`*^9}, 
   3.886752329031255*^9, {3.886752546536549*^9, 
   3.886752546952415*^9}},ExpressionUUID->"36aa2806-97b1-49fe-bd8d-\
b144dafddb70"],

Cell[BoxData[{
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"whichCalculations", "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{"OrganismPDUnifiedSigDescentLists", "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "All", " ", "members", " ", "of", " ", "significant", " ", "descents"}], 
    ",", " ", 
    RowBox[{
    "for", " ", "unweighted", " ", "calculation", " ", "on", " ", "raw", " ", 
     "nPDs"}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.88668179153426*^9, 3.886681828317686*^9}, {
   3.886681865421926*^9, 3.886681867518259*^9}, 
   3.886752330567313*^9},ExpressionUUID->"644683b5-4a42-404f-a169-\
6dc7b062fa07"],

Cell[BoxData[{
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"whichCalculations", "\[LeftDoubleBracket]", 
     RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "&&", 
    RowBox[{
    "unmaskedSignificantRegionsOrExtraCalcs", "\[Equal]", 
     "\"\<unmaskedregions\>\""}], "&&", "recordUnmaskedSignificantRegions"}], 
   ",", 
   RowBox[{
   "OrganismPDUnifiedSigDescentListsNoUnmaskedRegions", 
    "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "All", " ", "members", " ", "of", " ", "significant", " ", "descents", 
     " ", "without", " ", "including", " ", "descents", " ", "only", " ", 
     "obtained", " ", "after", " ", "excluding", " ", "later", " ", 
     "potentially", " ", "interfering", " ", "descents"}], ",", " ", 
    RowBox[{
    "for", " ", "unweighted", " ", "calculation", " ", "on", " ", "raw", " ", 
     "nPDs"}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.886681869645925*^9, 3.886681922910243*^9}, 
   3.8867523325192337`*^9},ExpressionUUID->"eec5a491-5f31-45c3-b2d6-\
16019cb81bca"],

Cell[BoxData[{
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"whichCalculations", "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{
   "CalculatedPDOrganismExtremalDescentList", "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Unweighted", " ", "calculation", " ", "on", " ", "ranked", " ", "nPDs"}],
     ",", " ", 
    RowBox[{
    "by", " ", "default", " ", "as", " ", "a", " ", "list", " ", "consisting",
      " ", "of", " ", "entries", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "Loci", " ", "in", " ", "most", " ", "extreme", " ", "descent"}], 
        "}"}], ",", 
       RowBox[{
       "Z", " ", "statistic", " ", "for", " ", "this", " ", "descent"}], ",", 
       
       RowBox[{
       "Whether", " ", "descent", " ", "evaluated", " ", "after", " ", 
        "first", " ", "time", " ", "a", " ", "less", " ", "significant", " ", 
        "descent", " ", "is", " ", "excised", " ", "to", " ", "check", " ", 
        "for", " ", "interference"}], ",", 
       RowBox[{"Bootstrap", " ", "\"\<p-value\>\""}]}], "}"}]}]}], " ", 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.886680713080225*^9, 3.886680736808735*^9}, 
   3.886752334407838*^9, {3.886752548536426*^9, 
   3.886752548952211*^9}},ExpressionUUID->"208a6c9f-768e-4044-bfde-\
06e8762538a2"],

Cell[BoxData[{
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"whichCalculations", "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{"OrganismPDUnifiedSigDescentLists", "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "All", " ", "members", " ", "of", " ", "significant", " ", "descents"}], 
    ",", " ", 
    RowBox[{
    "for", " ", "unweighted", " ", "calculation", " ", "on", " ", "ranked", 
     " ", "nPDs"}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.886681993598464*^9, 3.886681997550432*^9}, 
   3.886682115599134*^9, 
   3.886752336279687*^9},ExpressionUUID->"71cc021d-f188-469f-ad48-\
4d754553dc60"],

Cell[BoxData[{
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"whichCalculations", "\[LeftDoubleBracket]", 
     RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "&&", 
    RowBox[{
    "unmaskedSignificantRegionsOrExtraCalcs", "\[Equal]", 
     "\"\<unmaskedregions\>\""}], "&&", "recordUnmaskedSignificantRegions"}], 
   ",", 
   RowBox[{
   "OrganismPDUnifiedSigDescentListsNoUnmaskedRegions", 
    "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "All", " ", "members", " ", "of", " ", "significant", " ", "descents", 
     " ", "without", " ", "including", " ", "descents", " ", "only", " ", 
     "obtained", " ", "after", " ", "excluding", " ", "later", " ", 
     "potentially", " ", "interfering", " ", "descents"}], ",", " ", 
    RowBox[{
    "for", " ", "unweighted", " ", "calculation", " ", "on", " ", "ranked", 
     " ", "nPDs"}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.8866819522869463`*^9, 3.886681961358491*^9}, 
   3.8867523391754704`*^9},ExpressionUUID->"b60ab24e-503b-4cbd-ab1f-\
db9e2361e124"],

Cell[BoxData[{
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"whichCalculations", "\[LeftDoubleBracket]", 
    RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{
   "CalculatedPDOrganismExtremalDescentList", "\[LeftDoubleBracket]", 
    RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Weighted", " ", "calculation", " ", "on", " ", "raw", " ", "nPDs"}], ",",
     " ", 
    RowBox[{
    "by", " ", "default", " ", "as", " ", "a", " ", "list", " ", "consisting",
      " ", "of", " ", "entries", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "Loci", " ", "in", " ", "most", " ", "extreme", " ", "descent"}], 
        "}"}], ",", 
       RowBox[{
       "Z", " ", "statistic", " ", "for", " ", "this", " ", "descent"}], ",", 
       
       RowBox[{
       "Whether", " ", "descent", " ", "evaluated", " ", "after", " ", 
        "first", " ", "time", " ", "a", " ", "less", " ", "significant", " ", 
        "descent", " ", "is", " ", "excised", " ", "to", " ", "check", " ", 
        "for", " ", "interference"}], ",", 
       RowBox[{"Bootstrap", " ", "\"\<p-value\>\""}]}], "}"}]}]}], " ", 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.886680726664206*^9, 3.886680745513906*^9}, 
   3.886752341719482*^9, {3.8867525507922163`*^9, 
   3.8867525515921793`*^9}},ExpressionUUID->"5c66ef8b-3c87-4374-9b48-\
5b65638f702a"],

Cell[BoxData[{
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"whichCalculations", "\[LeftDoubleBracket]", 
    RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{"OrganismPDUnifiedSigDescentLists", "\[LeftDoubleBracket]", 
    RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "All", " ", "members", " ", "of", " ", "significant", " ", "descents"}], 
    ",", " ", 
    RowBox[{
    "for", " ", "weighted", " ", "calculation", " ", "on", " ", "raw", " ", 
     "nPDs"}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.886682133215376*^9, 3.886682139343321*^9}, 
   3.88675234312735*^9},ExpressionUUID->"fe112aa4-ae07-494f-895c-\
c3813de9edf1"],

Cell[BoxData[{
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"whichCalculations", "\[LeftDoubleBracket]", 
     RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "&&", 
    RowBox[{
    "unmaskedSignificantRegionsOrExtraCalcs", "\[Equal]", 
     "\"\<unmaskedregions\>\""}], "&&", "recordUnmaskedSignificantRegions"}], 
   ",", 
   RowBox[{
   "OrganismPDUnifiedSigDescentListsNoUnmaskedRegions", 
    "\[LeftDoubleBracket]", 
    RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "All", " ", "members", " ", "of", " ", "significant", " ", "descents", 
     " ", "without", " ", "including", " ", "descents", " ", "only", " ", 
     "obtained", " ", "after", " ", "excluding", " ", "later", " ", 
     "potentially", " ", "interfering", " ", "descents"}], ",", " ", 
    RowBox[{
    "for", " ", "weighted", " ", "calculation", " ", "on", " ", "raw", " ", 
     "nPDs"}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.886681966366222*^9, 3.88668197563055*^9}, 
   3.8867523460075283`*^9},ExpressionUUID->"35e066c9-8f6c-4995-a67a-\
82692f9a1904"],

Cell[BoxData[{
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"whichCalculations", "\[LeftDoubleBracket]", 
    RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{
   "CalculatedPDOrganismExtremalDescentList", "\[LeftDoubleBracket]", 
    RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Weighted", " ", "calculation", " ", "on", " ", "ranked", " ", "nPDs"}], 
    ",", " ", 
    RowBox[{
    "by", " ", "default", " ", "as", " ", "a", " ", "list", " ", "consisting",
      " ", "of", " ", "entries", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "Loci", " ", "in", " ", "most", " ", "extreme", " ", "descent"}], 
        "}"}], ",", 
       RowBox[{
       "Z", " ", "statistic", " ", "for", " ", "this", " ", "descent"}], ",", 
       
       RowBox[{
       "Whether", " ", "descent", " ", "evaluated", " ", "after", " ", 
        "first", " ", "time", " ", "a", " ", "less", " ", "significant", " ", 
        "descent", " ", "is", " ", "excised", " ", "to", " ", "check", " ", 
        "for", " ", "interference"}], ",", 
       RowBox[{"Bootstrap", " ", "\"\<p-value\>\""}]}], "}"}]}]}], " ", 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.886680750952721*^9, 3.886680753145193*^9}, 
   3.886682147951313*^9, 3.8867523478952312`*^9, {3.886752553576269*^9, 
   3.8867525538803883`*^9}},ExpressionUUID->"8b4932b3-7338-4348-8675-\
897a1dd1f563"],

Cell[BoxData[{
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"whichCalculations", "\[LeftDoubleBracket]", 
    RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{"OrganismPDUnifiedSigDescentLists", "\[LeftDoubleBracket]", 
    RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "All", " ", "members", " ", "of", " ", "significant", " ", "descents"}], 
    ",", " ", 
    RowBox[{
    "for", " ", "weighted", " ", "calculation", " ", "on", " ", "ranked", " ",
      "nPDs"}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.886682133215376*^9, 3.886682161407454*^9}, 
   3.8867523488869762`*^9},ExpressionUUID->"95966b99-5df3-46a5-be59-\
7e3a1dc983a2"],

Cell[BoxData[{
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"whichCalculations", "\[LeftDoubleBracket]", 
     RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "&&", 
    RowBox[{
    "unmaskedSignificantRegionsOrExtraCalcs", "\[Equal]", 
     "\"\<unmaskedregions\>\""}], "&&", "recordUnmaskedSignificantRegions"}], 
   ",", 
   RowBox[{
   "OrganismPDUnifiedSigDescentListsNoUnmaskedRegions", 
    "\[LeftDoubleBracket]", 
    RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "All", " ", "members", " ", "of", " ", "significant", " ", "descents", 
     " ", "without", " ", "including", " ", "descents", " ", "only", " ", 
     "obtained", " ", "after", " ", "excluding", " ", "later", " ", 
     "potentially", " ", "interfering", " ", "descents"}], ",", " ", 
    RowBox[{
    "for", " ", "weighted", " ", "calculation", " ", "on", " ", "ranked", " ",
      "nPDs"}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.886681966366222*^9, 3.88668197563055*^9}, {
   3.88668216324728*^9, 3.8866821696633053`*^9}, 
   3.886752350375317*^9},ExpressionUUID->"049631a4-a1e0-49b4-86a6-\
513688c7aecd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Run the code below to produce plots showing variability measures and \
conservation in the gene\
\>", "Subsubsection",
 CellChangeTimes->{{3.8868359867284813`*^9, 3.886836024183412*^9}, 
   3.886836389705583*^9},ExpressionUUID->"1abdbb42-97e6-4e4e-81c0-\
2c233acd6974"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"whichCalculations", "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{"nPDGraph", "[", 
    RowBox[{"0.1", ",", "True"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.886760528193733*^9, 3.886760567999857*^9}, {
  3.886836290296863*^9, 
  3.886836300553239*^9}},ExpressionUUID->"4b88ac3b-1153-45c5-ae53-\
0d293df919b6"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"whichCalculations", "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{"PDCumuGraph", "[", 
    RowBox[{"0.1", ",", "True"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.886760582160989*^9, 3.886760586815858*^9}, {
  3.886836304089223*^9, 
  3.886836312905264*^9}},ExpressionUUID->"de998aca-bbda-49f4-b86d-\
412041c438de"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"whichCalculations", "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{"nPDGraphRank", "[", 
    RowBox[{"0.1", ",", "True"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.886760855250263*^9, 3.886760855554003*^9}, {
  3.88683631517736*^9, 
  3.886836322313385*^9}},ExpressionUUID->"cda01602-054d-4263-bc25-\
e7eef2bdd6fa"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"whichCalculations", "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{"PDCumuGraphRank", "[", 
    RowBox[{"0.1", ",", "True"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.886760863617054*^9, 3.886760863953226*^9}, {
  3.8868363247773533`*^9, 
  3.8868363486015*^9}},ExpressionUUID->"017d18ce-1b97-428d-9c3b-2968ebd8e88c"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"whichCalculations", "\[LeftDoubleBracket]", 
    RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{"nPDshannonGraph", "[", 
    RowBox[{"0.1", ",", "True"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.886761428674996*^9, 3.886761436659275*^9}, {
  3.88683633405756*^9, 
  3.8868363556575108`*^9}},ExpressionUUID->"549fe38f-257b-4511-a3c6-\
153c435a7037"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"whichCalculations", "\[LeftDoubleBracket]", 
    RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{"PDshannonCumuGraph", "[", 
    RowBox[{"0.1", ",", "True"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.706427944674135*^9, 3.706427967951434*^9}, {
   3.78005410484127*^9, 3.780054115368821*^9}, {3.780129893945817*^9, 
   3.78012992075741*^9}, {3.788779690781715*^9, 3.788779710363246*^9}, {
   3.790326801381119*^9, 3.7903268985162277`*^9}, {3.7904257434883213`*^9, 
   3.7904257860308533`*^9}, {3.794421561727502*^9, 3.794421576832953*^9}, {
   3.807422713536313*^9, 3.807422777201043*^9}, {3.826014928392457*^9, 
   3.826014928397636*^9}, {3.8260817161609173`*^9, 3.826081719924446*^9}, {
   3.8262893075429296`*^9, 3.8262893283244867`*^9}, {3.827659406324321*^9, 
   3.827659444508164*^9}, {3.827659513038805*^9, 3.827659523373445*^9}, {
   3.827659613543152*^9, 3.8276596396404*^9}, {3.8276616338581743`*^9, 
   3.827661771470196*^9}, {3.859880977422822*^9, 3.859881189167694*^9}, 
   3.886762113893629*^9, {3.886836350825308*^9, 
   3.88683636610539*^9}},ExpressionUUID->"26fda7d1-c95e-4fe2-aa73-\
28f29cece5a0"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"whichCalculations", "\[LeftDoubleBracket]", 
    RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{"nPDshannonGraphRank", "[", 
    RowBox[{"0.1", ",", "True"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.706427944674135*^9, 3.706427967951434*^9}, {
  3.78005410484127*^9, 3.780054115368821*^9}, {3.780129893945817*^9, 
  3.78012992075741*^9}, {3.788779690781715*^9, 3.788779710363246*^9}, {
  3.790326801381119*^9, 3.7903268985162277`*^9}, {3.7904257434883213`*^9, 
  3.7904257860308533`*^9}, {3.794421561727502*^9, 3.794421576832953*^9}, {
  3.807422713536313*^9, 3.807422777201043*^9}, {3.826014928392457*^9, 
  3.826014928397636*^9}, {3.8260817161609173`*^9, 3.826081719924446*^9}, {
  3.8262893075429296`*^9, 3.8262893283244867`*^9}, {3.827659406324321*^9, 
  3.827659444508164*^9}, {3.827659513038805*^9, 3.827659523373445*^9}, {
  3.827659613543152*^9, 3.8276596396404*^9}, {3.8276616338581743`*^9, 
  3.827661771470196*^9}, {3.859880977422822*^9, 3.859881189167694*^9}, {
  3.886762130214216*^9, 3.886762130358016*^9}, {3.886836368137554*^9, 
  3.886836374169541*^9}},ExpressionUUID->"27d3b097-c8db-4c01-b62e-\
607424a96be8"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"whichCalculations", "\[LeftDoubleBracket]", 
    RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{"PDshannonCumuGraphRank", "[", 
    RowBox[{"0.1", ",", "True"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.706427944674135*^9, 3.706427967951434*^9}, {
   3.78005410484127*^9, 3.780054115368821*^9}, {3.780129893945817*^9, 
   3.78012992075741*^9}, {3.788779690781715*^9, 3.788779710363246*^9}, {
   3.790326801381119*^9, 3.7903268985162277`*^9}, {3.7904257434883213`*^9, 
   3.7904257860308533`*^9}, {3.794421561727502*^9, 3.794421576832953*^9}, {
   3.807422713536313*^9, 3.807422777201043*^9}, {3.826014928392457*^9, 
   3.826014928397636*^9}, {3.8260817161609173`*^9, 3.826081719924446*^9}, {
   3.8262893075429296`*^9, 3.8262893283244867`*^9}, {3.827659406324321*^9, 
   3.827659444508164*^9}, {3.827659513038805*^9, 3.827659523373445*^9}, {
   3.827659613543152*^9, 3.8276596396404*^9}, {3.8276616338581743`*^9, 
   3.827661771470196*^9}, {3.859880977422822*^9, 3.859881189167694*^9}, 
   3.886762195222135*^9, {3.8868363763775377`*^9, 
   3.8868363850654716`*^9}},ExpressionUUID->"34a56e97-e1f4-45be-9f40-\
7c1a47f0bc0c"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{2560, 1416},
WindowMargins->{{-2561, Automatic}, {Automatic, -2}},
FrontEndVersion->"12.3 for Linux x86 (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"4d11a96e-27ff-4cc4-98d6-9d6cd6ae7caa"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 188, 3, 98, "Title",ExpressionUUID->"c85fa883-a0f5-4ccd-8d3b-62479b6fd1a2"],
Cell[CellGroupData[{
Cell[793, 29, 739, 13, 105, "Section",ExpressionUUID->"bed394a6-c7eb-4f70-a4ae-0e513b9774a0"],
Cell[1535, 44, 2577, 40, 288, "Text",ExpressionUUID->"487d4e87-f5eb-49a4-9680-024f53882364"],
Cell[CellGroupData[{
Cell[4137, 88, 190, 3, 54, "Subsection",ExpressionUUID->"19165505-d8e4-4c77-b665-cb6043ff5d0d"],
Cell[4330, 93, 554, 12, 30, "Input",ExpressionUUID->"6e531a59-aadf-4787-b4dd-726346f323ea"],
Cell[4887, 107, 448, 10, 30, "Input",ExpressionUUID->"1bab9a0d-f1b9-466e-9758-0115f76427e5"],
Cell[5338, 119, 4984, 114, 163, "Input",ExpressionUUID->"b1134538-81af-4e65-aac1-ef1dd9ee5f1a"],
Cell[10325, 235, 4312, 97, 141, "Input",ExpressionUUID->"2a4367ea-03a0-4e94-87ce-ab190b23007a"],
Cell[14640, 334, 4650, 101, 141, "Input",ExpressionUUID->"ed056d7e-cf24-4d76-86c2-fe2ab811810a"],
Cell[19293, 437, 18509, 311, 273, "Input",ExpressionUUID->"f58b8be3-1372-4f7a-baa2-e55ae5a61acd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37839, 753, 416, 8, 54, "Subsection",ExpressionUUID->"aaf35404-8243-4639-90ce-1436a64b51f4"],
Cell[38258, 763, 12834, 190, 97, "Input",ExpressionUUID->"22eeebe8-d258-4b7d-bc03-8e316555003e"],
Cell[51095, 955, 2932, 77, 97, "Input",ExpressionUUID->"12fe2109-9b2b-476f-9b2f-dd04dfeaf102"],
Cell[54030, 1034, 5353, 123, 273, "Input",ExpressionUUID->"e2beae8c-d6f1-4aa0-a8ac-6fc56ee665fa"],
Cell[59386, 1159, 1109, 23, 30, "Input",ExpressionUUID->"179135ba-7807-4395-bb1e-4017ba3f6212"],
Cell[60498, 1184, 751, 19, 30, "Input",ExpressionUUID->"e30f8f2c-4e65-4e34-a7ce-1ec6a4e2736e"],
Cell[61252, 1205, 720, 15, 30, "Input",ExpressionUUID->"8fd38050-7d8c-417f-b031-063f8c24d0bf"],
Cell[61975, 1222, 1688, 39, 53, "Input",ExpressionUUID->"3142baa4-9f87-4835-9dd5-ee6a57c9f044"],
Cell[63666, 1263, 847, 21, 59, "Input",ExpressionUUID->"4825d75e-689e-4f9a-8c0a-b66048c2da5e"],
Cell[64516, 1286, 460, 11, 53, "Input",ExpressionUUID->"22fb25a0-5b44-4021-a7b7-a39d124bc42d"],
Cell[64979, 1299, 1844, 45, 53, "Input",ExpressionUUID->"94bb8a6a-a04e-4105-a5f9-14b740d229f8"],
Cell[66826, 1346, 5416, 106, 163, "Input",ExpressionUUID->"682f1fc1-2546-41b0-bc5b-7cbf3b98583b"],
Cell[72245, 1454, 1380, 28, 75, "Input",ExpressionUUID->"40b20e54-c2cb-44b0-aa5c-fb660e771c15"],
Cell[73628, 1484, 661, 15, 30, "Input",ExpressionUUID->"0a630565-e708-475e-ad62-60944f2e027e"],
Cell[74292, 1501, 1576, 40, 30, "Input",ExpressionUUID->"271348d2-dca3-42c5-968d-97aeabd283e7"],
Cell[75871, 1543, 912, 20, 30, "Input",ExpressionUUID->"af35b42f-3206-4de9-9e47-ad1c4163a96f"],
Cell[76786, 1565, 3003, 62, 75, "Input",ExpressionUUID->"cb7fc0ab-17e2-4565-aa85-01bb3ad279de"],
Cell[79792, 1629, 1496, 33, 75, "Input",ExpressionUUID->"26455924-c004-42a5-8989-964db297bb9e"],
Cell[81291, 1664, 1334, 29, 30, "Input",ExpressionUUID->"492f8e16-46d0-45d2-8824-c89f730253f8"],
Cell[82628, 1695, 1436, 30, 75, "Input",ExpressionUUID->"c7f20e85-5dc3-425e-8b11-8008c5b2d4b5"],
Cell[84067, 1727, 1627, 40, 53, "Input",ExpressionUUID->"94e515bb-199e-4342-91bf-04e44742d2f8"],
Cell[85697, 1769, 853, 21, 30, "Input",ExpressionUUID->"f31a552b-30c9-4663-9630-855a2b6c10cf"],
Cell[86553, 1792, 701, 17, 30, "Input",ExpressionUUID->"4fbf015c-ff53-4f19-ae2f-c286d4e93fc2"],
Cell[87257, 1811, 1397, 34, 53, "Input",ExpressionUUID->"585448da-6661-4810-9f4e-73d64bd474fa"],
Cell[88657, 1847, 487, 13, 30, "Input",ExpressionUUID->"8a3f09cb-a6e4-4830-b397-1bfe88e3b989"],
Cell[89147, 1862, 423, 9, 30, "Input",ExpressionUUID->"9c439bce-70cf-4533-8e55-0680cea0771d"],
Cell[89573, 1873, 299, 7, 30, "Input",ExpressionUUID->"3cdc9d8b-588e-4a95-8d51-1d1456a43ae1"],
Cell[89875, 1882, 680, 17, 30, "Input",ExpressionUUID->"081cf032-1954-43b7-9820-d6f5bd118e6c"],
Cell[90558, 1901, 2985, 73, 141, "Input",ExpressionUUID->"9938ee8d-f7fe-4b2a-b7b6-9863fa3b9797"],
Cell[93546, 1976, 608, 13, 30, "Input",ExpressionUUID->"6c131f8b-eb88-4a28-819f-8f98550794e0"],
Cell[94157, 1991, 2458, 56, 141, "Input",ExpressionUUID->"4f35b023-dfab-4102-a90f-0cd2983f0822"],
Cell[96618, 2049, 566, 16, 30, "Input",ExpressionUUID->"e844c670-b9ba-4b67-92e0-ff472a87bb23"],
Cell[97187, 2067, 908, 19, 53, "Input",ExpressionUUID->"6e51c628-aa40-453d-aabd-34bd1d68536f"],
Cell[98098, 2088, 1065, 26, 30, "Input",ExpressionUUID->"16b74c77-dce0-4514-a8f1-d574b0ed3722"]
}, Open  ]],
Cell[CellGroupData[{
Cell[99200, 2119, 376, 8, 54, "Subsection",ExpressionUUID->"7fb67a0d-fcaf-47aa-a9c7-66e44ead9f87"],
Cell[CellGroupData[{
Cell[99601, 2131, 299, 6, 45, "Subsubsection",ExpressionUUID->"15ce62a9-ebbd-402e-81e4-f798f4c9577a"],
Cell[99903, 2139, 18342, 401, 1090, "Input",ExpressionUUID->"47c66ac8-445e-4e37-9d0a-88f796c20b05"]
}, Open  ]],
Cell[CellGroupData[{
Cell[118282, 2545, 301, 7, 45, "Subsubsection",ExpressionUUID->"a9748c5f-5c85-405c-8f7b-25726c6e6253"],
Cell[118586, 2554, 11085, 231, 669, "Input",ExpressionUUID->"7bec1c3a-9393-4bda-a721-da2b3096d7e7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[129708, 2790, 295, 6, 45, "Subsubsection",ExpressionUUID->"386c519e-4d71-45fe-afab-d755389502ec"],
Cell[130006, 2798, 49111, 1007, 2605, "Input",ExpressionUUID->"a365e41d-f330-4e04-bf98-51d374c10f4c"],
Cell[179120, 3807, 26841, 555, 1241, "Input",ExpressionUUID->"fe2131da-b37c-4520-a084-9544452e020c"],
Cell[205964, 4364, 1258, 33, 30, "Input",ExpressionUUID->"ee4c5e83-1d2a-4f88-805f-bc18bcc81e80"],
Cell[207225, 4399, 5164, 130, 229, "Input",ExpressionUUID->"ed1146eb-98b6-4fa0-9032-399e8fb6295b"],
Cell[212392, 4531, 3732, 80, 132, "Input",ExpressionUUID->"af9449cf-4a4c-4d74-b32f-3c3542cb167b"],
Cell[216127, 4613, 3346, 79, 185, "Input",ExpressionUUID->"a4f08342-c684-40e3-9d2c-c8d24845075a"],
Cell[219476, 4694, 7546, 171, 273, "Input",ExpressionUUID->"820ae879-4e22-41b5-a307-6ff0b2a78855"]
}, Open  ]],
Cell[CellGroupData[{
Cell[227059, 4870, 183, 3, 45, "Subsubsection",ExpressionUUID->"3bb3718d-cec1-4014-8109-2b7e8a0e0bd8"],
Cell[227245, 4875, 1214, 33, 53, "Input",ExpressionUUID->"ef13e217-9655-4a21-ab83-6d6877c6810f"],
Cell[228462, 4910, 449, 11, 30, "Input",ExpressionUUID->"fa202d21-d2a1-4d7b-898a-27419dbf102a"],
Cell[228914, 4923, 390, 11, 30, "Input",ExpressionUUID->"d4da0f3e-37ff-4f0f-aad0-02e5e054bfe0"],
Cell[229307, 4936, 1083, 25, 30, "Input",ExpressionUUID->"4c50b9b1-bd28-4256-99d4-dc5f3af811c1"],
Cell[230393, 4963, 624, 15, 30, "Input",ExpressionUUID->"54b2369d-721e-45ea-a213-3ad9b659c2fa"],
Cell[231020, 4980, 194279, 4441, 5429, "Input",ExpressionUUID->"2861770a-392a-4df3-9437-14152fdc6710"]
}, Open  ]],
Cell[CellGroupData[{
Cell[425336, 9426, 249, 6, 45, "Subsubsection",ExpressionUUID->"dad38a03-5522-4ef4-83ab-501fe83be921"],
Cell[425588, 9434, 1477, 37, 53, "Input",ExpressionUUID->"36aa2806-97b1-49fe-bd8d-b144dafddb70"],
Cell[427068, 9473, 812, 20, 53, "Input",ExpressionUUID->"644683b5-4a42-404f-a169-6dc7b062fa07"],
Cell[427883, 9495, 1163, 28, 75, "Input",ExpressionUUID->"eec5a491-5f31-45c3-b2d6-16019cb81bca"],
Cell[429049, 9525, 1478, 37, 53, "Input",ExpressionUUID->"208a6c9f-768e-4044-bfde-06e8762538a2"],
Cell[430530, 9564, 792, 20, 53, "Input",ExpressionUUID->"71cc021d-f188-469f-ad48-4d754553dc60"],
Cell[431325, 9586, 1168, 28, 75, "Input",ExpressionUUID->"b60ab24e-503b-4cbd-ab1f-db9e2361e124"],
Cell[432496, 9616, 1477, 37, 53, "Input",ExpressionUUID->"5c66ef8b-3c87-4374-9b48-5b65638f702a"],
Cell[433976, 9655, 760, 19, 53, "Input",ExpressionUUID->"fe112aa4-ae07-494f-895c-c3813de9edf1"],
Cell[434739, 9676, 1160, 28, 75, "Input",ExpressionUUID->"35e066c9-8f6c-4995-a67a-82692f9a1904"],
Cell[435902, 9706, 1502, 37, 53, "Input",ExpressionUUID->"8b4932b3-7338-4348-8675-897a1dd1f563"],
Cell[437407, 9745, 766, 19, 53, "Input",ExpressionUUID->"95966b99-5df3-46a5-be59-7e3a1dc983a2"],
Cell[438176, 9766, 1212, 29, 75, "Input",ExpressionUUID->"049631a4-a1e0-49b4-86a6-513688c7aecd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[439425, 9800, 279, 6, 45, "Subsubsection",ExpressionUUID->"1abdbb42-97e6-4e4e-81c0-2c233acd6974"],
Cell[439707, 9808, 428, 10, 30, "Input",ExpressionUUID->"4b88ac3b-1153-45c5-ae53-0d293df919b6"],
Cell[440138, 9820, 431, 10, 30, "Input",ExpressionUUID->"de998aca-bbda-49f4-b86d-412041c438de"],
Cell[440572, 9832, 431, 10, 30, "Input",ExpressionUUID->"cda01602-054d-4263-bc25-e7eef2bdd6fa"],
Cell[441006, 9844, 433, 9, 30, "Input",ExpressionUUID->"017d18ce-1b97-428d-9c3b-2968ebd8e88c"],
Cell[441442, 9855, 436, 10, 30, "Input",ExpressionUUID->"549fe38f-257b-4511-a3c6-153c435a7037"],
Cell[441881, 9867, 1201, 20, 30, "Input",ExpressionUUID->"26fda7d1-c95e-4fe2-aa73-28f29cece5a0"],
Cell[443085, 9889, 1215, 20, 30, "Input",ExpressionUUID->"27d3b097-c8db-4c01-b62e-607424a96be8"],
Cell[444303, 9911, 1210, 20, 30, "Input",ExpressionUUID->"34a56e97-e1f4-45be-9f40-7c1a47f0bc0c"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

